(()=>{"use strict";var e={4601:(e,t,n)=>{e.exports=n(141)},141:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.BrowserMessageWriter=t.BrowserMessageReader=void 0,n(7113).default.install();const o=n(3163);i(n(3163),t);class s extends o.AbstractMessageReader{constructor(e){super(),this._onData=new o.Emitter,this._messageListener=e=>{this._onData.fire(e.data)},e.addEventListener("error",(e=>this.fireError(e))),e.onmessage=this._messageListener}listen(e){return this._onData.event(e)}}t.BrowserMessageReader=s;class a extends o.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.addEventListener("error",(e=>this.fireError(e)))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}}t.BrowserMessageWriter=a,t.createMessageConnection=function(e,t,n,r){return void 0===n&&(n=o.NullLogger),o.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,o.createMessageConnection)(e,t,n,r)}},7113:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(3163);class i extends r.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return i.emptyBuffer}fromString(e,t){return(new TextEncoder).encode(e)}toString(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return void 0===t?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}i.emptyBuffer=new Uint8Array(0);class o{constructor(e){this.socket=e,this._onData=new r.Emitter,this._messageListener=e=>{e.data.arrayBuffer().then((e=>{this._onData.fire(new Uint8Array(e))}),(()=>{(0,r.RAL)().console.error("Converting blob to array buffer failed.")}))},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}onData(e){return this._onData.event(e)}}class s{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),r.Disposable.create((()=>this.socket.removeEventListener("close",e)))}onError(e){return this.socket.addEventListener("error",e),r.Disposable.create((()=>this.socket.removeEventListener("error",e)))}onEnd(e){return this.socket.addEventListener("end",e),r.Disposable.create((()=>this.socket.removeEventListener("end",e)))}write(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,c=Object.freeze({messageBuffer:Object.freeze({create:e=>new i(e)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(e,t)=>{if("utf-8"!==t.charset)throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t.charset}`);return Promise.resolve(a.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(e,t)=>{if(!(e instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:e=>new o(e),asWritableStream:e=>new s(e)}),console,timer:Object.freeze({setTimeout(e,t,...n){const r=setTimeout(e,t,...n);return{dispose:()=>clearTimeout(r)}},setImmediate(e,...t){const n=setTimeout(e,0,...t);return{dispose:()=>clearTimeout(n)}},setInterval(e,t,...n){const r=setInterval(e,t,...n);return{dispose:()=>clearInterval(r)}}})});function u(){return c}!function(e){e.install=function(){r.RAL.install(c)}}(u||(u={})),t.default=u},3163:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressType=t.ProgressToken=t.createMessageConnection=t.NullLogger=t.ConnectionOptions=t.ConnectionStrategy=t.AbstractMessageBuffer=t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=t.CancellationToken=t.CancellationTokenSource=t.Emitter=t.Event=t.Disposable=t.LRUCache=t.Touch=t.LinkedMap=t.ParameterStructures=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.ErrorCodes=t.ResponseError=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType0=t.RequestType=t.Message=t.RAL=void 0,t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=void 0;const r=n(4399);Object.defineProperty(t,"Message",{enumerable:!0,get:function(){return r.Message}}),Object.defineProperty(t,"RequestType",{enumerable:!0,get:function(){return r.RequestType}}),Object.defineProperty(t,"RequestType0",{enumerable:!0,get:function(){return r.RequestType0}}),Object.defineProperty(t,"RequestType1",{enumerable:!0,get:function(){return r.RequestType1}}),Object.defineProperty(t,"RequestType2",{enumerable:!0,get:function(){return r.RequestType2}}),Object.defineProperty(t,"RequestType3",{enumerable:!0,get:function(){return r.RequestType3}}),Object.defineProperty(t,"RequestType4",{enumerable:!0,get:function(){return r.RequestType4}}),Object.defineProperty(t,"RequestType5",{enumerable:!0,get:function(){return r.RequestType5}}),Object.defineProperty(t,"RequestType6",{enumerable:!0,get:function(){return r.RequestType6}}),Object.defineProperty(t,"RequestType7",{enumerable:!0,get:function(){return r.RequestType7}}),Object.defineProperty(t,"RequestType8",{enumerable:!0,get:function(){return r.RequestType8}}),Object.defineProperty(t,"RequestType9",{enumerable:!0,get:function(){return r.RequestType9}}),Object.defineProperty(t,"ResponseError",{enumerable:!0,get:function(){return r.ResponseError}}),Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return r.ErrorCodes}}),Object.defineProperty(t,"NotificationType",{enumerable:!0,get:function(){return r.NotificationType}}),Object.defineProperty(t,"NotificationType0",{enumerable:!0,get:function(){return r.NotificationType0}}),Object.defineProperty(t,"NotificationType1",{enumerable:!0,get:function(){return r.NotificationType1}}),Object.defineProperty(t,"NotificationType2",{enumerable:!0,get:function(){return r.NotificationType2}}),Object.defineProperty(t,"NotificationType3",{enumerable:!0,get:function(){return r.NotificationType3}}),Object.defineProperty(t,"NotificationType4",{enumerable:!0,get:function(){return r.NotificationType4}}),Object.defineProperty(t,"NotificationType5",{enumerable:!0,get:function(){return r.NotificationType5}}),Object.defineProperty(t,"NotificationType6",{enumerable:!0,get:function(){return r.NotificationType6}}),Object.defineProperty(t,"NotificationType7",{enumerable:!0,get:function(){return r.NotificationType7}}),Object.defineProperty(t,"NotificationType8",{enumerable:!0,get:function(){return r.NotificationType8}}),Object.defineProperty(t,"NotificationType9",{enumerable:!0,get:function(){return r.NotificationType9}}),Object.defineProperty(t,"ParameterStructures",{enumerable:!0,get:function(){return r.ParameterStructures}});const i=n(202);Object.defineProperty(t,"LinkedMap",{enumerable:!0,get:function(){return i.LinkedMap}}),Object.defineProperty(t,"LRUCache",{enumerable:!0,get:function(){return i.LRUCache}}),Object.defineProperty(t,"Touch",{enumerable:!0,get:function(){return i.Touch}});const o=n(4161);Object.defineProperty(t,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});const s=n(1702);Object.defineProperty(t,"Event",{enumerable:!0,get:function(){return s.Event}}),Object.defineProperty(t,"Emitter",{enumerable:!0,get:function(){return s.Emitter}});const a=n(4628);Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return a.CancellationTokenSource}}),Object.defineProperty(t,"CancellationToken",{enumerable:!0,get:function(){return a.CancellationToken}});const c=n(8130);Object.defineProperty(t,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return c.SharedArraySenderStrategy}}),Object.defineProperty(t,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return c.SharedArrayReceiverStrategy}});const u=n(5667);Object.defineProperty(t,"MessageReader",{enumerable:!0,get:function(){return u.MessageReader}}),Object.defineProperty(t,"AbstractMessageReader",{enumerable:!0,get:function(){return u.AbstractMessageReader}}),Object.defineProperty(t,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return u.ReadableStreamMessageReader}});const l=n(3459);Object.defineProperty(t,"MessageWriter",{enumerable:!0,get:function(){return l.MessageWriter}}),Object.defineProperty(t,"AbstractMessageWriter",{enumerable:!0,get:function(){return l.AbstractMessageWriter}}),Object.defineProperty(t,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return l.WriteableStreamMessageWriter}});const d=n(8410);Object.defineProperty(t,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});const f=n(9715);Object.defineProperty(t,"ConnectionStrategy",{enumerable:!0,get:function(){return f.ConnectionStrategy}}),Object.defineProperty(t,"ConnectionOptions",{enumerable:!0,get:function(){return f.ConnectionOptions}}),Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return f.NullLogger}}),Object.defineProperty(t,"createMessageConnection",{enumerable:!0,get:function(){return f.createMessageConnection}}),Object.defineProperty(t,"ProgressToken",{enumerable:!0,get:function(){return f.ProgressToken}}),Object.defineProperty(t,"ProgressType",{enumerable:!0,get:function(){return f.ProgressType}}),Object.defineProperty(t,"Trace",{enumerable:!0,get:function(){return f.Trace}}),Object.defineProperty(t,"TraceValues",{enumerable:!0,get:function(){return f.TraceValues}}),Object.defineProperty(t,"TraceFormat",{enumerable:!0,get:function(){return f.TraceFormat}}),Object.defineProperty(t,"SetTraceNotification",{enumerable:!0,get:function(){return f.SetTraceNotification}}),Object.defineProperty(t,"LogTraceNotification",{enumerable:!0,get:function(){return f.LogTraceNotification}}),Object.defineProperty(t,"ConnectionErrors",{enumerable:!0,get:function(){return f.ConnectionErrors}}),Object.defineProperty(t,"ConnectionError",{enumerable:!0,get:function(){return f.ConnectionError}}),Object.defineProperty(t,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return f.CancellationReceiverStrategy}}),Object.defineProperty(t,"CancellationSenderStrategy",{enumerable:!0,get:function(){return f.CancellationSenderStrategy}}),Object.defineProperty(t,"CancellationStrategy",{enumerable:!0,get:function(){return f.CancellationStrategy}}),Object.defineProperty(t,"MessageStrategy",{enumerable:!0,get:function(){return f.MessageStrategy}});const p=n(316);t.RAL=p.default},4628:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationTokenSource=t.CancellationToken=void 0;const r=n(316),i=n(9859),o=n(1702);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:o.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:o.Event.None}),e.is=function(t){const n=t;return n&&(n===e.None||n===e.Cancelled||i.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}}(s||(t.CancellationToken=s={}));const a=Object.freeze((function(e,t){const n=(0,r.default)().timer.setTimeout(e.bind(t),0);return{dispose(){n.dispose()}}}));class c{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new o.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new c),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof c&&this._token.dispose():this._token=s.None}}},9715:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMessageConnection=t.ConnectionOptions=t.MessageStrategy=t.CancellationStrategy=t.CancellationSenderStrategy=t.CancellationReceiverStrategy=t.RequestCancellationReceiverStrategy=t.IdCancellationReceiverStrategy=t.ConnectionStrategy=t.ConnectionError=t.ConnectionErrors=t.LogTraceNotification=t.SetTraceNotification=t.TraceFormat=t.TraceValues=t.Trace=t.NullLogger=t.ProgressType=t.ProgressToken=void 0;const r=n(316),i=n(9859),o=n(4399),s=n(202),a=n(1702),c=n(4628);var u,l,d,f,p,h,m,y,g,v,T,R,k,b,w,S,$,x,C;!function(e){e.type=new o.NotificationType("$/cancelRequest")}(u||(u={})),function(e){e.is=function(e){return"string"==typeof e||"number"==typeof e}}(l||(t.ProgressToken=l={})),function(e){e.type=new o.NotificationType("$/progress")}(d||(d={})),t.ProgressType=class{constructor(){}},function(e){e.is=function(e){return i.func(e)}}(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Compact=2]="Compact",e[e.Verbose=3]="Verbose"}(p||(t.Trace=p={})),function(e){e.Off="off",e.Messages="messages",e.Compact="compact",e.Verbose="verbose"}(h||(t.TraceValues=h={})),function(e){e.fromString=function(t){if(!i.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"compact":return e.Compact;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Compact:return"compact";case e.Verbose:return"verbose";default:return"off"}}}(p||(t.Trace=p={})),function(e){e.Text="text",e.JSON="json"}(m||(t.TraceFormat=m={})),function(e){e.fromString=function(t){return i.string(t)&&"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(m||(t.TraceFormat=m={})),function(e){e.type=new o.NotificationType("$/setTrace")}(y||(t.SetTraceNotification=y={})),function(e){e.type=new o.NotificationType("$/logTrace")}(g||(t.LogTraceNotification=g={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v||(t.ConnectionErrors=v={}));class E extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,E.prototype)}}t.ConnectionError=E,function(e){e.is=function(e){const t=e;return t&&i.func(t.cancelUndispatched)}}(T||(t.ConnectionStrategy=T={})),function(e){e.is=function(e){const t=e;return t&&(void 0===t.kind||"id"===t.kind)&&i.func(t.createCancellationTokenSource)&&(void 0===t.dispose||i.func(t.dispose))}}(R||(t.IdCancellationReceiverStrategy=R={})),function(e){e.is=function(e){const t=e;return t&&"request"===t.kind&&i.func(t.createCancellationTokenSource)&&(void 0===t.dispose||i.func(t.dispose))}}(k||(t.RequestCancellationReceiverStrategy=k={})),function(e){e.Message=Object.freeze({createCancellationTokenSource:e=>new c.CancellationTokenSource}),e.is=function(e){return R.is(e)||k.is(e)}}(b||(t.CancellationReceiverStrategy=b={})),function(e){e.Message=Object.freeze({sendCancellation:(e,t)=>e.sendNotification(u.type,{id:t}),cleanup(e){}}),e.is=function(e){const t=e;return t&&i.func(t.sendCancellation)&&i.func(t.cleanup)}}(w||(t.CancellationSenderStrategy=w={})),function(e){e.Message=Object.freeze({receiver:b.Message,sender:w.Message}),e.is=function(e){const t=e;return t&&b.is(t.receiver)&&w.is(t.sender)}}(S||(t.CancellationStrategy=S={})),function(e){e.is=function(e){const t=e;return t&&i.func(t.handleMessage)}}($||(t.MessageStrategy=$={})),function(e){e.is=function(e){const t=e;return t&&(S.is(t.cancellationStrategy)||T.is(t.connectionStrategy)||$.is(t.messageStrategy))}}(x||(t.ConnectionOptions=x={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(C||(C={})),t.createMessageConnection=function(e,n,h,T){const k=void 0!==h?h:t.NullLogger;let b=0,w=0,x=0;const A="2.0";let N;const D=new Map;let _;const I=new Map,P=new Map;let O,L,M=new s.LinkedMap,F=new Map,j=new Set,q=new Map,U=p.Off,K=m.Text,G=C.New;const H=new a.Emitter,W=new a.Emitter,B=new a.Emitter,z=new a.Emitter,V=new a.Emitter,Y=T&&T.cancellationStrategy?T.cancellationStrategy:S.Message;function X(e){if(null===e)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function J(e){}function Q(){return G===C.Listening}function Z(){return G===C.Closed}function ee(){return G===C.Disposed}function te(){G!==C.New&&G!==C.Listening||(G=C.Closed,W.fire(void 0))}function ne(){O||0===M.size||(O=(0,r.default)().timer.setImmediate((()=>{O=void 0,function(){if(0===M.size)return;const e=M.shift();try{const t=T?.messageStrategy;$.is(t)?t.handleMessage(e,re):re(e)}finally{ne()}}()})))}function re(e){o.Message.isRequest(e)?function(e){if(ee())return;function t(t,r,i){const s={jsonrpc:A,id:e.id};t instanceof o.ResponseError?s.error=t.toJson():s.result=void 0===t?null:t,se(s,r,i),n.write(s).catch((()=>k.error("Sending response failed.")))}function r(t,r,i){const o={jsonrpc:A,id:e.id,error:t.toJson()};se(o,r,i),n.write(o).catch((()=>k.error("Sending response failed.")))}!function(e){if(U!==p.Off&&L)if(K===m.Text){let t;U!==p.Verbose&&U!==p.Compact||!e.params||(t=`Params: ${oe(e.params)}\n\n`),L.log(`Received request '${e.method} - (${e.id})'.`,t)}else ce("receive-request",e)}(e);const s=D.get(e.method);let a,c;s&&(a=s.type,c=s.handler);const u=Date.now();if(c||N){const s=e.id??String(Date.now()),l=R.is(Y.receiver)?Y.receiver.createCancellationTokenSource(s):Y.receiver.createCancellationTokenSource(e);null!==e.id&&j.has(e.id)&&l.cancel(),null!==e.id&&q.set(s,l);try{let d;if(c)if(void 0===e.params){if(void 0!==a&&0!==a.numberOfParams)return void r(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines ${a.numberOfParams} params but received none.`),e.method,u);d=c(l.token)}else if(Array.isArray(e.params)){if(void 0!==a&&a.parameterStructures===o.ParameterStructures.byName)return void r(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by name but received parameters by position`),e.method,u);d=c(...e.params,l.token)}else{if(void 0!==a&&a.parameterStructures===o.ParameterStructures.byPosition)return void r(new o.ResponseError(o.ErrorCodes.InvalidParams,`Request ${e.method} defines parameters by position but received parameters by name`),e.method,u);d=c(e.params,l.token)}else N&&(d=N(e.method,e.params,l.token));const f=d;d?f.then?f.then((n=>{q.delete(s),t(n,e.method,u)}),(t=>{q.delete(s),t instanceof o.ResponseError?r(t,e.method,u):t&&i.string(t.message)?r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)})):(q.delete(s),t(d,e.method,u)):(q.delete(s),function(t,r,i){void 0===t&&(t=null);const o={jsonrpc:A,id:e.id,result:t};se(o,r,i),n.write(o).catch((()=>k.error("Sending response failed.")))}(d,e.method,u))}catch(n){q.delete(s),n instanceof o.ResponseError?t(n,e.method,u):n&&i.string(n.message)?r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${n.message}`),e.method,u):r(new o.ResponseError(o.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else r(new o.ResponseError(o.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,u)}(e):o.Message.isNotification(e)?function(e){if(ee())return;let t,n;if(e.method===u.type.method){const t=e.params.id;return j.delete(t),void ae(e)}{const r=I.get(e.method);r&&(n=r.handler,t=r.type)}if(n||_)try{if(ae(e),n)if(void 0===e.params)void 0!==t&&0!==t.numberOfParams&&t.parameterStructures!==o.ParameterStructures.byName&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received none.`),n();else if(Array.isArray(e.params)){const r=e.params;e.method===d.type.method&&2===r.length&&l.is(r[0])?n({token:r[0],value:r[1]}):(void 0!==t&&(t.parameterStructures===o.ParameterStructures.byName&&k.error(`Notification ${e.method} defines parameters by name but received parameters by position`),t.numberOfParams!==e.params.length&&k.error(`Notification ${e.method} defines ${t.numberOfParams} params but received ${r.length} arguments`)),n(...r))}else void 0!==t&&t.parameterStructures===o.ParameterStructures.byPosition&&k.error(`Notification ${e.method} defines parameters by position but received parameters by name`),n(e.params);else _&&_(e.method,e.params)}catch(t){t.message?k.error(`Notification handler '${e.method}' failed with message: ${t.message}`):k.error(`Notification handler '${e.method}' failed unexpectedly.`)}else B.fire(e)}(e):o.Message.isResponse(e)?function(e){if(!ee())if(null===e.id)e.error?k.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):k.error("Received response message without id. No further error information provided.");else{const t=e.id,n=F.get(t);if(function(e,t){if(U!==p.Off&&L)if(K===m.Text){let n;if(U!==p.Verbose&&U!==p.Compact||(e.error&&e.error.data?n=`Error data: ${oe(e.error.data)}\n\n`:e.result?n=`Result: ${oe(e.result)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),t){const r=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";L.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${r}`,n)}else L.log(`Received response ${e.id} without active response promise.`,n)}else ce("receive-response",e)}(e,n),void 0!==n){F.delete(t);try{if(e.error){const t=e.error;n.reject(new o.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?k.error(`Response handler '${n.method}' failed with message: ${e.message}`):k.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void k.error("Received empty message.");k.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);const t=e;if(i.string(t.id)||i.number(t.id)){const e=t.id,n=F.get(e);n&&n.reject(new Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(te),e.onError((function(e){H.fire([e,void 0,void 0])})),n.onClose(te),n.onError((function(e){H.fire(e)}));const ie=e=>{try{if(o.Message.isNotification(e)&&e.method===u.type.method){const t=e.params.id,r=X(t),i=M.get(r);if(o.Message.isRequest(i)){const o=T?.connectionStrategy,s=o&&o.cancelUndispatched?o.cancelUndispatched(i,J):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return M.delete(r),q.delete(t),s.id=i.id,se(s,e.method,Date.now()),void n.write(s).catch((()=>k.error("Sending response for canceled message failed.")))}const s=q.get(t);if(void 0!==s)return s.cancel(),void ae(e);j.add(t)}!function(e,t){var n;o.Message.isRequest(t)?e.set(X(t.id),t):o.Message.isResponse(t)?e.set(null===(n=t.id)?"res-unknown-"+(++x).toString():"res-"+n.toString(),t):e.set("not-"+(++w).toString(),t)}(M,e)}finally{ne()}};function oe(e){if(null!=e)switch(U){case p.Verbose:return JSON.stringify(e,null,4);case p.Compact:return JSON.stringify(e);default:return}}function se(e,t,n){if(U!==p.Off&&L)if(K===m.Text){let r;U!==p.Verbose&&U!==p.Compact||(e.error&&e.error.data?r=`Error data: ${oe(e.error.data)}\n\n`:e.result?r=`Result: ${oe(e.result)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),L.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-n}ms`,r)}else ce("send-response",e)}function ae(e){if(U!==p.Off&&L&&e.method!==g.type.method)if(K===m.Text){let t;U!==p.Verbose&&U!==p.Compact||(t=e.params?`Params: ${oe(e.params)}\n\n`:"No parameters provided.\n\n"),L.log(`Received notification '${e.method}'.`,t)}else ce("receive-notification",e)}function ce(e,t){if(!L||U===p.Off)return;const n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};L.log(n)}function ue(){if(Z())throw new E(v.Closed,"Connection is closed.");if(ee())throw new E(v.Disposed,"Connection is disposed.")}function le(e){return void 0===e?null:e}function de(e){return null===e?void 0:e}function fe(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function pe(e,t){switch(e){case o.ParameterStructures.auto:return fe(t)?de(t):[le(t)];case o.ParameterStructures.byName:if(!fe(t))throw new Error("Received parameters by name but param is not an object literal.");return de(t);case o.ParameterStructures.byPosition:return[le(t)];default:throw new Error(`Unknown parameter structure ${e.toString()}`)}}function he(e,t){let n;const r=e.numberOfParams;switch(r){case 0:n=void 0;break;case 1:n=pe(e.parameterStructures,t[0]);break;default:n=[];for(let e=0;e<t.length&&e<r;e++)n.push(le(t[e]));if(t.length<r)for(let e=t.length;e<r;e++)n.push(null)}return n}const me={sendNotification:(e,...t)=>{let r,s;if(ue(),i.string(e)){r=e;const n=t[0];let i=0,a=o.ParameterStructures.auto;o.ParameterStructures.is(n)&&(i=1,a=n);let c=t.length;const u=c-i;switch(u){case 0:s=void 0;break;case 1:s=pe(a,t[i]);break;default:if(a===o.ParameterStructures.byName)throw new Error(`Received ${u} parameters for 'by Name' notification parameter structure.`);s=t.slice(i,c).map((e=>le(e)))}}else{const n=t;r=e.method,s=he(e,n)}const a={jsonrpc:A,method:r,params:s};return function(e){if(U!==p.Off&&L)if(K===m.Text){let t;U!==p.Verbose&&U!==p.Compact||(t=e.params?`Params: ${oe(e.params)}\n\n`:"No parameters provided.\n\n"),L.log(`Sending notification '${e.method}'.`,t)}else ce("send-notification",e)}(a),n.write(a).catch((e=>{throw k.error("Sending notification failed."),e}))},onNotification:(e,t)=>{let n;return ue(),i.func(e)?_=e:t&&(i.string(e)?(n=e,I.set(e,{type:void 0,handler:t})):(n=e.method,I.set(e.method,{type:e,handler:t}))),{dispose:()=>{void 0!==n?I.delete(n):_=void 0}}},onProgress:(e,t,n)=>{if(P.has(t))throw new Error(`Progress handler for token ${t} already registered`);return P.set(t,n),{dispose:()=>{P.delete(t)}}},sendProgress:(e,t,n)=>me.sendNotification(d.type,{token:t,value:n}),onUnhandledProgress:z.event,sendRequest:(e,...t)=>{let r,s,a;if(ue(),function(){if(!Q())throw new Error("Call listen() first.")}(),i.string(e)){r=e;const n=t[0],i=t[t.length-1];let u=0,l=o.ParameterStructures.auto;o.ParameterStructures.is(n)&&(u=1,l=n);let d=t.length;c.CancellationToken.is(i)&&(d-=1,a=i);const f=d-u;switch(f){case 0:s=void 0;break;case 1:s=pe(l,t[u]);break;default:if(l===o.ParameterStructures.byName)throw new Error(`Received ${f} parameters for 'by Name' request parameter structure.`);s=t.slice(u,d).map((e=>le(e)))}}else{const n=t;r=e.method,s=he(e,n);const i=e.numberOfParams;a=c.CancellationToken.is(n[i])?n[i]:void 0}const u=b++;let l;a&&(l=a.onCancellationRequested((()=>{const e=Y.sender.sendCancellation(me,u);return void 0===e?(k.log(`Received no promise from cancellation strategy when cancelling id ${u}`),Promise.resolve()):e.catch((()=>{k.log(`Sending cancellation messages for id ${u} failed`)}))})));const d={jsonrpc:A,id:u,method:r,params:s};return function(e){if(U!==p.Off&&L)if(K===m.Text){let t;U!==p.Verbose&&U!==p.Compact||!e.params||(t=`Params: ${oe(e.params)}\n\n`),L.log(`Sending request '${e.method} - (${e.id})'.`,t)}else ce("send-request",e)}(d),"function"==typeof Y.sender.enableCancellation&&Y.sender.enableCancellation(d),new Promise((async(e,t)=>{const i={method:r,timerStart:Date.now(),resolve:t=>{e(t),Y.sender.cleanup(u),l?.dispose()},reject:e=>{t(e),Y.sender.cleanup(u),l?.dispose()}};try{await n.write(d),F.set(u,i)}catch(e){throw k.error("Sending request failed."),i.reject(new o.ResponseError(o.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),e}}))},onRequest:(e,t)=>{ue();let n=null;return f.is(e)?(n=void 0,N=e):i.string(e)?(n=null,void 0!==t&&(n=e,D.set(e,{handler:t,type:void 0}))):void 0!==t&&(n=e.method,D.set(e.method,{type:e,handler:t})),{dispose:()=>{null!==n&&(void 0!==n?D.delete(n):N=void 0)}}},hasPendingResponse:()=>F.size>0,trace:async(e,t,n)=>{let r=!1,o=m.Text;void 0!==n&&(i.boolean(n)?r=n:(r=n.sendNotification||!1,o=n.traceFormat||m.Text)),U=e,K=o,L=U===p.Off?void 0:t,!r||Z()||ee()||await me.sendNotification(y.type,{value:p.toString(e)})},onError:H.event,onClose:W.event,onUnhandledNotification:B.event,onDispose:V.event,end:()=>{n.end()},dispose:()=>{if(ee())return;G=C.Disposed,V.fire(void 0);const t=new o.ResponseError(o.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const e of F.values())e.reject(t);F=new Map,q=new Map,j=new Set,M=new s.LinkedMap,i.func(n.dispose)&&n.dispose(),i.func(e.dispose)&&e.dispose()},listen:()=>{ue(),function(){if(Q())throw new E(v.AlreadyListening,"Connection is already listening")}(),G=C.Listening,e.listen(ie)},inspect:()=>{(0,r.default)().console.log("inspect")}};return me.onNotification(g.type,(e=>{if(U===p.Off||!L)return;const t=U===p.Verbose||U===p.Compact;L.log(e.message,t?e.verbose:void 0)})),me.onNotification(d.type,(e=>{const t=P.get(e.token);t?t(e.value):z.fire(e)})),me}},4161:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Disposable=void 0,function(e){e.create=function(e){return{dispose:e}}}(n||(t.Disposable=n={}))},1702:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Event=void 0;const r=n(316);var i;!function(e){const t={dispose(){}};e.None=function(){return t}}(i||(t.Event=i={}));class o{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let r=0,i=this._callbacks.length;r<i;r++)if(this._callbacks[r]===e){if(this._contexts[r]===t)return this._callbacks.splice(r,1),void this._contexts.splice(r,1);n=!0}if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=n.length;o<s;o++)try{t.push(n[o].apply(i[o],e))}catch(e){(0,r.default)().console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class s{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new o),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const r={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),r.dispose=s._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(r),r}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=s,s._noop=function(){}},9859:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))}},202:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=t.LinkedMap=t.Touch=void 0,function(e){e.None=0,e.First=1,e.AsOld=e.First,e.Last=2,e.AsNew=e.Last}(r||(t.Touch=r={}));class i{constructor(){this[n]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=r.None){const n=this._map.get(e);if(n)return t!==r.None&&this.touch(n,t),n.value}set(e,t,n=r.None){let i=this._map.get(e);if(i)i.value=t,n!==r.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case r.None:this.addItemLast(i);break;case r.First:this.addItemFirst(i);break;case r.Last:default:this.addItemLast(i)}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const n=this._state;let r=this._head;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.key,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:t.value,done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let t=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const e={value:[t.key,t.value],done:!1};return t=t.next,e}return{value:void 0,done:!0}}};return n}[(n=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(0===e)return void this.clear();let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e,this._state++}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===r.First||t===r.Last)if(t===r.First){if(e===this._head)return;const t=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(t.previous=n,n.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===r.Last){if(e===this._tail)return;const t=e.next,n=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=n,n.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}toJSON(){const e=[];return this.forEach(((t,n)=>{e.push([n,t])})),e}fromJSON(e){this.clear();for(const[t,n]of e)this.set(t,n)}}t.LinkedMap=i,t.LRUCache=class extends i{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=r.AsNew){return super.get(e,t)}peek(e){return super.get(e,r.None)}set(e,t){return super.set(e,t,r.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}},8410:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractMessageBuffer=void 0,t.AbstractMessageBuffer=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(0===this._chunks.length)return;let t=0,n=0,r=0,i=0;e:for(;n<this._chunks.length;){const e=this._chunks[n];for(r=0;r<e.length;){switch(e[r]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,r++;break e;default:t=0}break;default:t=0}r++}i+=e.byteLength,n++}if(4!==t)return;const o=this._read(i+r),s=new Map,a=this.toString(o,"ascii").split("\r\n");if(a.length<2)return s;for(let t=0;t<a.length-2;t++){const n=a[t],r=n.indexOf(":");if(-1===r)throw new Error(`Message header must separate key and value using ':'\n${n}`);const i=n.substr(0,r),o=n.substr(r+1).trim();s.set(e?i.toLowerCase():i,o)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){const t=this._chunks[0],n=this.asNative(t,e);return this._chunks[0]=t.slice(e),this._totalLength-=e,n}const t=this.allocNative(e);let n=0;for(;e>0;){const r=this._chunks[0];if(r.byteLength>e){const i=r.slice(0,e);t.set(i,n),n+=e,this._chunks[0]=r.slice(e),this._totalLength-=e,e-=e}else t.set(r,n),n+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,e-=r.byteLength}return t}}},5667:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableStreamMessageReader=t.AbstractMessageReader=t.MessageReader=void 0;const r=n(316),i=n(9859),o=n(1702),s=n(4457);var a,c;!function(e){e.is=function(e){let t=e;return t&&i.func(t.listen)&&i.func(t.dispose)&&i.func(t.onError)&&i.func(t.onClose)&&i.func(t.onPartialMessage)}}(a||(t.MessageReader=a={}));class u{constructor(){this.errorEmitter=new o.Emitter,this.closeEmitter=new o.Emitter,this.partialMessageEmitter=new o.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageReader=u,function(e){e.fromOptions=function(e){let t,n;const i=new Map;let o;const s=new Map;if(void 0===e||"string"==typeof e)t=e??"utf-8";else{if(t=e.charset??"utf-8",void 0!==e.contentDecoder&&(n=e.contentDecoder,i.set(n.name,n)),void 0!==e.contentDecoders)for(const t of e.contentDecoders)i.set(t.name,t);if(void 0!==e.contentTypeDecoder&&(o=e.contentTypeDecoder,s.set(o.name,o)),void 0!==e.contentTypeDecoders)for(const t of e.contentTypeDecoders)s.set(t.name,t)}return void 0===o&&(o=(0,r.default)().applicationJson.decoder,s.set(o.name,o)),{charset:t,contentDecoder:n,contentDecoders:i,contentTypeDecoder:o,contentTypeDecoders:s}}}(c||(c={})),t.ReadableStreamMessageReader=class extends u{constructor(e,t){super(),this.readable=e,this.options=c.fromOptions(t),this.buffer=(0,r.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new s.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData((e=>{this.onData(e)}));return this.readable.onError((e=>this.fireError(e))),this.readable.onClose((()=>this.fireClose())),t}onData(e){try{for(this.buffer.append(e);;){if(-1===this.nextMessageLength){const e=this.buffer.tryReadHeaders(!0);if(!e)return;const t=e.get("content-length");if(!t)return void this.fireError(new Error(`Header must provide a Content-Length property.\n${JSON.stringify(Object.fromEntries(e))}`));const n=parseInt(t);if(isNaN(n))return void this.fireError(new Error(`Content-Length value must be a number. Got ${t}`));this.nextMessageLength=n}const e=this.buffer.tryReadBody(this.nextMessageLength);if(void 0===e)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock((async()=>{const t=void 0!==this.options.contentDecoder?await this.options.contentDecoder.decode(e):e,n=await this.options.contentTypeDecoder.decode(t,this.options);this.callback(n)})).catch((e=>{this.fireError(e)}))}}catch(e){this.fireError(e)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,r.default)().timer.setTimeout(((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())}),this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}},3459:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteableStreamMessageWriter=t.AbstractMessageWriter=t.MessageWriter=void 0;const r=n(316),i=n(9859),o=n(4457),s=n(1702);var a,c;!function(e){e.is=function(e){let t=e;return t&&i.func(t.dispose)&&i.func(t.onClose)&&i.func(t.onError)&&i.func(t.write)}}(a||(t.MessageWriter=a={}));class u{constructor(){this.errorEmitter=new s.Emitter,this.closeEmitter=new s.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${i.string(e.message)?e.message:"unknown"}`)}}t.AbstractMessageWriter=u,function(e){e.fromOptions=function(e){return void 0===e||"string"==typeof e?{charset:e??"utf-8",contentTypeEncoder:(0,r.default)().applicationJson.encoder}:{charset:e.charset??"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:e.contentTypeEncoder??(0,r.default)().applicationJson.encoder}}}(c||(c={})),t.WriteableStreamMessageWriter=class extends u{constructor(e,t){super(),this.writable=e,this.options=c.fromOptions(t),this.errorCount=0,this.writeSemaphore=new o.Semaphore(1),this.writable.onError((e=>this.fireError(e))),this.writable.onClose((()=>this.fireClose()))}async write(e){return this.writeSemaphore.lock((async()=>this.options.contentTypeEncoder.encode(e,this.options).then((e=>void 0!==this.options.contentEncoder?this.options.contentEncoder.encode(e):e)).then((t=>{const n=[];return n.push("Content-Length: ",t.byteLength.toString(),"\r\n"),n.push("\r\n"),this.doWrite(e,n,t)}),(e=>{throw this.fireError(e),e}))))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}},4399:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Message=t.NotificationType9=t.NotificationType8=t.NotificationType7=t.NotificationType6=t.NotificationType5=t.NotificationType4=t.NotificationType3=t.NotificationType2=t.NotificationType1=t.NotificationType0=t.NotificationType=t.RequestType9=t.RequestType8=t.RequestType7=t.RequestType6=t.RequestType5=t.RequestType4=t.RequestType3=t.RequestType2=t.RequestType1=t.RequestType=t.RequestType0=t.AbstractMessageSignature=t.ParameterStructures=t.ResponseError=t.ErrorCodes=void 0;const r=n(9859);var i,o;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.jsonrpcReservedErrorRangeStart=-32099,e.serverErrorStart=-32099,e.MessageWriteError=-32099,e.MessageReadError=-32098,e.PendingResponseRejected=-32097,e.ConnectionInactive=-32096,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.jsonrpcReservedErrorRangeEnd=-32e3,e.serverErrorEnd=-32e3}(i||(t.ErrorCodes=i={}));class s extends Error{constructor(e,t,n){super(t),this.code=r.number(e)?e:i.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,s.prototype)}toJson(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}t.ResponseError=s;class a{constructor(e){this.kind=e}static is(e){return e===a.auto||e===a.byName||e===a.byPosition}toString(){return this.kind}}t.ParameterStructures=a,a.auto=new a("auto"),a.byPosition=new a("byPosition"),a.byName=new a("byName");class c{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return a.auto}}t.AbstractMessageSignature=c,t.RequestType0=class extends c{constructor(e){super(e,0)}},t.RequestType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.RequestType2=class extends c{constructor(e){super(e,2)}},t.RequestType3=class extends c{constructor(e){super(e,3)}},t.RequestType4=class extends c{constructor(e){super(e,4)}},t.RequestType5=class extends c{constructor(e){super(e,5)}},t.RequestType6=class extends c{constructor(e){super(e,6)}},t.RequestType7=class extends c{constructor(e){super(e,7)}},t.RequestType8=class extends c{constructor(e){super(e,8)}},t.RequestType9=class extends c{constructor(e){super(e,9)}},t.NotificationType=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType0=class extends c{constructor(e){super(e,0)}},t.NotificationType1=class extends c{constructor(e,t=a.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}},t.NotificationType2=class extends c{constructor(e){super(e,2)}},t.NotificationType3=class extends c{constructor(e){super(e,3)}},t.NotificationType4=class extends c{constructor(e){super(e,4)}},t.NotificationType5=class extends c{constructor(e){super(e,5)}},t.NotificationType6=class extends c{constructor(e){super(e,6)}},t.NotificationType7=class extends c{constructor(e){super(e,7)}},t.NotificationType8=class extends c{constructor(e){super(e,8)}},t.NotificationType9=class extends c{constructor(e){super(e,9)}},function(e){e.isRequest=function(e){const t=e;return t&&r.string(t.method)&&(r.string(t.id)||r.number(t.id))},e.isNotification=function(e){const t=e;return t&&r.string(t.method)&&void 0===e.id},e.isResponse=function(e){const t=e;return t&&(void 0!==t.result||!!t.error)&&(r.string(t.id)||r.number(t.id)||null===t.id)}}(o||(t.Message=o={}))},316:(e,t)=>{let n;function r(){if(void 0===n)throw new Error("No runtime abstraction layer installed");return n}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.install=function(e){if(void 0===e)throw new Error("No runtime abstraction layer provided");n=e}}(r||(r={})),t.default=r},4457:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Semaphore=void 0;const r=n(316);t.Semaphore=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise(((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()}))}get active(){return this._active}runNext(){0!==this._waiting.length&&this._active!==this._capacity&&(0,r.default)().timer.setImmediate((()=>this.doRunNext()))}doRunNext(){if(0===this._waiting.length||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then((t=>{this._active--,e.resolve(t),this.runNext()}),(t=>{this._active--,e.reject(t),this.runNext()})):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}},8130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SharedArrayReceiverStrategy=t.SharedArraySenderStrategy=void 0;const r=n(4628);var i;!function(e){e.Continue=0,e.Cancelled=1}(i||(i={})),t.SharedArraySenderStrategy=class{constructor(){this.buffers=new Map}enableCancellation(e){if(null===e.id)return;const t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=i.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const n=this.buffers.get(t);if(void 0===n)return;const r=new Int32Array(n,0,1);Atomics.store(r,0,i.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};class o{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===i.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class s{constructor(e){this.token=new o(e)}cancel(){}dispose(){}}t.SharedArrayReceiverStrategy=class{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return void 0===t?new r.CancellationTokenSource:new s(t)}}},9264:(e,t,n)=>{e.exports=n(2542)},2542:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const o=n(4601);i(n(4601),t),i(n(3504),t),t.createProtocolConnection=function(e,t,n,r){return(0,o.createMessageConnection)(e,t,n,r)}},3504:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.LSPErrorCodes=t.createProtocolConnection=void 0,i(n(141),t),i(n(5879),t),i(n(4722),t),i(n(9954),t);var o,s=n(6478);Object.defineProperty(t,"createProtocolConnection",{enumerable:!0,get:function(){return s.createProtocolConnection}}),function(e){e.lspReservedErrorRangeStart=-32899,e.RequestFailed=-32803,e.ServerCancelled=-32802,e.ContentModified=-32801,e.RequestCancelled=-32800,e.lspReservedErrorRangeEnd=-32800}(o||(t.LSPErrorCodes=o={}))},6478:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createProtocolConnection=void 0;const r=n(141);t.createProtocolConnection=function(e,t,n,i){return r.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,r.createMessageConnection)(e,t,n,i)}},4722:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtocolNotificationType=t.ProtocolNotificationType0=t.ProtocolRequestType=t.ProtocolRequestType0=t.RegistrationType=t.MessageDirection=void 0;const r=n(141);var i;!function(e){e.clientToServer="clientToServer",e.serverToClient="serverToClient",e.both="both"}(i||(t.MessageDirection=i={})),t.RegistrationType=class{constructor(e){this.method=e}};class o extends r.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=o;class s extends r.RequestType{constructor(e){super(e,r.ParameterStructures.byName)}}t.ProtocolRequestType=s;class a extends r.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a;class c extends r.NotificationType{constructor(e){super(e,r.ParameterStructures.byName)}}t.ProtocolNotificationType=c},3347:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.CallHierarchyPrepareRequest=void 0;const r=n(4722);var i,o,s;!function(e){e.method="textDocument/prepareCallHierarchy",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.CallHierarchyPrepareRequest=i={})),function(e){e.method="callHierarchy/incomingCalls",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(o||(t.CallHierarchyIncomingCallsRequest=o={})),function(e){e.method="callHierarchy/outgoingCalls",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(s||(t.CallHierarchyOutgoingCallsRequest=s={}))},6182:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorPresentationRequest=t.DocumentColorRequest=void 0;const r=n(4722);var i,o;!function(e){e.method="textDocument/documentColor",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.DocumentColorRequest=i={})),function(e){e.method="textDocument/colorPresentation",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(o||(t.ColorPresentationRequest=o={}))},7962:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationRequest=void 0;const r=n(4722);var i;!function(e){e.method="workspace/configuration",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(i||(t.ConfigurationRequest=i={}))},7568:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeclarationRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/declaration",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.DeclarationRequest=i={}))},7009:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=void 0;const r=n(141),i=n(6352),o=n(4722);var s,a,c,u,l;!function(e){e.is=function(e){const t=e;return t&&i.boolean(t.retriggerRequest)}}(s||(t.DiagnosticServerCancellationData=s={})),function(e){e.Full="full",e.Unchanged="unchanged"}(a||(t.DocumentDiagnosticReportKind=a={})),function(e){e.method="textDocument/diagnostic",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolRequestType(e.method),e.partialResult=new r.ProgressType}(c||(t.DocumentDiagnosticRequest=c={})),function(e){e.method="workspace/diagnostic",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolRequestType(e.method),e.partialResult=new r.ProgressType}(u||(t.WorkspaceDiagnosticRequest=u={})),function(e){e.method="workspace/diagnostic/refresh",e.messageDirection=o.MessageDirection.serverToClient,e.type=new o.ProtocolRequestType0(e.method)}(l||(t.DiagnosticRefreshRequest=l={}))},9650:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.DidRenameFilesNotification=t.WillRenameFilesRequest=t.DidCreateFilesNotification=t.WillCreateFilesRequest=t.FileOperationPatternKind=void 0;const r=n(4722);var i,o,s,a,c,u,l;!function(e){e.file="file",e.folder="folder"}(i||(t.FileOperationPatternKind=i={})),function(e){e.method="workspace/willCreateFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(o||(t.WillCreateFilesRequest=o={})),function(e){e.method="workspace/didCreateFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(s||(t.DidCreateFilesNotification=s={})),function(e){e.method="workspace/willRenameFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(a||(t.WillRenameFilesRequest=a={})),function(e){e.method="workspace/didRenameFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(c||(t.DidRenameFilesNotification=c={})),function(e){e.method="workspace/didDeleteFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(u||(t.DidDeleteFilesNotification=u={})),function(e){e.method="workspace/willDeleteFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(l||(t.WillDeleteFilesRequest=l={}))},5984:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=void 0;const r=n(4722);var i,o;!function(e){e.method="textDocument/foldingRange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.FoldingRangeRequest=i={})),function(e){e.method="workspace/foldingRange/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(o||(t.FoldingRangeRefreshRequest=o={}))},1748:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImplementationRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/implementation",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.ImplementationRequest=i={}))},8006:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=void 0;const r=n(4722);var i,o,s;!function(e){e.method="textDocument/inlayHint",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.InlayHintRequest=i={})),function(e){e.method="inlayHint/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(o||(t.InlayHintResolveRequest=o={})),function(e){e.method="workspace/inlayHint/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(s||(t.InlayHintRefreshRequest=s={}))},9877:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/inlineCompletion",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.InlineCompletionRequest=i={}))},3254:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueRefreshRequest=t.InlineValueRequest=void 0;const r=n(4722);var i,o;!function(e){e.method="textDocument/inlineValue",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.InlineValueRequest=i={})),function(e){e.method="workspace/inlineValue/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(o||(t.InlineValueRefreshRequest=o={}))},9954:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceSymbolRequest=t.CodeActionResolveRequest=t.CodeActionRequest=t.DocumentSymbolRequest=t.DocumentHighlightRequest=t.ReferencesRequest=t.DefinitionRequest=t.SignatureHelpRequest=t.SignatureHelpTriggerKind=t.HoverRequest=t.CompletionResolveRequest=t.CompletionRequest=t.CompletionTriggerKind=t.PublishDiagnosticsNotification=t.WatchKind=t.RelativePattern=t.FileChangeType=t.DidChangeWatchedFilesNotification=t.WillSaveTextDocumentWaitUntilRequest=t.WillSaveTextDocumentNotification=t.TextDocumentSaveReason=t.DidSaveTextDocumentNotification=t.DidCloseTextDocumentNotification=t.DidChangeTextDocumentNotification=t.TextDocumentContentChangeEvent=t.DidOpenTextDocumentNotification=t.TextDocumentSyncKind=t.TelemetryEventNotification=t.LogMessageNotification=t.ShowMessageRequest=t.ShowMessageNotification=t.MessageType=t.DidChangeConfigurationNotification=t.ExitNotification=t.ShutdownRequest=t.InitializedNotification=t.InitializeErrorCodes=t.InitializeRequest=t.WorkDoneProgressOptions=t.TextDocumentRegistrationOptions=t.StaticRegistrationOptions=t.PositionEncodingKind=t.FailureHandlingKind=t.ResourceOperationKind=t.UnregistrationRequest=t.RegistrationRequest=t.DocumentSelector=t.NotebookCellTextDocumentFilter=t.NotebookDocumentFilter=t.TextDocumentFilter=void 0,t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=t.WillDeleteFilesRequest=t.DidDeleteFilesNotification=t.WillRenameFilesRequest=t.DidRenameFilesNotification=t.WillCreateFilesRequest=t.DidCreateFilesNotification=t.FileOperationPatternKind=t.LinkedEditingRangeRequest=t.ShowDocumentRequest=t.SemanticTokensRegistrationType=t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.TokenFormat=t.CallHierarchyPrepareRequest=t.CallHierarchyOutgoingCallsRequest=t.CallHierarchyIncomingCallsRequest=t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=t.SelectionRangeRequest=t.DeclarationRequest=t.FoldingRangeRefreshRequest=t.FoldingRangeRequest=t.ColorPresentationRequest=t.DocumentColorRequest=t.ConfigurationRequest=t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=t.TypeDefinitionRequest=t.ImplementationRequest=t.ApplyWorkspaceEditRequest=t.ExecuteCommandRequest=t.PrepareRenameRequest=t.RenameRequest=t.PrepareSupportDefaultBehavior=t.DocumentOnTypeFormattingRequest=t.DocumentRangesFormattingRequest=t.DocumentRangeFormattingRequest=t.DocumentFormattingRequest=t.DocumentLinkResolveRequest=t.DocumentLinkRequest=t.CodeLensRefreshRequest=t.CodeLensResolveRequest=t.CodeLensRequest=t.WorkspaceSymbolResolveRequest=void 0,t.InlineCompletionRequest=t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=t.DiagnosticRefreshRequest=t.WorkspaceDiagnosticRequest=t.DocumentDiagnosticRequest=t.DocumentDiagnosticReportKind=t.DiagnosticServerCancellationData=t.InlayHintRefreshRequest=t.InlayHintResolveRequest=t.InlayHintRequest=t.InlineValueRefreshRequest=t.InlineValueRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchySubtypesRequest=t.TypeHierarchyPrepareRequest=void 0;const r=n(4722),i=n(5879),o=n(6352),s=n(1748);Object.defineProperty(t,"ImplementationRequest",{enumerable:!0,get:function(){return s.ImplementationRequest}});const a=n(3871);Object.defineProperty(t,"TypeDefinitionRequest",{enumerable:!0,get:function(){return a.TypeDefinitionRequest}});const c=n(1657);Object.defineProperty(t,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return c.WorkspaceFoldersRequest}}),Object.defineProperty(t,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return c.DidChangeWorkspaceFoldersNotification}});const u=n(7962);Object.defineProperty(t,"ConfigurationRequest",{enumerable:!0,get:function(){return u.ConfigurationRequest}});const l=n(6182);Object.defineProperty(t,"DocumentColorRequest",{enumerable:!0,get:function(){return l.DocumentColorRequest}}),Object.defineProperty(t,"ColorPresentationRequest",{enumerable:!0,get:function(){return l.ColorPresentationRequest}});const d=n(5984);Object.defineProperty(t,"FoldingRangeRequest",{enumerable:!0,get:function(){return d.FoldingRangeRequest}}),Object.defineProperty(t,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return d.FoldingRangeRefreshRequest}});const f=n(7568);Object.defineProperty(t,"DeclarationRequest",{enumerable:!0,get:function(){return f.DeclarationRequest}});const p=n(7309);Object.defineProperty(t,"SelectionRangeRequest",{enumerable:!0,get:function(){return p.SelectionRangeRequest}});const h=n(1049);Object.defineProperty(t,"WorkDoneProgress",{enumerable:!0,get:function(){return h.WorkDoneProgress}}),Object.defineProperty(t,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return h.WorkDoneProgressCreateRequest}}),Object.defineProperty(t,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return h.WorkDoneProgressCancelNotification}});const m=n(3347);Object.defineProperty(t,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(t,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return m.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(t,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return m.CallHierarchyPrepareRequest}});const y=n(3148);Object.defineProperty(t,"TokenFormat",{enumerable:!0,get:function(){return y.TokenFormat}}),Object.defineProperty(t,"SemanticTokensRequest",{enumerable:!0,get:function(){return y.SemanticTokensRequest}}),Object.defineProperty(t,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return y.SemanticTokensDeltaRequest}}),Object.defineProperty(t,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return y.SemanticTokensRangeRequest}}),Object.defineProperty(t,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return y.SemanticTokensRefreshRequest}}),Object.defineProperty(t,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return y.SemanticTokensRegistrationType}});const g=n(8166);Object.defineProperty(t,"ShowDocumentRequest",{enumerable:!0,get:function(){return g.ShowDocumentRequest}});const v=n(7010);Object.defineProperty(t,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return v.LinkedEditingRangeRequest}});const T=n(9650);Object.defineProperty(t,"FileOperationPatternKind",{enumerable:!0,get:function(){return T.FileOperationPatternKind}}),Object.defineProperty(t,"DidCreateFilesNotification",{enumerable:!0,get:function(){return T.DidCreateFilesNotification}}),Object.defineProperty(t,"WillCreateFilesRequest",{enumerable:!0,get:function(){return T.WillCreateFilesRequest}}),Object.defineProperty(t,"DidRenameFilesNotification",{enumerable:!0,get:function(){return T.DidRenameFilesNotification}}),Object.defineProperty(t,"WillRenameFilesRequest",{enumerable:!0,get:function(){return T.WillRenameFilesRequest}}),Object.defineProperty(t,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return T.DidDeleteFilesNotification}}),Object.defineProperty(t,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return T.WillDeleteFilesRequest}});const R=n(6461);Object.defineProperty(t,"UniquenessLevel",{enumerable:!0,get:function(){return R.UniquenessLevel}}),Object.defineProperty(t,"MonikerKind",{enumerable:!0,get:function(){return R.MonikerKind}}),Object.defineProperty(t,"MonikerRequest",{enumerable:!0,get:function(){return R.MonikerRequest}});const k=n(9071);Object.defineProperty(t,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return k.TypeHierarchyPrepareRequest}}),Object.defineProperty(t,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySubtypesRequest}}),Object.defineProperty(t,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return k.TypeHierarchySupertypesRequest}});const b=n(3254);Object.defineProperty(t,"InlineValueRequest",{enumerable:!0,get:function(){return b.InlineValueRequest}}),Object.defineProperty(t,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return b.InlineValueRefreshRequest}});const w=n(8006);Object.defineProperty(t,"InlayHintRequest",{enumerable:!0,get:function(){return w.InlayHintRequest}}),Object.defineProperty(t,"InlayHintResolveRequest",{enumerable:!0,get:function(){return w.InlayHintResolveRequest}}),Object.defineProperty(t,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return w.InlayHintRefreshRequest}});const S=n(7009);Object.defineProperty(t,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return S.DiagnosticServerCancellationData}}),Object.defineProperty(t,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return S.DocumentDiagnosticReportKind}}),Object.defineProperty(t,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return S.DocumentDiagnosticRequest}}),Object.defineProperty(t,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return S.WorkspaceDiagnosticRequest}}),Object.defineProperty(t,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return S.DiagnosticRefreshRequest}});const $=n(6703);Object.defineProperty(t,"NotebookCellKind",{enumerable:!0,get:function(){return $.NotebookCellKind}}),Object.defineProperty(t,"ExecutionSummary",{enumerable:!0,get:function(){return $.ExecutionSummary}}),Object.defineProperty(t,"NotebookCell",{enumerable:!0,get:function(){return $.NotebookCell}}),Object.defineProperty(t,"NotebookDocument",{enumerable:!0,get:function(){return $.NotebookDocument}}),Object.defineProperty(t,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return $.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(t,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return $.DidOpenNotebookDocumentNotification}}),Object.defineProperty(t,"NotebookCellArrayChange",{enumerable:!0,get:function(){return $.NotebookCellArrayChange}}),Object.defineProperty(t,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return $.DidChangeNotebookDocumentNotification}}),Object.defineProperty(t,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return $.DidSaveNotebookDocumentNotification}}),Object.defineProperty(t,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return $.DidCloseNotebookDocumentNotification}});const x=n(9877);var C,E,A,N,D,_,I,P,O,L,M,F,j,q,U,K,G,H,W,B,z,V,Y,X,J,Q,Z,ee,te,ne,re,ie,oe,se,ae,ce,ue,le,de,fe,pe,he,me,ye,ge,ve,Te,Re,ke,be,we,Se,$e,xe,Ce,Ee,Ae,Ne,De,_e,Ie,Pe,Oe,Le,Me;Object.defineProperty(t,"InlineCompletionRequest",{enumerable:!0,get:function(){return x.InlineCompletionRequest}}),function(e){e.is=function(e){const t=e;return o.string(t)||o.string(t.language)||o.string(t.scheme)||o.string(t.pattern)}}(C||(t.TextDocumentFilter=C={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(o.string(t.notebookType)||o.string(t.scheme)||o.string(t.pattern))}}(E||(t.NotebookDocumentFilter=E={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(o.string(t.notebook)||E.is(t.notebook))&&(void 0===t.language||o.string(t.language))}}(A||(t.NotebookCellTextDocumentFilter=A={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!o.string(t)&&!C.is(t)&&!A.is(t))return!1;return!0}}(N||(t.DocumentSelector=N={})),function(e){e.method="client/registerCapability",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(D||(t.RegistrationRequest=D={})),function(e){e.method="client/unregisterCapability",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(_||(t.UnregistrationRequest=_={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(I||(t.ResourceOperationKind=I={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(P||(t.FailureHandlingKind=P={})),function(e){e.UTF8="utf-8",e.UTF16="utf-16",e.UTF32="utf-32"}(O||(t.PositionEncodingKind=O={})),function(e){e.hasId=function(e){const t=e;return t&&o.string(t.id)&&t.id.length>0}}(L||(t.StaticRegistrationOptions=L={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||N.is(t.documentSelector))}}(M||(t.TextDocumentRegistrationOptions=M={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(void 0===t.workDoneProgress||o.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&o.boolean(t.workDoneProgress)}}(F||(t.WorkDoneProgressOptions=F={})),function(e){e.method="initialize",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(j||(t.InitializeRequest=j={})),function(e){e.unknownProtocolVersion=1}(q||(t.InitializeErrorCodes=q={})),function(e){e.method="initialized",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(U||(t.InitializedNotification=U={})),function(e){e.method="shutdown",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType0(e.method)}(K||(t.ShutdownRequest=K={})),function(e){e.method="exit",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType0(e.method)}(G||(t.ExitNotification=G={})),function(e){e.method="workspace/didChangeConfiguration",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(H||(t.DidChangeConfigurationNotification=H={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4,e.Debug=5}(W||(t.MessageType=W={})),function(e){e.method="window/showMessage",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolNotificationType(e.method)}(B||(t.ShowMessageNotification=B={})),function(e){e.method="window/showMessageRequest",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(z||(t.ShowMessageRequest=z={})),function(e){e.method="window/logMessage",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolNotificationType(e.method)}(V||(t.LogMessageNotification=V={})),function(e){e.method="telemetry/event",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolNotificationType(e.method)}(Y||(t.TelemetryEventNotification=Y={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(X||(t.TextDocumentSyncKind=X={})),function(e){e.method="textDocument/didOpen",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(J||(t.DidOpenTextDocumentNotification=J={})),function(e){e.isIncremental=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)},e.isFull=function(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}(Q||(t.TextDocumentContentChangeEvent=Q={})),function(e){e.method="textDocument/didChange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(Z||(t.DidChangeTextDocumentNotification=Z={})),function(e){e.method="textDocument/didClose",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(ee||(t.DidCloseTextDocumentNotification=ee={})),function(e){e.method="textDocument/didSave",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(te||(t.DidSaveTextDocumentNotification=te={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(ne||(t.TextDocumentSaveReason=ne={})),function(e){e.method="textDocument/willSave",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(re||(t.WillSaveTextDocumentNotification=re={})),function(e){e.method="textDocument/willSaveWaitUntil",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(ie||(t.WillSaveTextDocumentWaitUntilRequest=ie={})),function(e){e.method="workspace/didChangeWatchedFiles",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(oe||(t.DidChangeWatchedFilesNotification=oe={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(se||(t.FileChangeType=se={})),function(e){e.is=function(e){const t=e;return o.objectLiteral(t)&&(i.URI.is(t.baseUri)||i.WorkspaceFolder.is(t.baseUri))&&o.string(t.pattern)}}(ae||(t.RelativePattern=ae={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(ce||(t.WatchKind=ce={})),function(e){e.method="textDocument/publishDiagnostics",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolNotificationType(e.method)}(ue||(t.PublishDiagnosticsNotification=ue={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(le||(t.CompletionTriggerKind=le={})),function(e){e.method="textDocument/completion",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(de||(t.CompletionRequest=de={})),function(e){e.method="completionItem/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(fe||(t.CompletionResolveRequest=fe={})),function(e){e.method="textDocument/hover",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(pe||(t.HoverRequest=pe={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(he||(t.SignatureHelpTriggerKind=he={})),function(e){e.method="textDocument/signatureHelp",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(me||(t.SignatureHelpRequest=me={})),function(e){e.method="textDocument/definition",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(ye||(t.DefinitionRequest=ye={})),function(e){e.method="textDocument/references",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(ge||(t.ReferencesRequest=ge={})),function(e){e.method="textDocument/documentHighlight",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(ve||(t.DocumentHighlightRequest=ve={})),function(e){e.method="textDocument/documentSymbol",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Te||(t.DocumentSymbolRequest=Te={})),function(e){e.method="textDocument/codeAction",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Re||(t.CodeActionRequest=Re={})),function(e){e.method="codeAction/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(ke||(t.CodeActionResolveRequest=ke={})),function(e){e.method="workspace/symbol",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(be||(t.WorkspaceSymbolRequest=be={})),function(e){e.method="workspaceSymbol/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(we||(t.WorkspaceSymbolResolveRequest=we={})),function(e){e.method="textDocument/codeLens",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Se||(t.CodeLensRequest=Se={})),function(e){e.method="codeLens/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}($e||(t.CodeLensResolveRequest=$e={})),function(e){e.method="workspace/codeLens/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(xe||(t.CodeLensRefreshRequest=xe={})),function(e){e.method="textDocument/documentLink",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Ce||(t.DocumentLinkRequest=Ce={})),function(e){e.method="documentLink/resolve",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Ee||(t.DocumentLinkResolveRequest=Ee={})),function(e){e.method="textDocument/formatting",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Ae||(t.DocumentFormattingRequest=Ae={})),function(e){e.method="textDocument/rangeFormatting",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Ne||(t.DocumentRangeFormattingRequest=Ne={})),function(e){e.method="textDocument/rangesFormatting",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(De||(t.DocumentRangesFormattingRequest=De={})),function(e){e.method="textDocument/onTypeFormatting",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(_e||(t.DocumentOnTypeFormattingRequest=_e={})),function(e){e.Identifier=1}(Ie||(t.PrepareSupportDefaultBehavior=Ie={})),function(e){e.method="textDocument/rename",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Pe||(t.RenameRequest=Pe={})),function(e){e.method="textDocument/prepareRename",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Oe||(t.PrepareRenameRequest=Oe={})),function(e){e.method="workspace/executeCommand",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(Le||(t.ExecuteCommandRequest=Le={})),function(e){e.method="workspace/applyEdit",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType("workspace/applyEdit")}(Me||(t.ApplyWorkspaceEditRequest=Me={}))},7010:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/linkedEditingRange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.LinkedEditingRangeRequest=i={}))},6461:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerRequest=t.MonikerKind=t.UniquenessLevel=void 0;const r=n(4722);var i,o,s;!function(e){e.document="document",e.project="project",e.group="group",e.scheme="scheme",e.global="global"}(i||(t.UniquenessLevel=i={})),function(e){e.$import="import",e.$export="export",e.local="local"}(o||(t.MonikerKind=o={})),function(e){e.method="textDocument/moniker",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(s||(t.MonikerRequest=s={}))},6703:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DidCloseNotebookDocumentNotification=t.DidSaveNotebookDocumentNotification=t.DidChangeNotebookDocumentNotification=t.NotebookCellArrayChange=t.DidOpenNotebookDocumentNotification=t.NotebookDocumentSyncRegistrationType=t.NotebookDocument=t.NotebookCell=t.ExecutionSummary=t.NotebookCellKind=void 0;const r=n(5879),i=n(6352),o=n(4722);var s,a,c,u,l,d,f,p,h,m;!function(e){e.Markup=1,e.Code=2,e.is=function(e){return 1===e||2===e}}(s||(t.NotebookCellKind=s={})),function(e){e.create=function(e,t){const n={executionOrder:e};return!0!==t&&!1!==t||(n.success=t),n},e.is=function(e){const t=e;return i.objectLiteral(t)&&r.uinteger.is(t.executionOrder)&&(void 0===t.success||i.boolean(t.success))},e.equals=function(e,t){return e===t||null!=e&&null!=t&&e.executionOrder===t.executionOrder&&e.success===t.success}}(a||(t.ExecutionSummary=a={})),function(e){function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(typeof e!=typeof n)return!1;if("object"!=typeof e)return!1;const r=Array.isArray(e),o=Array.isArray(n);if(r!==o)return!1;if(r&&o){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1}if(i.objectLiteral(e)&&i.objectLiteral(n)){const r=Object.keys(e),i=Object.keys(n);if(r.length!==i.length)return!1;if(r.sort(),i.sort(),!t(r,i))return!1;for(let i=0;i<r.length;i++){const o=r[i];if(!t(e[o],n[o]))return!1}}return!0}e.create=function(e,t){return{kind:e,document:t}},e.is=function(e){const t=e;return i.objectLiteral(t)&&s.is(t.kind)&&r.DocumentUri.is(t.document)&&(void 0===t.metadata||i.objectLiteral(t.metadata))},e.diff=function(e,n){const r=new Set;return e.document!==n.document&&r.add("document"),e.kind!==n.kind&&r.add("kind"),e.executionSummary!==n.executionSummary&&r.add("executionSummary"),void 0===e.metadata&&void 0===n.metadata||t(e.metadata,n.metadata)||r.add("metadata"),void 0===e.executionSummary&&void 0===n.executionSummary||a.equals(e.executionSummary,n.executionSummary)||r.add("executionSummary"),r}}(c||(t.NotebookCell=c={})),function(e){e.create=function(e,t,n,r){return{uri:e,notebookType:t,version:n,cells:r}},e.is=function(e){const t=e;return i.objectLiteral(t)&&i.string(t.uri)&&r.integer.is(t.version)&&i.typedArray(t.cells,c.is)}}(u||(t.NotebookDocument=u={})),function(e){e.method="notebookDocument/sync",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.RegistrationType(e.method)}(l||(t.NotebookDocumentSyncRegistrationType=l={})),function(e){e.method="notebookDocument/didOpen",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(d||(t.DidOpenNotebookDocumentNotification=d={})),function(e){e.is=function(e){const t=e;return i.objectLiteral(t)&&r.uinteger.is(t.start)&&r.uinteger.is(t.deleteCount)&&(void 0===t.cells||i.typedArray(t.cells,c.is))},e.create=function(e,t,n){const r={start:e,deleteCount:t};return void 0!==n&&(r.cells=n),r}}(f||(t.NotebookCellArrayChange=f={})),function(e){e.method="notebookDocument/didChange",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(p||(t.DidChangeNotebookDocumentNotification=p={})),function(e){e.method="notebookDocument/didSave",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(h||(t.DidSaveNotebookDocumentNotification=h={})),function(e){e.method="notebookDocument/didClose",e.messageDirection=o.MessageDirection.clientToServer,e.type=new o.ProtocolNotificationType(e.method),e.registrationMethod=l.method}(m||(t.DidCloseNotebookDocumentNotification=m={}))},1049:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkDoneProgressCancelNotification=t.WorkDoneProgressCreateRequest=t.WorkDoneProgress=void 0;const r=n(141),i=n(4722);var o,s,a;!function(e){e.type=new r.ProgressType,e.is=function(t){return t===e.type}}(o||(t.WorkDoneProgress=o={})),function(e){e.method="window/workDoneProgress/create",e.messageDirection=i.MessageDirection.serverToClient,e.type=new i.ProtocolRequestType(e.method)}(s||(t.WorkDoneProgressCreateRequest=s={})),function(e){e.method="window/workDoneProgress/cancel",e.messageDirection=i.MessageDirection.clientToServer,e.type=new i.ProtocolNotificationType(e.method)}(a||(t.WorkDoneProgressCancelNotification=a={}))},7309:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/selectionRange",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.SelectionRangeRequest=i={}))},3148:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensRefreshRequest=t.SemanticTokensRangeRequest=t.SemanticTokensDeltaRequest=t.SemanticTokensRequest=t.SemanticTokensRegistrationType=t.TokenFormat=void 0;const r=n(4722);var i,o,s,a,c,u;!function(e){e.Relative="relative"}(i||(t.TokenFormat=i={})),function(e){e.method="textDocument/semanticTokens",e.type=new r.RegistrationType(e.method)}(o||(t.SemanticTokensRegistrationType=o={})),function(e){e.method="textDocument/semanticTokens/full",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.registrationMethod=o.method}(s||(t.SemanticTokensRequest=s={})),function(e){e.method="textDocument/semanticTokens/full/delta",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.registrationMethod=o.method}(a||(t.SemanticTokensDeltaRequest=a={})),function(e){e.method="textDocument/semanticTokens/range",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method),e.registrationMethod=o.method}(c||(t.SemanticTokensRangeRequest=c={})),function(e){e.method="workspace/semanticTokens/refresh",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(u||(t.SemanticTokensRefreshRequest=u={}))},8166:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentRequest=void 0;const r=n(4722);var i;!function(e){e.method="window/showDocument",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType(e.method)}(i||(t.ShowDocumentRequest=i={}))},3871:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeDefinitionRequest=void 0;const r=n(4722);var i;!function(e){e.method="textDocument/typeDefinition",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.TypeDefinitionRequest=i={}))},9071:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchySubtypesRequest=t.TypeHierarchySupertypesRequest=t.TypeHierarchyPrepareRequest=void 0;const r=n(4722);var i,o,s;!function(e){e.method="textDocument/prepareTypeHierarchy",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(i||(t.TypeHierarchyPrepareRequest=i={})),function(e){e.method="typeHierarchy/supertypes",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(o||(t.TypeHierarchySupertypesRequest=o={})),function(e){e.method="typeHierarchy/subtypes",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolRequestType(e.method)}(s||(t.TypeHierarchySubtypesRequest=s={}))},1657:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DidChangeWorkspaceFoldersNotification=t.WorkspaceFoldersRequest=void 0;const r=n(4722);var i,o;!function(e){e.method="workspace/workspaceFolders",e.messageDirection=r.MessageDirection.serverToClient,e.type=new r.ProtocolRequestType0(e.method)}(i||(t.WorkspaceFoldersRequest=i={})),function(e){e.method="workspace/didChangeWorkspaceFolders",e.messageDirection=r.MessageDirection.clientToServer,e.type=new r.ProtocolNotificationType(e.method)}(o||(t.DidChangeWorkspaceFoldersNotification=o={}))},6352:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.objectLiteral=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},8729:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=void 0;const o=n(2407);i(n(9264),t),i(n(2407),t);let s=!1;const a={initialize:e=>{},get shutdownReceived(){return s},set shutdownReceived(e){s=e},exit:e=>{}};t.createConnection=function(e,t,n,r){let i,s,c,u;return void 0!==e&&"features"===e.__brand&&(i=e,e=t,t=n,n=r),o.ConnectionStrategy.is(e)||o.ConnectionOptions.is(e)?u=e:(s=e,c=t,u=n),(0,o.createConnection)((e=>(0,o.createProtocolConnection)(s,c,e,u)),a,i)}},2407:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.ProposedFeatures=t.NotebookDocuments=t.TextDocuments=t.SemanticTokensBuilder=void 0;const o=n(2737);Object.defineProperty(t,"SemanticTokensBuilder",{enumerable:!0,get:function(){return o.SemanticTokensBuilder}});const s=n(6466);i(n(2542),t);const a=n(2096);Object.defineProperty(t,"TextDocuments",{enumerable:!0,get:function(){return a.TextDocuments}});const c=n(586);var u;Object.defineProperty(t,"NotebookDocuments",{enumerable:!0,get:function(){return c.NotebookDocuments}}),i(n(2664),t),function(e){e.all={__brand:"features",languages:s.InlineCompletionFeature}}(u||(t.ProposedFeatures=u={}))},6744:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallHierarchyFeature=void 0;const r=n(2542);t.CallHierarchyFeature=e=>class extends e{get callHierarchy(){return{onPrepare:e=>this.connection.onRequest(r.CallHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onIncomingCalls:e=>{const t=r.CallHierarchyIncomingCallsRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onOutgoingCalls:e=>{const t=r.CallHierarchyOutgoingCallsRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},5501:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationFeature=void 0;const r=n(2542),i=n(1485);t.ConfigurationFeature=e=>class extends e{getConfiguration(e){return e?i.string(e)?this._getConfiguration({section:e}):this._getConfiguration(e):this._getConfiguration({})}_getConfiguration(e){let t={items:Array.isArray(e)?e:[e]};return this.connection.sendRequest(r.ConfigurationRequest.type,t).then((t=>Array.isArray(t)?Array.isArray(e)?t:t[0]:Array.isArray(e)?[]:null))}}},5764:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagnosticFeature=void 0;const r=n(2542);t.DiagnosticFeature=e=>class extends e{get diagnostics(){return{refresh:()=>this.connection.sendRequest(r.DiagnosticRefreshRequest.type),on:e=>this.connection.onRequest(r.DocumentDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(r.DocumentDiagnosticRequest.partialResult,t)))),onWorkspace:e=>this.connection.onRequest(r.WorkspaceDiagnosticRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),this.attachPartialResultProgress(r.WorkspaceDiagnosticRequest.partialResult,t))))}}}},4663:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileOperationsFeature=void 0;const r=n(2542);t.FileOperationsFeature=e=>class extends e{onDidCreateFiles(e){return this.connection.onNotification(r.DidCreateFilesNotification.type,(t=>{e(t)}))}onDidRenameFiles(e){return this.connection.onNotification(r.DidRenameFilesNotification.type,(t=>{e(t)}))}onDidDeleteFiles(e){return this.connection.onNotification(r.DidDeleteFilesNotification.type,(t=>{e(t)}))}onWillCreateFiles(e){return this.connection.onRequest(r.WillCreateFilesRequest.type,((t,n)=>e(t,n)))}onWillRenameFiles(e){return this.connection.onRequest(r.WillRenameFilesRequest.type,((t,n)=>e(t,n)))}onWillDeleteFiles(e){return this.connection.onRequest(r.WillDeleteFilesRequest.type,((t,n)=>e(t,n)))}}},2345:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FoldingRangeFeature=void 0;const r=n(2542);t.FoldingRangeFeature=e=>class extends e{get foldingRange(){return{refresh:()=>this.connection.sendRequest(r.FoldingRangeRefreshRequest.type),on:e=>{const t=r.FoldingRangeRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},2877:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlayHintFeature=void 0;const r=n(2542);t.InlayHintFeature=e=>class extends e{get inlayHint(){return{refresh:()=>this.connection.sendRequest(r.InlayHintRefreshRequest.type),on:e=>this.connection.onRequest(r.InlayHintRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t)))),resolve:e=>this.connection.onRequest(r.InlayHintResolveRequest.type,((t,n)=>e(t,n)))}}}},6466:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlineCompletionFeature=void 0;const r=n(2542);t.InlineCompletionFeature=e=>class extends e{get inlineCompletion(){return{on:e=>this.connection.onRequest(r.InlineCompletionRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},9853:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InlineValueFeature=void 0;const r=n(2542);t.InlineValueFeature=e=>class extends e{get inlineValue(){return{refresh:()=>this.connection.sendRequest(r.InlineValueRefreshRequest.type),on:e=>this.connection.onRequest(r.InlineValueRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t))))}}}},1247:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkedEditingRangeFeature=void 0;const r=n(2542);t.LinkedEditingRangeFeature=e=>class extends e{onLinkedEditingRange(e){return this.connection.onRequest(r.LinkedEditingRangeRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0)))}}},3770:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonikerFeature=void 0;const r=n(2542);t.MonikerFeature=e=>class extends e{get moniker(){return{on:e=>{const t=r.MonikerRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},586:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotebookDocuments=t.NotebookSyncFeature=void 0;const r=n(2542),i=n(2096);t.NotebookSyncFeature=e=>class extends e{get synchronization(){return{onDidOpenNotebookDocument:e=>this.connection.onNotification(r.DidOpenNotebookDocumentNotification.type,(t=>{e(t)})),onDidChangeNotebookDocument:e=>this.connection.onNotification(r.DidChangeNotebookDocumentNotification.type,(t=>{e(t)})),onDidSaveNotebookDocument:e=>this.connection.onNotification(r.DidSaveNotebookDocumentNotification.type,(t=>{e(t)})),onDidCloseNotebookDocument:e=>this.connection.onNotification(r.DidCloseNotebookDocumentNotification.type,(t=>{e(t)}))}}};class o{onDidOpenTextDocument(e){return this.openHandler=e,r.Disposable.create((()=>{this.openHandler=void 0}))}openTextDocument(e){this.openHandler&&this.openHandler(e)}onDidChangeTextDocument(e){return this.changeHandler=e,r.Disposable.create((()=>{this.changeHandler=e}))}changeTextDocument(e){this.changeHandler&&this.changeHandler(e)}onDidCloseTextDocument(e){return this.closeHandler=e,r.Disposable.create((()=>{this.closeHandler=void 0}))}closeTextDocument(e){this.closeHandler&&this.closeHandler(e)}onWillSaveTextDocument(){return o.NULL_DISPOSE}onWillSaveTextDocumentWaitUntil(){return o.NULL_DISPOSE}onDidSaveTextDocument(){return o.NULL_DISPOSE}}o.NULL_DISPOSE=Object.freeze({dispose:()=>{}}),t.NotebookDocuments=class{constructor(e){e instanceof i.TextDocuments?this._cellTextDocuments=e:this._cellTextDocuments=new i.TextDocuments(e),this.notebookDocuments=new Map,this.notebookCellMap=new Map,this._onDidOpen=new r.Emitter,this._onDidChange=new r.Emitter,this._onDidSave=new r.Emitter,this._onDidClose=new r.Emitter}get cellTextDocuments(){return this._cellTextDocuments}getCellTextDocument(e){return this._cellTextDocuments.get(e.document)}getNotebookDocument(e){return this.notebookDocuments.get(e)}getNotebookCell(e){const t=this.notebookCellMap.get(e);return t&&t[0]}findNotebookDocumentForCell(e){const t="string"==typeof e?e:e.document,n=this.notebookCellMap.get(t);return n&&n[1]}get onDidOpen(){return this._onDidOpen.event}get onDidSave(){return this._onDidSave.event}get onDidChange(){return this._onDidChange.event}get onDidClose(){return this._onDidClose.event}listen(e){const t=new o,n=[];return n.push(this.cellTextDocuments.listen(t)),n.push(e.notebooks.synchronization.onDidOpenNotebookDocument((e=>{this.notebookDocuments.set(e.notebookDocument.uri,e.notebookDocument);for(const n of e.cellTextDocuments)t.openTextDocument({textDocument:n});this.updateCellMap(e.notebookDocument),this._onDidOpen.fire(e.notebookDocument)}))),n.push(e.notebooks.synchronization.onDidChangeNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0===n)return;n.version=e.notebookDocument.version;const r=n.metadata;let i=!1;const o=e.change;void 0!==o.metadata&&(i=!0,n.metadata=o.metadata);const s=[],a=[],c=[],u=[];if(void 0!==o.cells){const e=o.cells;if(void 0!==e.structure){const r=e.structure.array;if(n.cells.splice(r.start,r.deleteCount,...void 0!==r.cells?r.cells:[]),void 0!==e.structure.didOpen)for(const n of e.structure.didOpen)t.openTextDocument({textDocument:n}),s.push(n.uri);if(e.structure.didClose)for(const n of e.structure.didClose)t.closeTextDocument({textDocument:n}),a.push(n.uri)}if(void 0!==e.data){const t=new Map(e.data.map((e=>[e.document,e])));for(let e=0;e<=n.cells.length;e++){const r=t.get(n.cells[e].document);if(void 0!==r){const i=n.cells.splice(e,1,r);if(c.push({old:i[0],new:r}),t.delete(r.document),0===t.size)break}}}if(void 0!==e.textContent)for(const n of e.textContent)t.changeTextDocument({textDocument:n.document,contentChanges:n.changes}),u.push(n.document.uri)}this.updateCellMap(n);const l={notebookDocument:n};i&&(l.metadata={old:r,new:n.metadata});const d=[];for(const e of s)d.push(this.getNotebookCell(e));const f=[];for(const e of a)f.push(this.getNotebookCell(e));const p=[];for(const e of u)p.push(this.getNotebookCell(e));(d.length>0||f.length>0||c.length>0||p.length>0)&&(l.cells={added:d,removed:f,changed:{data:c,textContent:p}}),void 0===l.metadata&&void 0===l.cells||this._onDidChange.fire(l)}))),n.push(e.notebooks.synchronization.onDidSaveNotebookDocument((e=>{const t=this.notebookDocuments.get(e.notebookDocument.uri);void 0!==t&&this._onDidSave.fire(t)}))),n.push(e.notebooks.synchronization.onDidCloseNotebookDocument((e=>{const n=this.notebookDocuments.get(e.notebookDocument.uri);if(void 0!==n){this._onDidClose.fire(n);for(const n of e.cellTextDocuments)t.closeTextDocument({textDocument:n});this.notebookDocuments.delete(e.notebookDocument.uri);for(const e of n.cells)this.notebookCellMap.delete(e.document)}}))),r.Disposable.create((()=>{n.forEach((e=>e.dispose()))}))}updateCellMap(e){for(const t of e.cells)this.notebookCellMap.set(t.document,[t,e])}}},8240:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.attachPartialResult=t.ProgressFeature=t.attachWorkDone=void 0;const r=n(2542),i=n(9850);class o{constructor(e,t){this._connection=e,this._token=t,o.Instances.set(this._token,this)}begin(e,t,n,i){let o={kind:"begin",title:e,percentage:t,message:n,cancellable:i};this._connection.sendProgress(r.WorkDoneProgress.type,this._token,o)}report(e,t){let n={kind:"report"};"number"==typeof e?(n.percentage=e,void 0!==t&&(n.message=t)):n.message=e,this._connection.sendProgress(r.WorkDoneProgress.type,this._token,n)}done(){o.Instances.delete(this._token),this._connection.sendProgress(r.WorkDoneProgress.type,this._token,{kind:"end"})}}o.Instances=new Map;class s extends o{constructor(e,t){super(e,t),this._source=new r.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose(),super.done()}cancel(){this._source.cancel()}}class a{constructor(){}begin(){}report(){}done(){}}class c extends a{constructor(){super(),this._source=new r.CancellationTokenSource}get token(){return this._source.token}done(){this._source.dispose()}cancel(){this._source.cancel()}}var u;t.attachWorkDone=function(e,t){if(void 0===t||void 0===t.workDoneToken)return new a;const n=t.workDoneToken;return delete t.workDoneToken,new o(e,n)},t.ProgressFeature=e=>class extends e{constructor(){super(),this._progressSupported=!1}initialize(e){super.initialize(e),!0===e?.window?.workDoneProgress&&(this._progressSupported=!0,this.connection.onNotification(r.WorkDoneProgressCancelNotification.type,(e=>{let t=o.Instances.get(e.token);(t instanceof s||t instanceof c)&&t.cancel()})))}attachWorkDoneProgress(e){return void 0===e?new a:new o(this.connection,e)}createWorkDoneProgress(){if(this._progressSupported){const e=(0,i.generateUuid)();return this.connection.sendRequest(r.WorkDoneProgressCreateRequest.type,{token:e}).then((()=>new s(this.connection,e)))}return Promise.resolve(new c)}},function(e){e.type=new r.ProgressType}(u||(u={}));class l{constructor(e,t){this._connection=e,this._token=t}report(e){this._connection.sendProgress(u.type,this._token,e)}}t.attachPartialResult=function(e,t){if(void 0===t||void 0===t.partialResultToken)return;const n=t.partialResultToken;return delete t.partialResultToken,new l(e,n)}},2737:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SemanticTokensBuilder=t.SemanticTokensDiff=t.SemanticTokensFeature=void 0;const r=n(2542);t.SemanticTokensFeature=e=>class extends e{get semanticTokens(){return{refresh:()=>this.connection.sendRequest(r.SemanticTokensRefreshRequest.type),on:e=>{const t=r.SemanticTokensRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onDelta:e=>{const t=r.SemanticTokensDeltaRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onRange:e=>{const t=r.SemanticTokensRangeRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}};class i{constructor(e,t){this.originalSequence=e,this.modifiedSequence=t}computeDiff(){const e=this.originalSequence.length,t=this.modifiedSequence.length;let n=0;for(;n<t&&n<e&&this.originalSequence[n]===this.modifiedSequence[n];)n++;if(n<t&&n<e){let r=e-1,i=t-1;for(;r>=n&&i>=n&&this.originalSequence[r]===this.modifiedSequence[i];)r--,i--;(r<n||i<n)&&(r++,i++);const o=r-n+1,s=this.modifiedSequence.slice(n,i+1);return 1===s.length&&s[0]===this.originalSequence[r]?[{start:n,deleteCount:o-1}]:[{start:n,deleteCount:o,data:s}]}return n<t?[{start:n,deleteCount:0,data:this.modifiedSequence.slice(n)}]:n<e?[{start:n,deleteCount:e-n}]:[]}}t.SemanticTokensDiff=i,t.SemanticTokensBuilder=class{constructor(){this._prevData=void 0,this.initialize()}initialize(){this._id=Date.now(),this._prevLine=0,this._prevChar=0,this._data=[],this._dataLen=0}push(e,t,n,r,i){let o=e,s=t;this._dataLen>0&&(o-=this._prevLine,0===o&&(s-=this._prevChar)),this._data[this._dataLen++]=o,this._data[this._dataLen++]=s,this._data[this._dataLen++]=n,this._data[this._dataLen++]=r,this._data[this._dataLen++]=i,this._prevLine=e,this._prevChar=t}get id(){return this._id.toString()}previousResult(e){this.id===e&&(this._prevData=this._data),this.initialize()}build(){return this._prevData=void 0,{resultId:this.id,data:this._data}}canBuildEdits(){return void 0!==this._prevData}buildEdits(){return void 0!==this._prevData?{resultId:this.id,edits:new i(this._prevData,this._data).computeDiff()}:this.build()}}},2664:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConnection=t.combineFeatures=t.combineNotebooksFeatures=t.combineLanguagesFeatures=t.combineWorkspaceFeatures=t.combineWindowFeatures=t.combineClientFeatures=t.combineTracerFeatures=t.combineTelemetryFeatures=t.combineConsoleFeatures=t._NotebooksImpl=t._LanguagesImpl=t.BulkUnregistration=t.BulkRegistration=t.ErrorMessageTracker=void 0;const r=n(2542),i=n(1485),o=n(9850),s=n(8240),a=n(5501),c=n(9598),u=n(6744),l=n(2737),d=n(5719),f=n(4663),p=n(1247),h=n(1856),m=n(9853),y=n(2345),g=n(2877),v=n(5764),T=n(586),R=n(3770);function k(e){if(null!==e)return e}t.ErrorMessageTracker=class{constructor(){this._messages=Object.create(null)}add(e){let t=this._messages[e];t||(t=0),t++,this._messages[e]=t}sendErrors(e){Object.keys(this._messages).forEach((t=>{e.window.showErrorMessage(t)}))}};class b{constructor(){}rawAttach(e){this._rawConnection=e}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}fillServerCapabilities(e){}initialize(e){}error(e){this.send(r.MessageType.Error,e)}warn(e){this.send(r.MessageType.Warning,e)}info(e){this.send(r.MessageType.Info,e)}log(e){this.send(r.MessageType.Log,e)}debug(e){this.send(r.MessageType.Debug,e)}send(e,t){this._rawConnection&&this._rawConnection.sendNotification(r.LogMessageNotification.type,{type:e,message:t}).catch((()=>{(0,r.RAL)().console.error("Sending log message failed")}))}}const w=(0,d.ShowDocumentFeature)((0,s.ProgressFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}showErrorMessage(e,...t){let n={type:r.MessageType.Error,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(k)}showWarningMessage(e,...t){let n={type:r.MessageType.Warning,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(k)}showInformationMessage(e,...t){let n={type:r.MessageType.Info,message:e,actions:t};return this.connection.sendRequest(r.ShowMessageRequest.type,n).then(k)}}));var S,$;!function(e){e.create=function(){return new x}}(S||(t.BulkRegistration=S={}));class x{constructor(){this._registrations=[],this._registered=new Set}add(e,t){const n=i.string(e)?e:e.method;if(this._registered.has(n))throw new Error(`${n} is already added to this registration`);const r=o.generateUuid();this._registrations.push({id:r,method:n,registerOptions:t||{}}),this._registered.add(n)}asRegistrationParams(){return{registrations:this._registrations}}}!function(e){e.create=function(){return new C(void 0,[])}}($||(t.BulkUnregistration=$={}));class C{constructor(e,t){this._connection=e,this._unregistrations=new Map,t.forEach((e=>{this._unregistrations.set(e.method,e)}))}get isAttached(){return!!this._connection}attach(e){this._connection=e}add(e){this._unregistrations.set(e.method,e)}dispose(){let e=[];for(let t of this._unregistrations.values())e.push(t);let t={unregisterations:e};this._connection.sendRequest(r.UnregistrationRequest.type,t).catch((()=>{this._connection.console.info("Bulk unregistration failed.")}))}disposeSingle(e){const t=i.string(e)?e:e.method,n=this._unregistrations.get(t);if(!n)return!1;let o={unregisterations:[n]};return this._connection.sendRequest(r.UnregistrationRequest.type,o).then((()=>{this._unregistrations.delete(t)}),(e=>{this._connection.console.info(`Un-registering request handler for ${n.id} failed.`)})),!0}}class E{attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}register(e,t,n){return e instanceof x?this.registerMany(e):e instanceof C?this.registerSingle1(e,t,n):this.registerSingle2(e,t)}registerSingle1(e,t,n){const s=i.string(t)?t:t.method,a=o.generateUuid();let c={registrations:[{id:a,method:s,registerOptions:n||{}}]};return e.isAttached||e.attach(this.connection),this.connection.sendRequest(r.RegistrationRequest.type,c).then((t=>(e.add({id:a,method:s}),e)),(e=>(this.connection.console.info(`Registering request handler for ${s} failed.`),Promise.reject(e))))}registerSingle2(e,t){const n=i.string(e)?e:e.method,s=o.generateUuid();let a={registrations:[{id:s,method:n,registerOptions:t||{}}]};return this.connection.sendRequest(r.RegistrationRequest.type,a).then((e=>r.Disposable.create((()=>{this.unregisterSingle(s,n).catch((()=>{this.connection.console.info(`Un-registering capability with id ${s} failed.`)}))}))),(e=>(this.connection.console.info(`Registering request handler for ${n} failed.`),Promise.reject(e))))}unregisterSingle(e,t){let n={unregisterations:[{id:e,method:t}]};return this.connection.sendRequest(r.UnregistrationRequest.type,n).catch((()=>{this.connection.console.info(`Un-registering request handler for ${e} failed.`)}))}registerMany(e){let t=e.asRegistrationParams();return this.connection.sendRequest(r.RegistrationRequest.type,t).then((()=>new C(this._connection,t.registrations.map((e=>({id:e.id,method:e.method}))))),(e=>(this.connection.console.info("Bulk registration failed."),Promise.reject(e))))}}const A=(0,f.FileOperationsFeature)((0,c.WorkspaceFoldersFeature)((0,a.ConfigurationFeature)(class{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}applyEdit(e){let t=(n=e)&&n.edit?e:{edit:e};var n;return this.connection.sendRequest(r.ApplyWorkspaceEditRequest.type,t)}})));class N{constructor(){this._trace=r.Trace.Off}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}set trace(e){this._trace=e}log(e,t){this._trace!==r.Trace.Off&&this.connection.sendNotification(r.LogTraceNotification.type,{message:e,verbose:this._trace===r.Trace.Verbose?t:void 0}).catch((()=>{}))}}class D{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}logEvent(e){this.connection.sendNotification(r.TelemetryEventNotification.type,e).catch((()=>{this.connection.console.log("Sending TelemetryEventNotification failed")}))}}class _{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._LanguagesImpl=_;const I=(0,y.FoldingRangeFeature)((0,R.MonikerFeature)((0,v.DiagnosticFeature)((0,g.InlayHintFeature)((0,m.InlineValueFeature)((0,h.TypeHierarchyFeature)((0,p.LinkedEditingRangeFeature)((0,l.SemanticTokensFeature)((0,u.CallHierarchyFeature)(_)))))))));class P{constructor(){}attach(e){this._connection=e}get connection(){if(!this._connection)throw new Error("Remote is not attached to a connection yet.");return this._connection}initialize(e){}fillServerCapabilities(e){}attachWorkDoneProgress(e){return(0,s.attachWorkDone)(this.connection,e)}attachPartialResultProgress(e,t){return(0,s.attachPartialResult)(this.connection,t)}}t._NotebooksImpl=P;const O=(0,T.NotebookSyncFeature)(P);function L(e,t){return function(n){return t(e(n))}}function M(e,t){return function(n){return t(e(n))}}function F(e,t){return function(n){return t(e(n))}}function j(e,t){return function(n){return t(e(n))}}function q(e,t){return function(n){return t(e(n))}}function U(e,t){return function(n){return t(e(n))}}function K(e,t){return function(n){return t(e(n))}}function G(e,t){return function(n){return t(e(n))}}t.combineConsoleFeatures=L,t.combineTelemetryFeatures=M,t.combineTracerFeatures=F,t.combineClientFeatures=j,t.combineWindowFeatures=q,t.combineWorkspaceFeatures=U,t.combineLanguagesFeatures=K,t.combineNotebooksFeatures=G,t.combineFeatures=function(e,t){function n(e,t,n){return e&&t?n(e,t):e||t}return{__brand:"features",console:n(e.console,t.console,L),tracer:n(e.tracer,t.tracer,F),telemetry:n(e.telemetry,t.telemetry,M),client:n(e.client,t.client,j),window:n(e.window,t.window,q),workspace:n(e.workspace,t.workspace,U),languages:n(e.languages,t.languages,K),notebooks:n(e.notebooks,t.notebooks,G)}},t.createConnection=function(e,t,n){const o=n&&n.console?new(n.console(b)):new b,a=e(o);o.rawAttach(a);const c=n&&n.tracer?new(n.tracer(N)):new N,u=n&&n.telemetry?new(n.telemetry(D)):new D,l=n&&n.client?new(n.client(E)):new E,d=n&&n.window?new(n.window(w)):new w,f=n&&n.workspace?new(n.workspace(A)):new A,p=n&&n.languages?new(n.languages(I)):new I,h=n&&n.notebooks?new(n.notebooks(O)):new O,m=[o,c,u,l,d,f,p,h];let y,g,v,T={listen:()=>a.listen(),sendRequest:(e,...t)=>a.sendRequest(i.string(e)?e:e.method,...t),onRequest:(e,t)=>a.onRequest(e,t),sendNotification:(e,t)=>{const n=i.string(e)?e:e.method;return a.sendNotification(n,t)},onNotification:(e,t)=>a.onNotification(e,t),onProgress:a.onProgress,sendProgress:a.sendProgress,onInitialize:e=>(g=e,{dispose:()=>{g=void 0}}),onInitialized:e=>a.onNotification(r.InitializedNotification.type,e),onShutdown:e=>(y=e,{dispose:()=>{y=void 0}}),onExit:e=>(v=e,{dispose:()=>{v=void 0}}),get console(){return o},get telemetry(){return u},get tracer(){return c},get client(){return l},get window(){return d},get workspace(){return f},get languages(){return p},get notebooks(){return h},onDidChangeConfiguration:e=>a.onNotification(r.DidChangeConfigurationNotification.type,e),onDidChangeWatchedFiles:e=>a.onNotification(r.DidChangeWatchedFilesNotification.type,e),__textDocumentSync:void 0,onDidOpenTextDocument:e=>a.onNotification(r.DidOpenTextDocumentNotification.type,e),onDidChangeTextDocument:e=>a.onNotification(r.DidChangeTextDocumentNotification.type,e),onDidCloseTextDocument:e=>a.onNotification(r.DidCloseTextDocumentNotification.type,e),onWillSaveTextDocument:e=>a.onNotification(r.WillSaveTextDocumentNotification.type,e),onWillSaveTextDocumentWaitUntil:e=>a.onRequest(r.WillSaveTextDocumentWaitUntilRequest.type,e),onDidSaveTextDocument:e=>a.onNotification(r.DidSaveTextDocumentNotification.type,e),sendDiagnostics:e=>a.sendNotification(r.PublishDiagnosticsNotification.type,e),onHover:e=>a.onRequest(r.HoverRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onCompletion:e=>a.onRequest(r.CompletionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCompletionResolve:e=>a.onRequest(r.CompletionResolveRequest.type,e),onSignatureHelp:e=>a.onRequest(r.SignatureHelpRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDeclaration:e=>a.onRequest(r.DeclarationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDefinition:e=>a.onRequest(r.DefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onTypeDefinition:e=>a.onRequest(r.TypeDefinitionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onImplementation:e=>a.onRequest(r.ImplementationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onReferences:e=>a.onRequest(r.ReferencesRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentHighlight:e=>a.onRequest(r.DocumentHighlightRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentSymbol:e=>a.onRequest(r.DocumentSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbol:e=>a.onRequest(r.WorkspaceSymbolRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onWorkspaceSymbolResolve:e=>a.onRequest(r.WorkspaceSymbolResolveRequest.type,e),onCodeAction:e=>a.onRequest(r.CodeActionRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeActionResolve:e=>a.onRequest(r.CodeActionResolveRequest.type,((t,n)=>e(t,n))),onCodeLens:e=>a.onRequest(r.CodeLensRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onCodeLensResolve:e=>a.onRequest(r.CodeLensResolveRequest.type,((t,n)=>e(t,n))),onDocumentFormatting:e=>a.onRequest(r.DocumentFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentRangeFormatting:e=>a.onRequest(r.DocumentRangeFormattingRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onDocumentOnTypeFormatting:e=>a.onRequest(r.DocumentOnTypeFormattingRequest.type,((t,n)=>e(t,n))),onRenameRequest:e=>a.onRequest(r.RenameRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),onPrepareRename:e=>a.onRequest(r.PrepareRenameRequest.type,((t,n)=>e(t,n))),onDocumentLinks:e=>a.onRequest(r.DocumentLinkRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onDocumentLinkResolve:e=>a.onRequest(r.DocumentLinkResolveRequest.type,((t,n)=>e(t,n))),onDocumentColor:e=>a.onRequest(r.DocumentColorRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onColorPresentation:e=>a.onRequest(r.ColorPresentationRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onFoldingRanges:e=>a.onRequest(r.FoldingRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onSelectionRanges:e=>a.onRequest(r.SelectionRangeRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),(0,s.attachPartialResult)(a,t)))),onExecuteCommand:e=>a.onRequest(r.ExecuteCommandRequest.type,((t,n)=>e(t,n,(0,s.attachWorkDone)(a,t),void 0))),dispose:()=>a.dispose()};for(let e of m)e.attach(T);return a.onRequest(r.InitializeRequest.type,(e=>{t.initialize(e),i.string(e.trace)&&(c.trace=r.Trace.fromString(e.trace));for(let t of m)t.initialize(e.capabilities);if(g){let t=g(e,(new r.CancellationTokenSource).token,(0,s.attachWorkDone)(a,e),void 0);return(n=t,n instanceof Promise?n:i.thenable(n)?new Promise(((e,t)=>{n.then((t=>e(t)),(e=>t(e)))})):Promise.resolve(n)).then((e=>{if(e instanceof r.ResponseError)return e;let t=e;t||(t={capabilities:{}});let n=t.capabilities;n||(n={},t.capabilities=n),void 0===n.textDocumentSync||null===n.textDocumentSync?n.textDocumentSync=i.number(T.__textDocumentSync)?T.__textDocumentSync:r.TextDocumentSyncKind.None:i.number(n.textDocumentSync)||i.number(n.textDocumentSync.change)||(n.textDocumentSync.change=i.number(T.__textDocumentSync)?T.__textDocumentSync:r.TextDocumentSyncKind.None);for(let e of m)e.fillServerCapabilities(n);return t}))}{let e={capabilities:{textDocumentSync:r.TextDocumentSyncKind.None}};for(let t of m)t.fillServerCapabilities(e.capabilities);return e}var n})),a.onRequest(r.ShutdownRequest.type,(()=>(t.shutdownReceived=!0,y?y((new r.CancellationTokenSource).token):void 0))),a.onNotification(r.ExitNotification.type,(()=>{try{v&&v()}finally{t.shutdownReceived?t.exit(0):t.exit(1)}})),a.onNotification(r.SetTraceNotification.type,(e=>{c.trace=r.Trace.fromString(e.value)})),T}},5719:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShowDocumentFeature=void 0;const r=n(2542);t.ShowDocumentFeature=e=>class extends e{showDocument(e){return this.connection.sendRequest(r.ShowDocumentRequest.type,e)}}},2096:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocuments=void 0;const r=n(2542);t.TextDocuments=class{constructor(e){this._configuration=e,this._syncedDocuments=new Map,this._onDidChangeContent=new r.Emitter,this._onDidOpen=new r.Emitter,this._onDidClose=new r.Emitter,this._onDidSave=new r.Emitter,this._onWillSave=new r.Emitter}get onDidOpen(){return this._onDidOpen.event}get onDidChangeContent(){return this._onDidChangeContent.event}get onWillSave(){return this._onWillSave.event}onWillSaveWaitUntil(e){this._willSaveWaitUntil=e}get onDidSave(){return this._onDidSave.event}get onDidClose(){return this._onDidClose.event}get(e){return this._syncedDocuments.get(e)}all(){return Array.from(this._syncedDocuments.values())}keys(){return Array.from(this._syncedDocuments.keys())}listen(e){e.__textDocumentSync=r.TextDocumentSyncKind.Incremental;const t=[];return t.push(e.onDidOpenTextDocument((e=>{const t=e.textDocument,n=this._configuration.create(t.uri,t.languageId,t.version,t.text);this._syncedDocuments.set(t.uri,n);const r=Object.freeze({document:n});this._onDidOpen.fire(r),this._onDidChangeContent.fire(r)}))),t.push(e.onDidChangeTextDocument((e=>{const t=e.textDocument,n=e.contentChanges;if(0===n.length)return;const{version:r}=t;if(null==r)throw new Error(`Received document change event for ${t.uri} without valid version identifier`);let i=this._syncedDocuments.get(t.uri);void 0!==i&&(i=this._configuration.update(i,n,r),this._syncedDocuments.set(t.uri,i),this._onDidChangeContent.fire(Object.freeze({document:i})))}))),t.push(e.onDidCloseTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&(this._syncedDocuments.delete(e.textDocument.uri),this._onDidClose.fire(Object.freeze({document:t})))}))),t.push(e.onWillSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onWillSave.fire(Object.freeze({document:t,reason:e.reason}))}))),t.push(e.onWillSaveTextDocumentWaitUntil(((e,t)=>{let n=this._syncedDocuments.get(e.textDocument.uri);return void 0!==n&&this._willSaveWaitUntil?this._willSaveWaitUntil(Object.freeze({document:n,reason:e.reason}),t):[]}))),t.push(e.onDidSaveTextDocument((e=>{let t=this._syncedDocuments.get(e.textDocument.uri);void 0!==t&&this._onDidSave.fire(Object.freeze({document:t}))}))),r.Disposable.create((()=>{t.forEach((e=>e.dispose()))}))}}},1856:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchyFeature=void 0;const r=n(2542);t.TypeHierarchyFeature=e=>class extends e{get typeHierarchy(){return{onPrepare:e=>this.connection.onRequest(r.TypeHierarchyPrepareRequest.type,((t,n)=>e(t,n,this.attachWorkDoneProgress(t),void 0))),onSupertypes:e=>{const t=r.TypeHierarchySupertypesRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))},onSubtypes:e=>{const t=r.TypeHierarchySubtypesRequest.type;return this.connection.onRequest(t,((n,r)=>e(n,r,this.attachWorkDoneProgress(n),this.attachPartialResultProgress(t,n))))}}}}},1485:(e,t)=>{function n(e){return"string"==typeof e||e instanceof String}function r(e){return"function"==typeof e}function i(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.thenable=t.typedArray=t.stringArray=t.array=t.func=t.error=t.number=t.string=t.boolean=void 0,t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=r,t.array=i,t.stringArray=function(e){return i(e)&&e.every((e=>n(e)))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=function(e){return e&&r(e.then)}},9850:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUuid=t.parse=t.isUUID=t.v4=t.empty=void 0;class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class r extends n{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}}function i(){return new r}r._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],r._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=i;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function s(e){return o.test(e)}t.isUUID=s,t.parse=function(e){if(!s(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return i().asHex()}},9598:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceFoldersFeature=void 0;const r=n(2542);t.WorkspaceFoldersFeature=e=>class extends e{constructor(){super(),this._notificationIsAutoRegistered=!1}initialize(e){super.initialize(e);let t=e.workspace;t&&t.workspaceFolders&&(this._onDidChangeWorkspaceFolders=new r.Emitter,this.connection.onNotification(r.DidChangeWorkspaceFoldersNotification.type,(e=>{this._onDidChangeWorkspaceFolders.fire(e.event)})))}fillServerCapabilities(e){super.fillServerCapabilities(e);const t=e.workspace?.workspaceFolders?.changeNotifications;this._notificationIsAutoRegistered=!0===t||"string"==typeof t}getWorkspaceFolders(){return this.connection.sendRequest(r.WorkspaceFoldersRequest.type)}get onDidChangeWorkspaceFolders(){if(!this._onDidChangeWorkspaceFolders)throw new Error("Client doesn't support sending workspace folder change events.");return this._notificationIsAutoRegistered||this._unregistration||(this._unregistration=this.connection.client.register(r.DidChangeWorkspaceFoldersNotification.type)),this._onDidChangeWorkspaceFolders.event}}},3109:e=>{e.exports=child_process},5879:(e,t,n)=>{var r,i,o,s,a,c,u,l,d,f,p,h,m,y,g,v,T,R,k,b,w,S,$,x,C,E,A,N,D,_,I,P,O,L,M,F,j,q,U,K,G,H,W,B,z,V,Y,X,J,Q,Z,ee,te,ne,re,ie,oe,se,ae,ce,ue,le,de,fe,pe,he,me,ye,ge,ve,Te,Re,ke,be,we,Se,$e,xe;n.r(t),n.d(t,{AnnotatedTextEdit:()=>$,ChangeAnnotation:()=>w,ChangeAnnotationIdentifier:()=>S,CodeAction:()=>oe,CodeActionContext:()=>ie,CodeActionKind:()=>ne,CodeActionTriggerKind:()=>re,CodeDescription:()=>T,CodeLens:()=>se,Color:()=>d,ColorInformation:()=>f,ColorPresentation:()=>p,Command:()=>k,CompletionItem:()=>G,CompletionItemKind:()=>M,CompletionItemLabelDetails:()=>K,CompletionItemTag:()=>j,CompletionList:()=>H,CreateFile:()=>C,DeleteFile:()=>A,Diagnostic:()=>R,DiagnosticRelatedInformation:()=>y,DiagnosticSeverity:()=>g,DiagnosticTag:()=>v,DocumentHighlight:()=>X,DocumentHighlightKind:()=>Y,DocumentLink:()=>ce,DocumentSymbol:()=>te,DocumentUri:()=>r,EOL:()=>Ne,FoldingRange:()=>m,FoldingRangeKind:()=>h,FormattingOptions:()=>ae,Hover:()=>B,InlayHint:()=>Te,InlayHintKind:()=>ge,InlayHintLabelPart:()=>ve,InlineCompletionContext:()=>$e,InlineCompletionItem:()=>ke,InlineCompletionList:()=>be,InlineCompletionTriggerKind:()=>we,InlineValueContext:()=>ye,InlineValueEvaluatableExpression:()=>me,InlineValueText:()=>pe,InlineValueVariableLookup:()=>he,InsertReplaceEdit:()=>q,InsertTextFormat:()=>F,InsertTextMode:()=>U,Location:()=>u,LocationLink:()=>l,MarkedString:()=>W,MarkupContent:()=>L,MarkupKind:()=>O,OptionalVersionedTextDocumentIdentifier:()=>I,ParameterInformation:()=>z,Position:()=>a,Range:()=>c,RenameFile:()=>E,SelectedCompletionInfo:()=>Se,SelectionRange:()=>ue,SemanticTokenModifiers:()=>de,SemanticTokenTypes:()=>le,SemanticTokens:()=>fe,SignatureInformation:()=>V,StringValue:()=>Re,SymbolInformation:()=>Z,SymbolKind:()=>J,SymbolTag:()=>Q,TextDocument:()=>De,TextDocumentEdit:()=>x,TextDocumentIdentifier:()=>D,TextDocumentItem:()=>P,TextEdit:()=>b,URI:()=>i,VersionedTextDocumentIdentifier:()=>_,WorkspaceChange:()=>Ae,WorkspaceEdit:()=>N,WorkspaceFolder:()=>xe,WorkspaceSymbol:()=>ee,integer:()=>o,uinteger:()=>s}),function(e){e.is=function(e){return"string"==typeof e}}(r||(r={})),function(e){e.is=function(e){return"string"==typeof e}}(i||(i={})),function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(o||(o={})),function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647,e.is=function(t){return"number"==typeof t&&e.MIN_VALUE<=t&&t<=e.MAX_VALUE}}(s||(s={})),function(e){e.create=function(e,t){return e===Number.MAX_VALUE&&(e=s.MAX_VALUE),t===Number.MAX_VALUE&&(t=s.MAX_VALUE),{line:e,character:t}},e.is=function(e){let t=e;return _e.objectLiteral(t)&&_e.uinteger(t.line)&&_e.uinteger(t.character)}}(a||(a={})),function(e){e.create=function(e,t,n,r){if(_e.uinteger(e)&&_e.uinteger(t)&&_e.uinteger(n)&&_e.uinteger(r))return{start:a.create(e,t),end:a.create(n,r)};if(a.is(e)&&a.is(t))return{start:e,end:t};throw new Error(`Range#create called with invalid arguments[${e}, ${t}, ${n}, ${r}]`)},e.is=function(e){let t=e;return _e.objectLiteral(t)&&a.is(t.start)&&a.is(t.end)}}(c||(c={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){let t=e;return _e.objectLiteral(t)&&c.is(t.range)&&(_e.string(t.uri)||_e.undefined(t.uri))}}(u||(u={})),function(e){e.create=function(e,t,n,r){return{targetUri:e,targetRange:t,targetSelectionRange:n,originSelectionRange:r}},e.is=function(e){let t=e;return _e.objectLiteral(t)&&c.is(t.targetRange)&&_e.string(t.targetUri)&&c.is(t.targetSelectionRange)&&(c.is(t.originSelectionRange)||_e.undefined(t.originSelectionRange))}}(l||(l={})),function(e){e.create=function(e,t,n,r){return{red:e,green:t,blue:n,alpha:r}},e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.numberRange(t.red,0,1)&&_e.numberRange(t.green,0,1)&&_e.numberRange(t.blue,0,1)&&_e.numberRange(t.alpha,0,1)}}(d||(d={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){const t=e;return _e.objectLiteral(t)&&c.is(t.range)&&d.is(t.color)}}(f||(f={})),function(e){e.create=function(e,t,n){return{label:e,textEdit:t,additionalTextEdits:n}},e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.string(t.label)&&(_e.undefined(t.textEdit)||b.is(t))&&(_e.undefined(t.additionalTextEdits)||_e.typedArray(t.additionalTextEdits,b.is))}}(p||(p={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(h||(h={})),function(e){e.create=function(e,t,n,r,i,o){const s={startLine:e,endLine:t};return _e.defined(n)&&(s.startCharacter=n),_e.defined(r)&&(s.endCharacter=r),_e.defined(i)&&(s.kind=i),_e.defined(o)&&(s.collapsedText=o),s},e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.uinteger(t.startLine)&&_e.uinteger(t.startLine)&&(_e.undefined(t.startCharacter)||_e.uinteger(t.startCharacter))&&(_e.undefined(t.endCharacter)||_e.uinteger(t.endCharacter))&&(_e.undefined(t.kind)||_e.string(t.kind))}}(m||(m={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){let t=e;return _e.defined(t)&&u.is(t.location)&&_e.string(t.message)}}(y||(y={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(g||(g={})),function(e){e.Unnecessary=1,e.Deprecated=2}(v||(v={})),function(e){e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.string(t.href)}}(T||(T={})),function(e){e.create=function(e,t,n,r,i,o){let s={range:e,message:t};return _e.defined(n)&&(s.severity=n),_e.defined(r)&&(s.code=r),_e.defined(i)&&(s.source=i),_e.defined(o)&&(s.relatedInformation=o),s},e.is=function(e){var t;let n=e;return _e.defined(n)&&c.is(n.range)&&_e.string(n.message)&&(_e.number(n.severity)||_e.undefined(n.severity))&&(_e.integer(n.code)||_e.string(n.code)||_e.undefined(n.code))&&(_e.undefined(n.codeDescription)||_e.string(null===(t=n.codeDescription)||void 0===t?void 0:t.href))&&(_e.string(n.source)||_e.undefined(n.source))&&(_e.undefined(n.relatedInformation)||_e.typedArray(n.relatedInformation,y.is))}}(R||(R={})),function(e){e.create=function(e,t,...n){let r={title:e,command:t};return _e.defined(n)&&n.length>0&&(r.arguments=n),r},e.is=function(e){let t=e;return _e.defined(t)&&_e.string(t.title)&&_e.string(t.command)}}(k||(k={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.string(t.newText)&&c.is(t.range)}}(b||(b={})),function(e){e.create=function(e,t,n){const r={label:e};return void 0!==t&&(r.needsConfirmation=t),void 0!==n&&(r.description=n),r},e.is=function(e){const t=e;return _e.objectLiteral(t)&&_e.string(t.label)&&(_e.boolean(t.needsConfirmation)||void 0===t.needsConfirmation)&&(_e.string(t.description)||void 0===t.description)}}(w||(w={})),function(e){e.is=function(e){const t=e;return _e.string(t)}}(S||(S={})),function(e){e.replace=function(e,t,n){return{range:e,newText:t,annotationId:n}},e.insert=function(e,t,n){return{range:{start:e,end:e},newText:t,annotationId:n}},e.del=function(e,t){return{range:e,newText:"",annotationId:t}},e.is=function(e){const t=e;return b.is(t)&&(w.is(t.annotationId)||S.is(t.annotationId))}}($||($={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){let t=e;return _e.defined(t)&&I.is(t.textDocument)&&Array.isArray(t.edits)}}(x||(x={})),function(e){e.create=function(e,t,n){let r={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){let t=e;return t&&"create"===t.kind&&_e.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||_e.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||_e.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(C||(C={})),function(e){e.create=function(e,t,n,r){let i={kind:"rename",oldUri:e,newUri:t};return void 0===n||void 0===n.overwrite&&void 0===n.ignoreIfExists||(i.options=n),void 0!==r&&(i.annotationId=r),i},e.is=function(e){let t=e;return t&&"rename"===t.kind&&_e.string(t.oldUri)&&_e.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||_e.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||_e.boolean(t.options.ignoreIfExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(E||(E={})),function(e){e.create=function(e,t,n){let r={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(r.options=t),void 0!==n&&(r.annotationId=n),r},e.is=function(e){let t=e;return t&&"delete"===t.kind&&_e.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||_e.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||_e.boolean(t.options.ignoreIfNotExists)))&&(void 0===t.annotationId||S.is(t.annotationId))}}(A||(A={})),function(e){e.is=function(e){let t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((e=>_e.string(e.kind)?C.is(e)||E.is(e)||A.is(e):x.is(e))))}}(N||(N={}));class Ce{constructor(e,t){this.edits=e,this.changeAnnotations=t}insert(e,t,n){let r,i;if(void 0===n?r=b.insert(e,t):S.is(n)?(i=n,r=$.insert(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=$.insert(e,t,i)),this.edits.push(r),void 0!==i)return i}replace(e,t,n){let r,i;if(void 0===n?r=b.replace(e,t):S.is(n)?(i=n,r=$.replace(e,t,n)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(n),r=$.replace(e,t,i)),this.edits.push(r),void 0!==i)return i}delete(e,t){let n,r;if(void 0===t?n=b.del(e):S.is(t)?(r=t,n=$.del(e,t)):(this.assertChangeAnnotations(this.changeAnnotations),r=this.changeAnnotations.manage(t),n=$.del(e,r)),this.edits.push(n),void 0!==r)return r}add(e){this.edits.push(e)}all(){return this.edits}clear(){this.edits.splice(0,this.edits.length)}assertChangeAnnotations(e){if(void 0===e)throw new Error("Text edit change is not configured to manage change annotations.")}}class Ee{constructor(e){this._annotations=void 0===e?Object.create(null):e,this._counter=0,this._size=0}all(){return this._annotations}get size(){return this._size}manage(e,t){let n;if(S.is(e)?n=e:(n=this.nextId(),t=e),void 0!==this._annotations[n])throw new Error(`Id ${n} is already in use.`);if(void 0===t)throw new Error(`No annotation provided for id ${n}`);return this._annotations[n]=t,this._size++,n}nextId(){return this._counter++,this._counter.toString()}}class Ae{constructor(e){this._textEditChanges=Object.create(null),void 0!==e?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new Ee(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach((e=>{if(x.is(e)){const t=new Ce(e.edits,this._changeAnnotations);this._textEditChanges[e.textDocument.uri]=t}}))):e.changes&&Object.keys(e.changes).forEach((t=>{const n=new Ce(e.changes[t]);this._textEditChanges[t]=n}))):this._workspaceEdit={}}get edit(){return this.initDocumentChanges(),void 0!==this._changeAnnotations&&(0===this._changeAnnotations.size?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit}getTextEditChange(e){if(I.is(e)){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");const t={uri:e.uri,version:e.version};let n=this._textEditChanges[t.uri];if(!n){const e=[],r={textDocument:t,edits:e};this._workspaceEdit.documentChanges.push(r),n=new Ce(e,this._changeAnnotations),this._textEditChanges[t.uri]=n}return n}{if(this.initChanges(),void 0===this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");let t=this._textEditChanges[e];if(!t){let n=[];this._workspaceEdit.changes[e]=n,t=new Ce(n),this._textEditChanges[e]=t}return t}}initDocumentChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._changeAnnotations=new Ee,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())}initChanges(){void 0===this._workspaceEdit.documentChanges&&void 0===this._workspaceEdit.changes&&(this._workspaceEdit.changes=Object.create(null))}createFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let r,i,o;if(w.is(t)||S.is(t)?r=t:n=t,void 0===r?i=C.create(e,n):(o=S.is(r)?r:this._changeAnnotations.manage(r),i=C.create(e,n,o)),this._workspaceEdit.documentChanges.push(i),void 0!==o)return o}renameFile(e,t,n,r){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let i,o,s;if(w.is(n)||S.is(n)?i=n:r=n,void 0===i?o=E.create(e,t,r):(s=S.is(i)?i:this._changeAnnotations.manage(i),o=E.create(e,t,r,s)),this._workspaceEdit.documentChanges.push(o),void 0!==s)return s}deleteFile(e,t,n){if(this.initDocumentChanges(),void 0===this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");let r,i,o;if(w.is(t)||S.is(t)?r=t:n=t,void 0===r?i=A.create(e,n):(o=S.is(r)?r:this._changeAnnotations.manage(r),i=A.create(e,n,o)),this._workspaceEdit.documentChanges.push(i),void 0!==o)return o}}!function(e){e.create=function(e){return{uri:e}},e.is=function(e){let t=e;return _e.defined(t)&&_e.string(t.uri)}}(D||(D={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return _e.defined(t)&&_e.string(t.uri)&&_e.integer(t.version)}}(_||(_={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){let t=e;return _e.defined(t)&&_e.string(t.uri)&&(null===t.version||_e.integer(t.version))}}(I||(I={})),function(e){e.create=function(e,t,n,r){return{uri:e,languageId:t,version:n,text:r}},e.is=function(e){let t=e;return _e.defined(t)&&_e.string(t.uri)&&_e.string(t.languageId)&&_e.integer(t.version)&&_e.string(t.text)}}(P||(P={})),function(e){e.PlainText="plaintext",e.Markdown="markdown",e.is=function(t){const n=t;return n===e.PlainText||n===e.Markdown}}(O||(O={})),function(e){e.is=function(e){const t=e;return _e.objectLiteral(e)&&O.is(t.kind)&&_e.string(t.value)}}(L||(L={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(M||(M={})),function(e){e.PlainText=1,e.Snippet=2}(F||(F={})),function(e){e.Deprecated=1}(j||(j={})),function(e){e.create=function(e,t,n){return{newText:e,insert:t,replace:n}},e.is=function(e){const t=e;return t&&_e.string(t.newText)&&c.is(t.insert)&&c.is(t.replace)}}(q||(q={})),function(e){e.asIs=1,e.adjustIndentation=2}(U||(U={})),function(e){e.is=function(e){const t=e;return t&&(_e.string(t.detail)||void 0===t.detail)&&(_e.string(t.description)||void 0===t.description)}}(K||(K={})),function(e){e.create=function(e){return{label:e}}}(G||(G={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(H||(H={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){const t=e;return _e.string(t)||_e.objectLiteral(t)&&_e.string(t.language)&&_e.string(t.value)}}(W||(W={})),function(e){e.is=function(e){let t=e;return!!t&&_e.objectLiteral(t)&&(L.is(t.contents)||W.is(t.contents)||_e.typedArray(t.contents,W.is))&&(void 0===e.range||c.is(e.range))}}(B||(B={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(z||(z={})),function(e){e.create=function(e,t,...n){let r={label:e};return _e.defined(t)&&(r.documentation=t),_e.defined(n)?r.parameters=n:r.parameters=[],r}}(V||(V={})),function(e){e.Text=1,e.Read=2,e.Write=3}(Y||(Y={})),function(e){e.create=function(e,t){let n={range:e};return _e.number(t)&&(n.kind=t),n}}(X||(X={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(J||(J={})),function(e){e.Deprecated=1}(Q||(Q={})),function(e){e.create=function(e,t,n,r,i){let o={name:e,kind:t,location:{uri:r,range:n}};return i&&(o.containerName=i),o}}(Z||(Z={})),function(e){e.create=function(e,t,n,r){return void 0!==r?{name:e,kind:t,location:{uri:n,range:r}}:{name:e,kind:t,location:{uri:n}}}}(ee||(ee={})),function(e){e.create=function(e,t,n,r,i,o){let s={name:e,detail:t,kind:n,range:r,selectionRange:i};return void 0!==o&&(s.children=o),s},e.is=function(e){let t=e;return t&&_e.string(t.name)&&_e.number(t.kind)&&c.is(t.range)&&c.is(t.selectionRange)&&(void 0===t.detail||_e.string(t.detail))&&(void 0===t.deprecated||_e.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))&&(void 0===t.tags||Array.isArray(t.tags))}}(te||(te={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(ne||(ne={})),function(e){e.Invoked=1,e.Automatic=2}(re||(re={})),function(e){e.create=function(e,t,n){let r={diagnostics:e};return null!=t&&(r.only=t),null!=n&&(r.triggerKind=n),r},e.is=function(e){let t=e;return _e.defined(t)&&_e.typedArray(t.diagnostics,R.is)&&(void 0===t.only||_e.typedArray(t.only,_e.string))&&(void 0===t.triggerKind||t.triggerKind===re.Invoked||t.triggerKind===re.Automatic)}}(ie||(ie={})),function(e){e.create=function(e,t,n){let r={title:e},i=!0;return"string"==typeof t?(i=!1,r.kind=t):k.is(t)?r.command=t:r.edit=t,i&&void 0!==n&&(r.kind=n),r},e.is=function(e){let t=e;return t&&_e.string(t.title)&&(void 0===t.diagnostics||_e.typedArray(t.diagnostics,R.is))&&(void 0===t.kind||_e.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||k.is(t.command))&&(void 0===t.isPreferred||_e.boolean(t.isPreferred))&&(void 0===t.edit||N.is(t.edit))}}(oe||(oe={})),function(e){e.create=function(e,t){let n={range:e};return _e.defined(t)&&(n.data=t),n},e.is=function(e){let t=e;return _e.defined(t)&&c.is(t.range)&&(_e.undefined(t.command)||k.is(t.command))}}(se||(se={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){let t=e;return _e.defined(t)&&_e.uinteger(t.tabSize)&&_e.boolean(t.insertSpaces)}}(ae||(ae={})),function(e){e.create=function(e,t,n){return{range:e,target:t,data:n}},e.is=function(e){let t=e;return _e.defined(t)&&c.is(t.range)&&(_e.undefined(t.target)||_e.string(t.target))}}(ce||(ce={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){let n=t;return _e.objectLiteral(n)&&c.is(n.range)&&(void 0===n.parent||e.is(n.parent))}}(ue||(ue={})),function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"}(le||(le={})),function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"}(de||(de={})),function(e){e.is=function(e){const t=e;return _e.objectLiteral(t)&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(fe||(fe={})),function(e){e.create=function(e,t){return{range:e,text:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&_e.string(t.text)}}(pe||(pe={})),function(e){e.create=function(e,t,n){return{range:e,variableName:t,caseSensitiveLookup:n}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&_e.boolean(t.caseSensitiveLookup)&&(_e.string(t.variableName)||void 0===t.variableName)}}(he||(he={})),function(e){e.create=function(e,t){return{range:e,expression:t}},e.is=function(e){const t=e;return null!=t&&c.is(t.range)&&(_e.string(t.expression)||void 0===t.expression)}}(me||(me={})),function(e){e.create=function(e,t){return{frameId:e,stoppedLocation:t}},e.is=function(e){const t=e;return _e.defined(t)&&c.is(e.stoppedLocation)}}(ye||(ye={})),function(e){e.Type=1,e.Parameter=2,e.is=function(e){return 1===e||2===e}}(ge||(ge={})),function(e){e.create=function(e){return{value:e}},e.is=function(e){const t=e;return _e.objectLiteral(t)&&(void 0===t.tooltip||_e.string(t.tooltip)||L.is(t.tooltip))&&(void 0===t.location||u.is(t.location))&&(void 0===t.command||k.is(t.command))}}(ve||(ve={})),function(e){e.create=function(e,t,n){const r={position:e,label:t};return void 0!==n&&(r.kind=n),r},e.is=function(e){const t=e;return _e.objectLiteral(t)&&a.is(t.position)&&(_e.string(t.label)||_e.typedArray(t.label,ve.is))&&(void 0===t.kind||ge.is(t.kind))&&void 0===t.textEdits||_e.typedArray(t.textEdits,b.is)&&(void 0===t.tooltip||_e.string(t.tooltip)||L.is(t.tooltip))&&(void 0===t.paddingLeft||_e.boolean(t.paddingLeft))&&(void 0===t.paddingRight||_e.boolean(t.paddingRight))}}(Te||(Te={})),function(e){e.createSnippet=function(e){return{kind:"snippet",value:e}}}(Re||(Re={})),function(e){e.create=function(e,t,n,r){return{insertText:e,filterText:t,range:n,command:r}}}(ke||(ke={})),function(e){e.create=function(e){return{items:e}}}(be||(be={})),function(e){e.Invoked=0,e.Automatic=1}(we||(we={})),function(e){e.create=function(e,t){return{range:e,text:t}}}(Se||(Se={})),function(e){e.create=function(e,t){return{triggerKind:e,selectedCompletionInfo:t}}}($e||($e={})),function(e){e.is=function(e){const t=e;return _e.objectLiteral(t)&&i.is(t.uri)&&_e.string(t.name)}}(xe||(xe={}));const Ne=["\n","\r\n","\r"];var De,_e;!function(e){function t(e,n){if(e.length<=1)return e;const r=e.length/2|0,i=e.slice(0,r),o=e.slice(r);t(i,n),t(o,n);let s=0,a=0,c=0;for(;s<i.length&&a<o.length;){let t=n(i[s],o[a]);e[c++]=t<=0?i[s++]:o[a++]}for(;s<i.length;)e[c++]=i[s++];for(;a<o.length;)e[c++]=o[a++];return e}e.create=function(e,t,n,r){return new Ie(e,t,n,r)},e.is=function(e){let t=e;return!!(_e.defined(t)&&_e.string(t.uri)&&(_e.undefined(t.languageId)||_e.string(t.languageId))&&_e.uinteger(t.lineCount)&&_e.func(t.getText)&&_e.func(t.positionAt)&&_e.func(t.offsetAt))},e.applyEdits=function(e,n){let r=e.getText(),i=t(n,((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),o=r.length;for(let t=i.length-1;t>=0;t--){let n=i[t],s=e.offsetAt(n.range.start),a=e.offsetAt(n.range.end);if(!(a<=o))throw new Error("Overlapping edit");r=r.substring(0,s)+n.newText+r.substring(a,r.length),o=s}return r}}(De||(De={}));class Ie{constructor(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0}getLineOffsets(){if(void 0===this._lineOffsets){let e=[],t=this._content,n=!0;for(let r=0;r<t.length;r++){n&&(e.push(r),n=!1);let i=t.charAt(r);n="\r"===i||"\n"===i,"\r"===i&&r+1<t.length&&"\n"===t.charAt(r+1)&&r++}n&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return a.create(0,e);for(;n<r;){let i=Math.floor((n+r)/2);t[i]>e?r=i:n=i+1}let i=n-1;return a.create(i,e-t[i])}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)}get lineCount(){return this.getLineOffsets().length}}!function(e){const t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.numberRange=function(e,n,r){return"[object Number]"===t.call(e)&&n<=e&&e<=r},e.integer=function(e){return"[object Number]"===t.call(e)&&-2147483648<=e&&e<=2147483647},e.uinteger=function(e){return"[object Number]"===t.call(e)&&0<=e&&e<=2147483647},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(_e||(_e={}))},4347:(e,t,n)=>{var r,i=n(8729);class o{constructor(e,t,n,r){this._uri=e,this._languageId=t,this._version=n,this._content=r,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){const t=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(t,n)}return this._content}update(e,t){for(let t of e)if(o.isIncremental(t)){const e=c(t.range),n=this.offsetAt(e.start),r=this.offsetAt(e.end);this._content=this._content.substring(0,n)+t.text+this._content.substring(r,this._content.length);const i=Math.max(e.start.line,0),o=Math.max(e.end.line,0);let s=this._lineOffsets;const u=a(t.text,!1,n);if(o-i===u.length)for(let e=0,t=u.length;e<t;e++)s[e+i+1]=u[e];else u.length<1e4?s.splice(i+1,o-i,...u):this._lineOffsets=s=s.slice(0,i+1).concat(u,s.slice(o+1));const l=t.text.length-(r-n);if(0!==l)for(let e=i+1+u.length,t=s.length;e<t;e++)s[e]=s[e]+l}else{if(!o.isFull(t))throw new Error("Unknown change event received");this._content=t.text,this._lineOffsets=void 0}this._version=t}getLineOffsets(){return void 0===this._lineOffsets&&(this._lineOffsets=a(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let t=this.getLineOffsets(),n=0,r=t.length;if(0===r)return{line:0,character:e};for(;n<r;){let i=Math.floor((n+r)/2);t[i]>e?r=i:n=i+1}let i=n-1;return{line:i,character:e-t[i]}}offsetAt(e){let t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;let n=t[e.line],r=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,r),n)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0!==t.range&&(void 0===t.rangeLength||"number"==typeof t.rangeLength)}static isFull(e){let t=e;return null!=t&&"string"==typeof t.text&&void 0===t.range&&void 0===t.rangeLength}}function s(e,t){if(e.length<=1)return e;const n=e.length/2|0,r=e.slice(0,n),i=e.slice(n);s(r,t),s(i,t);let o=0,a=0,c=0;for(;o<r.length&&a<i.length;){let n=t(r[o],i[a]);e[c++]=n<=0?r[o++]:i[a++]}for(;o<r.length;)e[c++]=r[o++];for(;a<i.length;)e[c++]=i[a++];return e}function a(e,t,n=0){const r=t?[n]:[];for(let t=0;t<e.length;t++){let i=e.charCodeAt(t);13!==i&&10!==i||(13===i&&t+1<e.length&&10===e.charCodeAt(t+1)&&t++,r.push(n+t+1))}return r}function c(e){const t=e.start,n=e.end;return t.line>n.line||t.line===n.line&&t.character>n.character?{start:n,end:t}:e}function u(e){const t=c(e.range);return t!==e.range?{newText:e.newText,range:t}:e}function l(e){return"object"==typeof e&&null!==e&&"string"==typeof e.$type}function d(e){return"object"==typeof e&&null!==e&&"string"==typeof e.$refText}function f(e){return"object"==typeof e&&null!==e&&l(e.container)&&d(e.reference)&&"string"==typeof e.message}!function(e){e.create=function(e,t,n,r){return new o(e,t,n,r)},e.update=function(e,t,n){if(e instanceof o)return e.update(t,n),e;throw new Error("TextDocument.update: document must be created by TextDocument.create")},e.applyEdits=function(e,t){let n=e.getText(),r=s(t.map(u),((e,t)=>{let n=e.range.start.line-t.range.start.line;return 0===n?e.range.start.character-t.range.start.character:n})),i=0;const o=[];for(const t of r){let r=e.offsetAt(t.range.start);if(r<i)throw new Error("Overlapping edit");r>i&&o.push(n.substring(i,r)),t.newText.length&&o.push(t.newText),i=e.offsetAt(t.range.end)}return o.push(n.substr(i)),o.join("")}}(r||(r={}));class p{constructor(){this.subtypes={},this.allSubtypes={}}isInstance(e,t){return l(e)&&this.isSubtype(e.$type,t)}isSubtype(e,t){if(e===t)return!0;let n=this.subtypes[e];n||(n=this.subtypes[e]={});const r=n[t];if(void 0!==r)return r;{const r=this.computeIsSubtype(e,t);return n[t]=r,r}}getAllSubTypes(e){const t=this.allSubtypes[e];if(t)return t;{const t=this.getAllTypes(),n=[];for(const r of t)this.isSubtype(r,e)&&n.push(r);return this.allSubtypes[e]=n,n}}}function h(e){return"object"==typeof e&&null!==e&&Array.isArray(e.content)}function m(e){return"object"==typeof e&&null!==e&&"object"==typeof e.tokenType}class y{constructor(e,t){this.startFn=e,this.nextFn=t}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),[Symbol.iterator]:()=>e};return e}[Symbol.iterator](){return this.iterator()}isEmpty(){const e=this.iterator();return Boolean(e.next().done)}count(){const e=this.iterator();let t=0,n=e.next();for(;!n.done;)t++,n=e.next();return t}toArray(){const e=[],t=this.iterator();let n;do{n=t.next(),void 0!==n.value&&e.push(n.value)}while(!n.done);return e}toSet(){return new Set(this)}toMap(e,t){const n=this.map((n=>[e?e(n):n,t?t(n):n]));return new Map(n)}toString(){return this.join()}concat(e){const t=e[Symbol.iterator]();return new y((()=>({first:this.startFn(),firstDone:!1})),(e=>{let n;if(!e.firstDone){do{if(n=this.nextFn(e.first),!n.done)return n}while(!n.done);e.firstDone=!0}do{if(n=t.next(),!n.done)return n}while(!n.done);return T}))}join(e=","){const t=this.iterator();let n,r="",i=!1;do{n=t.next(),n.done||(i&&(r+=e),r+="string"==typeof(o=n.value)?o:void 0===o?"undefined":"function"==typeof o.toString?o.toString():Object.prototype.toString.call(o)),i=!0}while(!n.done);var o;return r}indexOf(e,t=0){const n=this.iterator();let r=0,i=n.next();for(;!i.done;){if(r>=t&&i.value===e)return r;i=n.next(),r++}return-1}every(e){const t=this.iterator();let n=t.next();for(;!n.done;){if(!e(n.value))return!1;n=t.next()}return!0}some(e){const t=this.iterator();let n=t.next();for(;!n.done;){if(e(n.value))return!0;n=t.next()}return!1}forEach(e){const t=this.iterator();let n=0,r=t.next();for(;!r.done;)e(r.value,n),r=t.next(),n++}map(e){return new y(this.startFn,(t=>{const{done:n,value:r}=this.nextFn(t);return n?T:{done:!1,value:e(r)}}))}filter(e){return new y(this.startFn,(t=>{let n;do{if(n=this.nextFn(t),!n.done&&e(n.value))return n}while(!n.done);return T}))}nonNullable(){return this.filter((e=>null!=e))}reduce(e,t){const n=this.iterator();let r=t,i=n.next();for(;!i.done;)r=void 0===r?i.value:e(r,i.value),i=n.next();return r}reduceRight(e,t){return this.recursiveReduce(this.iterator(),e,t)}recursiveReduce(e,t,n){const r=e.next();if(r.done)return n;const i=this.recursiveReduce(e,t,n);return void 0===i?r.value:t(i,r.value)}find(e){const t=this.iterator();let n=t.next();for(;!n.done;){if(e(n.value))return n.value;n=t.next()}}findIndex(e){const t=this.iterator();let n=0,r=t.next();for(;!r.done;){if(e(r.value))return n;r=t.next(),n++}return-1}includes(e){const t=this.iterator();let n=t.next();for(;!n.done;){if(n.value===e)return!0;n=t.next()}return!1}flatMap(e){return new y((()=>({this:this.startFn()})),(t=>{do{if(t.iterator){const e=t.iterator.next();if(!e.done)return e;t.iterator=void 0}const{done:n,value:r}=this.nextFn(t.this);if(!n){const n=e(r);if(!g(n))return{done:!1,value:n};t.iterator=n[Symbol.iterator]()}}while(t.iterator);return T}))}flat(e){if(void 0===e&&(e=1),e<=0)return this;const t=e>1?this.flat(e-1):this;return new y((()=>({this:t.startFn()})),(e=>{do{if(e.iterator){const t=e.iterator.next();if(!t.done)return t;e.iterator=void 0}const{done:n,value:r}=t.nextFn(e.this);if(!n){if(!g(r))return{done:!1,value:r};e.iterator=r[Symbol.iterator]()}}while(e.iterator);return T}))}head(){const e=this.iterator().next();if(!e.done)return e.value}tail(e=1){return new y((()=>{const t=this.startFn();for(let n=0;n<e;n++)if(this.nextFn(t).done)return t;return t}),this.nextFn)}limit(e){return new y((()=>({size:0,state:this.startFn()})),(t=>(t.size++,t.size>e?T:this.nextFn(t.state))))}distinct(e){const t=new Set;return this.filter((n=>{const r=e?e(n):n;return!t.has(r)&&(t.add(r),!0)}))}exclude(e,t){const n=new Set;for(const r of e){const e=t?t(r):r;n.add(e)}return this.filter((e=>{const r=t?t(e):e;return!n.has(r)}))}}function g(e){return!!e&&"function"==typeof e[Symbol.iterator]}const v=new y((()=>{}),(()=>T)),T=Object.freeze({done:!0,value:void 0});function R(...e){if(1===e.length){const t=e[0];if(t instanceof y)return t;if(g(t))return new y((()=>t[Symbol.iterator]()),(e=>e.next()));if("number"==typeof t.length)return new y((()=>({index:0})),(e=>e.index<t.length?{done:!1,value:t[e.index++]}:T))}return e.length>1?new y((()=>({collIndex:0,arrIndex:0})),(t=>{do{if(t.iterator){const e=t.iterator.next();if(!e.done)return e;t.iterator=void 0}if(t.array){if(t.arrIndex<t.array.length)return{done:!1,value:t.array[t.arrIndex++]};t.array=void 0,t.arrIndex=0}if(t.collIndex<e.length){const n=e[t.collIndex++];g(n)?t.iterator=n[Symbol.iterator]():n&&"number"==typeof n.length&&(t.array=n)}}while(t.iterator||t.array||t.collIndex<e.length);return T})):v}class k extends y{constructor(e,t,n){super((()=>({iterators:(null==n?void 0:n.includeRoot)?[[e][Symbol.iterator]()]:[t(e)[Symbol.iterator]()],pruned:!1})),(e=>{for(e.pruned&&(e.iterators.pop(),e.pruned=!1);e.iterators.length>0;){const n=e.iterators[e.iterators.length-1].next();if(!n.done)return e.iterators.push(t(n.value)[Symbol.iterator]()),n;e.iterators.pop()}return T}))}iterator(){const e={state:this.startFn(),next:()=>this.nextFn(e.state),prune:()=>{e.state.pruned=!0},[Symbol.iterator]:()=>e};return e}}var b,w;function S(e){return new k(e,(e=>h(e)?e.content:[]),{includeRoot:!0})}function $(e){return{start:{character:e.startColumn-1,line:e.startLine-1},end:{character:e.endColumn,line:e.endLine-1}}}function x(e){if(!e)return;const{offset:t,end:n,range:r}=e;return{range:r,offset:t,end:n,length:n-t}}function C(e,t){const n=function(e,t){if(e.end.line<t.start.line||e.end.line===t.start.line&&e.end.character<e.start.character)return w.Before;if(e.start.line>t.end.line||e.start.line===t.end.line&&e.start.character>t.end.character)return w.After;const n=e.start.line>t.start.line||e.start.line===t.start.line&&e.start.character>=t.start.character,r=e.end.line<t.end.line||e.end.line===t.end.line&&e.end.character<=t.end.character;return n&&r?w.Inside:n?w.OverlapBack:w.OverlapFront}(e,t);return n>w.After}!function(e){e.sum=function(e){return e.reduce(((e,t)=>e+t),0)},e.product=function(e){return e.reduce(((e,t)=>e*t),0)},e.min=function(e){return e.reduce(((e,t)=>Math.min(e,t)))},e.max=function(e){return e.reduce(((e,t)=>Math.max(e,t)))}}(b||(b={})),function(e){e[e.Before=0]="Before",e[e.After=1]="After",e[e.OverlapFront=2]="OverlapFront",e[e.OverlapBack=3]="OverlapBack",e[e.Inside=4]="Inside"}(w||(w={}));const E=/^[\w\p{L}]$/u;function A(e,t,n=E){if(e){if(t>0){const r=t-e.offset,i=e.text.charAt(r);n.test(i)||t--}return D(e,t)}}function N(e,t){return m(e)&&t.includes(e.tokenType.name)}function D(e,t){if(m(e))return e;if(h(e)){const n=I(e,t,!1);if(n)return D(n,t)}}function _(e,t){if(m(e))return e;if(h(e)){const n=I(e,t,!0);if(n)return _(n,t)}}function I(e,t,n){let r,i=0,o=e.content.length-1;for(;i<=o;){const s=Math.floor((i+o)/2),a=e.content[s];if(a.offset<=t&&a.end>t)return a;a.end<=t?(r=n?a:void 0,i=s+1):o=s-1}return r}function P(e,t=!0){for(;e.container;){const n=e.container;let r=n.content.indexOf(e);const i=n.content.length-1;for(;r<i;){r++;const e=n.content[r];if(t||!e.hidden)return e}e=n}}function O(e){const t=[];for(;e.container;){const n=e.container,r=n.content.indexOf(e);t.push({parent:n,index:r}),e=n}return t.reverse()}function L(e,t,n,r){return j([e,t,n,r].reduce(K,{}))}const M=Symbol("isProxy");function F(e){if(e&&e[M])for(const t of Object.values(e))F(t);return e}function j(e,t){const n=new Proxy({},{deleteProperty:()=>!1,get:(r,i)=>U(r,i,e,t||n),getOwnPropertyDescriptor:(r,i)=>(U(r,i,e,t||n),Object.getOwnPropertyDescriptor(r,i)),has:(t,n)=>n in e,ownKeys:()=>[...Reflect.ownKeys(e),M]});return n[M]=!0,n}const q=Symbol();function U(e,t,n,r){if(t in e){if(e[t]instanceof Error)throw new Error("Construction failure. Please make sure that your dependencies are constructable.",{cause:e[t]});if(e[t]===q)throw new Error('Cycle detected. Please make "'+String(t)+'" lazy. See https://langium.org/docs/configuration-services/#resolving-cyclic-dependencies');return e[t]}if(t in n){const i=n[t];e[t]=q;try{e[t]="function"==typeof i?i(r):j(i,r)}catch(n){throw e[t]=n instanceof Error?n:void 0,n}return e[t]}}function K(e,t){if(t)for(const[n,r]of Object.entries(t))if(void 0!==r){const t=e[n];e[n]=null!==t&&null!==r&&"object"==typeof t&&"object"==typeof r?K(t,r):r}return e}class G{constructor(e){if(this.map=new Map,e)for(const[t,n]of e)this.add(t,n)}get size(){return b.sum(R(this.map.values()).map((e=>e.length)))}clear(){this.map.clear()}delete(e,t){if(void 0===t)return this.map.delete(e);{const n=this.map.get(e);if(n){const r=n.indexOf(t);if(r>=0)return 1===n.length?this.map.delete(e):n.splice(r,1),!0}return!1}}get(e){var t;return null!==(t=this.map.get(e))&&void 0!==t?t:[]}has(e,t){if(void 0===t)return this.map.has(e);{const n=this.map.get(e);return!!n&&n.indexOf(t)>=0}}add(e,t){return this.map.has(e)?this.map.get(e).push(t):this.map.set(e,[t]),this}addAll(e,t){return this.map.has(e)?this.map.get(e).push(...t):this.map.set(e,Array.from(t)),this}forEach(e){this.map.forEach(((t,n)=>t.forEach((t=>e(t,n,this)))))}[Symbol.iterator](){return this.entries().iterator()}entries(){return R(this.map.entries()).flatMap((([e,t])=>t.map((t=>[e,t]))))}keys(){return R(this.map.keys())}values(){return R(this.map.values()).flat()}entriesGroupedByKey(){return R(this.map.entries())}}const H="AbstractRule",W="AbstractType",B="AbstractElement";function z(e){return et.isInstance(e,B)}const V="ArrayType";function Y(e){return et.isInstance(e,V)}const X="Conjunction",J="Disjunction",Q="Grammar";function Z(e){return et.isInstance(e,Q)}const ee="GrammarImport";function te(e){return et.isInstance(e,ee)}const ne="InferredType";function re(e){return et.isInstance(e,ne)}const ie="Interface";function oe(e){return et.isInstance(e,ie)}const se="LiteralCondition",ae="Negation",ce="Parameter",ue="ParameterReference";function le(e){return et.isInstance(e,ue)}const de="ParserRule";function fe(e){return et.isInstance(e,de)}const pe="ReferenceType";function he(e){return et.isInstance(e,pe)}const me="ReturnType";function ye(e){return et.isInstance(e,me)}const ge="SimpleType";function ve(e){return et.isInstance(e,ge)}const Te="TerminalRule";function Re(e){return et.isInstance(e,Te)}const ke="Type";function be(e){return et.isInstance(e,ke)}function we(e){return et.isInstance(e,"TypeAttribute")}const Se="UnionType";function $e(e){return et.isInstance(e,Se)}const xe="Action";function Ce(e){return et.isInstance(e,xe)}const Ee="Alternatives";function Ae(e){return et.isInstance(e,Ee)}const Ne="Assignment";function De(e){return et.isInstance(e,Ne)}const _e="CharacterRange";function Ie(e){return et.isInstance(e,_e)}const Pe="CrossReference";function Oe(e){return et.isInstance(e,Pe)}const Le="EndOfFile",Me="Group";function Fe(e){return et.isInstance(e,Me)}const je="Keyword";function qe(e){return et.isInstance(e,je)}const Ue="NegatedToken",Ke="RegexToken",Ge="RuleCall";function He(e){return et.isInstance(e,Ge)}const We="TerminalAlternatives",Be="TerminalGroup",ze="TerminalRuleCall";function Ve(e){return et.isInstance(e,ze)}const Ye="UnorderedGroup";function Xe(e){return et.isInstance(e,Ye)}const Je="UntilToken",Qe="Wildcard";class Ze extends p{getAllTypes(){return["AbstractElement","AbstractRule","AbstractType","Action","Alternatives","ArrayType","Assignment","CharacterRange","Condition","Conjunction","CrossReference","Disjunction","EndOfFile","Grammar","GrammarImport","Group","InferredType","Interface","Keyword","LiteralCondition","NamedArgument","NegatedToken","Negation","Parameter","ParameterReference","ParserRule","ReferenceType","RegexToken","ReturnType","RuleCall","SimpleType","TerminalAlternatives","TerminalGroup","TerminalRule","TerminalRuleCall","Type","TypeAttribute","TypeDefinition","UnionType","UnorderedGroup","UntilToken","Wildcard"]}computeIsSubtype(e,t){switch(e){case xe:return this.isSubtype(B,t)||this.isSubtype(W,t);case Ee:case Ne:case _e:case Pe:case Le:case Me:case je:case Ue:case Ke:case Ge:case We:case Be:case ze:case Ye:case Je:case Qe:return this.isSubtype(B,t);case V:case pe:case ge:case Se:return this.isSubtype("TypeDefinition",t);case X:case J:case se:case ae:case ue:return this.isSubtype("Condition",t);case ie:case ke:return this.isSubtype(W,t);case de:return this.isSubtype(H,t)||this.isSubtype(W,t);case Te:return this.isSubtype(H,t);default:return!1}}getReferenceType(e){const t=`${e.container.$type}:${e.property}`;switch(t){case"Action:type":case"CrossReference:type":case"Interface:superTypes":case"ParserRule:returnType":case"SimpleType:typeRef":return W;case"Grammar:hiddenTokens":case"ParserRule:hiddenTokens":case"RuleCall:rule":return H;case"Grammar:usedGrammars":return Q;case"NamedArgument:parameter":case"ParameterReference:parameter":return ce;case"TerminalRuleCall:rule":return Te;default:throw new Error(`${t} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case"Grammar":return{name:"Grammar",mandatory:[{name:"definesHiddenTokens",type:"boolean"},{name:"hiddenTokens",type:"array"},{name:"imports",type:"array"},{name:"interfaces",type:"array"},{name:"isDeclared",type:"boolean"},{name:"rules",type:"array"},{name:"types",type:"array"},{name:"usedGrammars",type:"array"}]};case"Interface":return{name:"Interface",mandatory:[{name:"attributes",type:"array"},{name:"superTypes",type:"array"}]};case"LiteralCondition":return{name:"LiteralCondition",mandatory:[{name:"true",type:"boolean"}]};case"NamedArgument":return{name:"NamedArgument",mandatory:[{name:"calledByName",type:"boolean"}]};case"ParserRule":return{name:"ParserRule",mandatory:[{name:"definesHiddenTokens",type:"boolean"},{name:"entry",type:"boolean"},{name:"fragment",type:"boolean"},{name:"hiddenTokens",type:"array"},{name:"parameters",type:"array"},{name:"wildcard",type:"boolean"}]};case"TerminalRule":return{name:"TerminalRule",mandatory:[{name:"fragment",type:"boolean"},{name:"hidden",type:"boolean"}]};case"TypeAttribute":return{name:"TypeAttribute",mandatory:[{name:"isOptional",type:"boolean"}]};case"UnionType":return{name:"UnionType",mandatory:[{name:"types",type:"array"}]};case"Alternatives":return{name:"Alternatives",mandatory:[{name:"elements",type:"array"}]};case"CrossReference":return{name:"CrossReference",mandatory:[{name:"deprecatedSyntax",type:"boolean"}]};case"Group":return{name:"Group",mandatory:[{name:"elements",type:"array"}]};case"RuleCall":return{name:"RuleCall",mandatory:[{name:"arguments",type:"array"}]};case"TerminalAlternatives":return{name:"TerminalAlternatives",mandatory:[{name:"elements",type:"array"}]};case"TerminalGroup":return{name:"TerminalGroup",mandatory:[{name:"elements",type:"array"}]};case"UnorderedGroup":return{name:"UnorderedGroup",mandatory:[{name:"elements",type:"array"}]};default:return{name:e,mandatory:[]}}}}const et=new Ze;function tt(e,t){let n=e;for(;n;){if(t(n))return n;n=n.$container}}function nt(e){const t=rt(e).$document;if(!t)throw new Error("AST node has no document.");return t}function rt(e){for(;e.$container;)e=e.$container;return e}function it(e,t){if(!e)throw new Error("Node must be an AstNode.");const n=null==t?void 0:t.range;return new y((()=>({keys:Object.keys(e),keyIndex:0,arrayIndex:0})),(t=>{for(;t.keyIndex<t.keys.length;){const r=t.keys[t.keyIndex];if(!r.startsWith("$")){const i=e[r];if(l(i)){if(t.keyIndex++,at(i,n))return{done:!1,value:i}}else if(Array.isArray(i)){for(;t.arrayIndex<i.length;){const e=i[t.arrayIndex++];if(l(e)&&at(e,n))return{done:!1,value:e}}t.arrayIndex=0}}t.keyIndex++}return T}))}function ot(e,t){if(!e)throw new Error("Root node must be an AstNode.");return new k(e,(e=>it(e,t)))}function st(e,t){if(!e)throw new Error("Root node must be an AstNode.");return(null==t?void 0:t.range)&&!at(e,t.range)?new k(e,(()=>[])):new k(e,(e=>it(e,t)),{includeRoot:!0})}function at(e,t){var n;if(!t)return!0;const r=null===(n=e.$cstNode)||void 0===n?void 0:n.range;return!!r&&C(r,t)}function ct(e){return new y((()=>({keys:Object.keys(e),keyIndex:0,arrayIndex:0})),(t=>{for(;t.keyIndex<t.keys.length;){const n=t.keys[t.keyIndex];if(!n.startsWith("$")){const r=e[n];if(d(r))return t.keyIndex++,{done:!1,value:{reference:r,container:e,property:n}};if(Array.isArray(r)){for(;t.arrayIndex<r.length;){const i=t.arrayIndex++,o=r[i];if(d(o))return{done:!1,value:{reference:o,container:e,property:n,index:i}}}t.arrayIndex=0}}t.keyIndex++}return T}))}function ut(e,t){const n=e.getTypeMetaData(t.$type),r=t;for(const e of n.mandatory){const t=r[e.name];"array"!==e.type||Array.isArray(t)?"boolean"===e.type&&void 0===t&&(r[e.name]=!1):r[e.name]=[]}}function lt(e){var t,n,r,i;return e.$cstNode?null===(n=null===(t=nt(e))||void 0===t?void 0:t.uri)||void 0===n?void 0:n.toString():e.$textRegion?e.$textRegion.documentURI||(null===(i=null===(r=new k(e,(e=>e.$container?[e.$container]:[])).find((e=>{var t;return null===(t=e.$textRegion)||void 0===t?void 0:t.documentURI})))||void 0===r?void 0:r.$textRegion)||void 0===i?void 0:i.documentURI):void 0}function dt(e,t){var n,r;const i={offset:e.offset,end:null!==(n=e.end)&&void 0!==n?n:e.offset+e.length,length:null!==(r=e.length)&&void 0!==r?r:e.end-e.offset};return e.range&&(i.range=e.range),null!=t||(t=e.fileURI),t&&(i.fileURI=t),i}function ft(e,t){var n,r;if(!e)return t&&dt(t);if(!t)return e&&dt(e);const i=null!==(n=e.end)&&void 0!==n?n:e.offset+e.length,o=null!==(r=t.end)&&void 0!==r?r:t.offset+t.length,s=Math.min(e.offset,t.offset),a=Math.max(i,o),c={offset:s,end:a,length:a-s};if(e.range&&t.range&&(c.range={start:t.range.start.line<e.range.start.line||t.range.start.line===e.range.start.line&&t.range.start.character<e.range.start.character?t.range.start:e.range.start,end:t.range.end.line>e.range.end.line||t.range.end.line===e.range.end.line&&t.range.end.character>e.range.end.character?t.range.end:e.range.end}),e.fileURI||t.fileURI){const n=e.fileURI,r=t.fileURI,i=n&&r&&n!==r?`<unmergable text regions of ${n}, ${r}>`:null!=n?n:r;c.fileURI=i}return c}class pt{constructor(e){this.defaultIndentation="    ",this.pendingIndent=!0,this.currentIndents=[],this.recentNonImmediateIndents=[],this.traceData=[],this.lines=[[]],this.length=0,"string"==typeof e?this.defaultIndentation=e:"number"==typeof e&&(this.defaultIndentation="".padStart(e))}get content(){return this.lines.map((e=>e.join(""))).join("")}get contentLength(){return this.length}get currentLineNumber(){return this.lines.length-1}get currentLineContent(){return this.lines[this.currentLineNumber].join("")}get currentPosition(){return{offset:this.contentLength,line:this.currentLineNumber,character:this.currentLineContent.length}}append(e,t){if(e.length>0){const n=t&&this.currentPosition;this.lines[this.currentLineNumber].push(e),this.length+=e.length,n&&this.indentPendingTraceRegions(n)}}indentPendingTraceRegions(e){for(let t=this.traceData.length-1;t>=0;t--){const n=this.traceData[t];n.targetStart&&n.targetStart.offset===e.offset&&(n.targetStart=this.currentPosition)}}increaseIndent(e){this.currentIndents.push(e),e.indentImmediately||this.recentNonImmediateIndents.push(e)}decreaseIndent(){this.currentIndents.pop()}get relevantIndents(){return this.currentIndents.filter((e=>!this.recentNonImmediateIndents.includes(e)))}resetCurrentLine(){this.length-=this.lines[this.currentLineNumber].join("").length,this.lines[this.currentLineNumber]=[],this.pendingIndent=!0}addNewLine(){this.pendingIndent=!0,this.lines.push([]),this.recentNonImmediateIndents.length=0}pushTraceRegion(e){const t=function(e,t,n){const r={sourceRegion:e,targetRegion:void 0,children:[],targetStart:t,complete:e=>{var t,i;return r.targetRegion={offset:r.targetStart.offset,end:e.offset,length:e.offset-r.targetStart.offset,range:{start:{line:r.targetStart.line,character:r.targetStart.character},end:{line:e.line,character:e.character}}},delete r.targetStart,0===(null===(t=r.children)||void 0===t?void 0:t.length)&&delete r.children,(null===(i=r.targetRegion)||void 0===i?void 0:i.length)&&n(r),delete r.complete,r}};return r}(e,this.currentPosition,(e=>{var t,n;return null===(n=null===(t=this.traceData[this.traceData.length-1])||void 0===t?void 0:t.children)||void 0===n?void 0:n.push(e)}));return this.traceData.push(t),t}popTraceRegion(e){const t=this.traceData.pop();return this.assertTrue(t===e,"Trace region mismatch!"),t}getParentTraceSourceFileURI(){var e;for(let t=this.traceData.length-1;t>-1;t--){const n=null===(e=this.traceData[t].sourceRegion)||void 0===e?void 0:e.fileURI;if(n)return n}}assertTrue(e,t){if(!e)throw new Error(t)}}function ht(e,t){"string"==typeof e?function(e,t){e&&(t.pendingIndent&&yt(t,!1),t.append(e))}(e,t):e instanceof Dt?function(e,t){var n;if(mt(e,t)){e.indentImmediately&&!t.pendingIndent&&t.append(null!==(n=e.indentation)&&void 0!==n?n:t.defaultIndentation,!0);try{t.increaseIndent(e),gt(e,t)}finally{t.decreaseIndent()}}}(e,t):e instanceof Nt?gt(e,t):e instanceof _t&&function(e,t){e.ifNotEmpty&&""===t.currentLineContent.trimStart()?t.resetCurrentLine():(t.pendingIndent&&yt(t,!0),t.append(e.lineDelimiter),t.addNewLine())}(e,t)}function mt(e,t){return"string"==typeof e?0!==e.length:e instanceof Nt?e.contents.some((e=>mt(e,t))):e instanceof _t&&!(e.ifNotEmpty&&0===t.currentLineContent.length)}function yt(e,t){var n;let r="";for(const i of e.relevantIndents.filter((e=>e.indentEmptyLines||!t)))r+=null!==(n=i.indentation)&&void 0!==n?n:e.defaultIndentation;e.append(r,!0),e.pendingIndent=!1}function gt(e,t){let n;const r=function(e){var t,n,r;if(e){if("astNode"in e)return function(e){var t,n;const{astNode:r,property:i,index:o}=null!=e?e:{},s=null!==(t=null==r?void 0:r.$cstNode)&&void 0!==t?t:null==r?void 0:r.$textRegion;if(void 0!==r&&void 0!==s){if(void 0===i)return dt(s,lt(r));{const e=e=>void 0!==o&&o>-1&&Array.isArray(r[i])?o<e.length?e[o]:void 0:e.reduce(ft,void 0);if(null===(n=s.assignments)||void 0===n?void 0:n[i]){const t=e(s.assignments[i]);return t&&dt(t,lt(r))}if(r.$cstNode){const t=e(Uo(r.$cstNode,i));return t&&dt(t,lt(r))}return}}}(e);if(Array.isArray(e))return e.reduce(ft,void 0);{const i=e;return dt(i,void 0!==(r=i)&&"element"in r&&"text"in r?function(e){try{return nt(e).uri.toString()}catch(e){return}}(null!==(n=null===(t=null==i?void 0:i.root)||void 0===t?void 0:t.astNode)&&void 0!==n?n:null==i?void 0:i.astNode):void 0)}}}(e.tracedSource);r&&(n=t.pushTraceRegion(r));for(const n of e.contents)ht(n,t);if(n){t.popTraceRegion(n);const e=t.getParentTraceSourceFileURI();e&&(null==r?void 0:r.fileURI)===e&&delete r.fileURI,n.complete&&n.complete(t.currentPosition)}}Object.freeze("__SKIP^NEW^LINE^IF^EMPTY__");const vt=/\r?\n/gm,Tt=/\S|$/;function Rt(e,...t){const n=function(e){const t=e.join("_").split(vt),n=t.length>1&&0===t[0].trim().length,r=n&&t.length>1&&0===t[t.length-1].trim().length;if(1===t.length||0!==t.length&&0!==t[0].trim().length||2===t.length&&0===t[1].trim().length)return{indentation:0,omitFirstLine:n,omitLastLine:r,trimLastLine:1!==t.length&&0===t[t.length-1].trim().length};{let e=n?t.slice(1):t;e=r?e.slice(0,e.length-1):e,e=e.filter((e=>0!==e.length));const i=function(e){const t=e.filter((e=>e.length>0)).map((e=>e.search(Tt))),n=0===t.length?0:Math.min(...t);return Math.max(0,n)}(e);return{indentation:i,omitFirstLine:n,omitLastLine:r&&(t[t.length-1].length<i||!t[t.length-1].startsWith(e[0].substring(0,i)))}}}(e),r=function(e,t,{indentation:n,omitFirstLine:r,omitLastLine:i,trimLastLine:o}){const s=[];e.forEach(((e,i)=>{s.push(...e.split(vt).map(((e,t)=>0===t||e.length<n?e:e.substring(n))).reduce(0===i?(e,t,n)=>0===n?r?[]:[t]:1===n&&0===e.length?[t]:e.concat(bt,t):(e,t,n)=>0===n?[t]:e.concat(bt,t),[]).filter((e=>!("string"==typeof e&&0===e.length))).concat(Et(t[i])?t[i]:void 0!==t[i]?{content:String(t[i])}:i<t.length?wt:[]))}));const a=s.length,c=0!==a?s[a-1]:void 0;return(i||o)&&"string"==typeof c&&0===c.trim().length?r&&1!==a&&s[a-2]===bt?s.slice(0,a-2):s.slice(0,a-1):s}(e,t,n);return function(e){const t=e.reduce(((t,n,r)=>$t(n)?t:St(n)?{node:0!==r&&($t(e[r-1])||Et(e[r-1]))||r>1&&"string"==typeof e[r-1]&&($t(e[r-2])||Et(e[r-2]))?t.node.appendNewLineIfNotEmpty():t.node.appendNewLine()}:(()=>{var i;const o=0!==r&&!St(e[r-1])||"string"!=typeof n||0===n.length?"":"".padStart(n.length-n.trimStart().length),s=xt(n)?n.content:n;let a;return{node:t.indented?t.node:0!==o.length?t.node.indent({indentation:o,indentImmediately:!1,indentedChildren:e=>a=e.append(s)}):t.node.append(s),indented:null!=a?a:null===(i=t.indented)||void 0===i?void 0:i.append(s)}})()),{node:new Nt});return t.node}(r)}function kt(e,t,n){return(r,...i)=>function(e,t,n){return r=>r instanceof Nt&&void 0===r.tracedSource?r.trace(e,t,n):(new Nt).trace(e,t,n).append(r)}(e,t,n)(Rt(r,...i))}const bt={isNewLine:!0},wt={isUndefinedSegment:!0},St=e=>e===bt,$t=e=>e===wt,xt=e=>void 0!==e.content,Ct="undefined"==typeof process?"\n":"win32"===process.platform?"\r\n":"\n";function Et(e){return e instanceof Nt||e instanceof Dt||e instanceof _t}function At(e,t){return Et(e)?function(e,t){const n=new pt(t),r=n.pushTraceRegion(void 0);ht(e,n),n.popTraceRegion(r),r.complete&&r.complete(n.currentPosition);const i=r.children&&1===r.children.length?r.children[0]:void 0,o=null==i?void 0:i.targetRegion,s=r.targetRegion;return o&&i.sourceRegion&&o.offset===s.offset&&o.length===s.length?{text:n.content,trace:i}:{text:n.content,trace:r}}(e,t).text:String(e)}class Nt{constructor(...e){this.contents=[],this.append(...e)}isEmpty(){return 0===this.contents.length}trace(e,t,n){if(l(e)){if(this.tracedSource={astNode:e,property:t,index:n},void 0===this.tracedSource.property&&void 0!==this.tracedSource.index&&this.tracedSource.index>-1)throw new Error("Generation support: 'property' argument must not be 'undefined' if a non-negative value is assigned to 'index' in 'CompositeGeneratorNode.trace(...)'.")}else this.tracedSource=e;return this}append(...e){for(const t of e)"function"==typeof t?t(this):t&&this.contents.push(t);return this}appendIf(e,...t){return e?this.append(...t):this}appendNewLine(){return this.append(It)}appendNewLineIf(e){return e?this.append(It):this}appendNewLineIfNotEmpty(){return this.append(Pt)}appendNewLineIfNotEmptyIf(e){return e?this.appendNewLineIfNotEmpty():this}appendTemplate(e,...t){return this.append(Rt(e,...t))}appendTemplateIf(e){return e?(e,...t)=>this.appendTemplate(e,...t):()=>this}indent(e){const{indentedChildren:t,indentation:n,indentEmptyLines:r,indentImmediately:i}=Array.isArray(e)||"function"==typeof e?{indentedChildren:e}:"object"==typeof e?e:{},o=new Dt(n,i,r);return this.contents.push(o),Array.isArray(t)?o.append(...t):t&&o.append(t),this}appendTraced(e,t,n){return r=>this.append((new Nt).trace(e,t,n).append(r))}appendTracedIf(e,t,n,r){return e?this.appendTraced("function"==typeof t?t():t,n,r):()=>this}appendTracedTemplate(e,t,n){return(r,...i)=>this.append(kt(e,t,n)(r,...i))}appendTracedTemplateIf(e,t,n,r){return e?this.appendTracedTemplate("function"==typeof t?t():t,n,r):()=>this}}class Dt extends Nt{constructor(e,t=!0,n=!1){super(),this.indentImmediately=!0,this.indentEmptyLines=!1,"string"==typeof e?this.indentation=e:"number"==typeof e&&(this.indentation="".padStart(e)),this.indentImmediately=t,this.indentEmptyLines=n}}class _t{constructor(e,t=!1){this.ifNotEmpty=!1,this.lineDelimiter=null!=e?e:Ct,this.ifNotEmpty=t}}const It=new _t,Pt=new _t(void 0,!0);function Ot(e){return"referenceType"in e}function Lt(e){return"elementType"in e}function Mt(e){return"types"in e}function Ft(e){if(Mt(e)){const t=[];for(const n of e.types)t.push(...Ft(n));return t}return[e]}function jt(e){return"value"in e}function qt(e){return"primitive"in e}function Ut(e){return"string"in e}function Kt(e){return e&&"type"in e}function Gt(e){return e&&"properties"in e}class Ht{constructor(e,t){var n;this.superTypes=new Set,this.subTypes=new Set,this.typeNames=new Set,this.name=e,this.declared=null!==(n=null==t?void 0:t.declared)&&void 0!==n&&n,this.dataType=null==t?void 0:t.dataType}toAstTypesString(e){const t=new Nt;return t.append(`export type ${this.name} = ${Jt(this.type,"AstType")};`,It),e&&(t.append(It),tn(t,this.name)),this.dataType&&function(e,t){switch(t.dataType){case"string":if(nn(t.type)){const n=Array.from(t.subTypes).map((e=>e.name)),r=on(t.type),i=sn(t.type);if(0===n.length&&0===r.length&&0===i.length)an(e,t.name,`typeof item === '${t.dataType}'`);else{const o=function(e,t,n){const r=[...e.map((e=>`is${e}(item)`)),...t.map((e=>`item === '${e}'`))];if(n.length>0){const e=n.map((e=>`${e}.test(item)`)).join(" || ");r.push(`(typeof item === 'string' && (${e}))`)}return r.join(" || ")}(n,r,i);an(e,t.name,o)}}break;case"number":case"boolean":case"bigint":an(e,t.name,`typeof item === '${t.dataType}'`);break;case"Date":an(e,t.name,"item instanceof Date")}}(t,this),At(t)}toDeclaredTypesString(e){const t=new Nt;return t.append(`type ${rn(this.name,e)} = ${Jt(this.type,"DeclaredType")};`,It),At(t)}}class Wt{get superProperties(){return this.getSuperProperties(new Set)}getSuperProperties(e){if(e.has(this.name))return[];e.add(this.name);const t=new Map;for(const e of this.properties)t.set(e.name,e);for(const n of this.interfaceSuperTypes){const r=n.getSuperProperties(e);for(const e of r)t.has(e.name)||t.set(e.name,e)}return Array.from(t.values())}get allProperties(){const e=new Map(this.superProperties.map((e=>[e.name,e])));for(const t of this.subTypes)this.getSubTypeProperties(t,e,new Set);return Array.from(e.values())}getSubTypeProperties(e,t,n){if(n.has(this.name))return;n.add(this.name);const r=Gt(e)?e.properties:[];for(const e of r)t.has(e.name)||t.set(e.name,e);for(const r of e.subTypes)this.getSubTypeProperties(r,t,n)}get interfaceSuperTypes(){return Array.from(this.superTypes).filter((e=>e instanceof Wt))}constructor(e,t,n){this.superTypes=new Set,this.subTypes=new Set,this.containerTypes=new Set,this.typeNames=new Set,this.declared=!1,this.abstract=!1,this.properties=[],this.name=e,this.declared=t,this.abstract=n}toAstTypesString(e){const t=new Nt,n=this.interfaceSuperTypes.map((e=>e.name)),r=n.length>0?cn([...n]):["AstNode"];return t.append(`export interface ${this.name} extends ${r.join(", ")} {`,It),t.indent((e=>{this.containerTypes.size>0&&e.append(`readonly $container: ${cn([...this.containerTypes].map((e=>e.name))).join(" | ")};`,It),this.typeNames.size>0&&e.append(`readonly $type: ${cn([...this.typeNames]).map((e=>`'${e}'`)).join(" | ")};`,It),Zt(e,this.properties,"AstType")})),t.append("}",It),e&&(t.append(It),tn(t,this.name)),At(t)}toDeclaredTypesString(e){const t=new Nt,n=rn(this.name,e),r=cn(this.interfaceSuperTypes.map((e=>e.name))).join(", ");return t.append(`interface ${n}${r.length>0?` extends ${r}`:""} {`,It),t.indent((t=>Zt(t,this.properties,"DeclaredType",e))),t.append("}",It),At(t)}}class Bt extends Error{constructor(e,t){super(e),this.name="TypeResolutionError",this.target=t}}function zt(e,t){return Vt(e,t,new Map)}function Vt(e,t,n){const r=`${Xt(e)}${Xt(t)}`;let i=n.get(r);return void 0!==i||(n.set(r,!1),i=!1,Mt(e)?i=e.types.every((e=>Vt(e,t,n))):Mt(t)?i=t.types.some((t=>Vt(e,t,n))):jt(t)&&Kt(t.value)?i=!(!jt(e)||!Kt(e.value)||t.value.name!==e.value.name)||Vt(e,t.value.type,n):Ot(e)?i=Ot(t)&&Vt(e.referenceType,t.referenceType,n):Lt(e)?i=Lt(t)&&Vt(e.elementType,t.elementType,n):jt(e)?i=Kt(e.value)?Vt(e.value.type,t,n):!!jt(t)&&(Kt(t.value)?Vt(e,t.value.type,n):Yt(e.value,t.value,new Set)):qt(e)?i=qt(t)&&e.primitive===t.primitive:Ut(e)&&(i=qt(t)&&"string"===t.primitive||Ut(t)&&t.string===e.string),i&&n.set(r,i)),i}function Yt(e,t,n){const r=e.name;if(n.has(r))return!1;if(n.add(r),e.name===t.name)return!0;for(const r of e.superTypes)if(Gt(r)&&Yt(r,t,n))return!0;return!1}function Xt(e){if(Ot(e))return`@(${Xt(e.referenceType)})}`;if(Lt(e))return`(${Xt(e.elementType)})[]`;if(Mt(e)){const t=e.types.map((e=>Xt(e))).join(" | ");return e.types.length<=1?`Union<${t}>`:t}if(jt(e))return`Value<${e.value.name}>`;if(qt(e))return e.primitive;if(Ut(e))return`'${e.string}'`;throw new Error("Invalid type")}function Jt(e,t="AstType"){if(Ot(e)){const n=Jt(e.referenceType,t);return"AstType"===t?`Reference<${n}>`:`@${Qt(e.referenceType,n)}`}if(Lt(e)){const n=Jt(e.elementType,t);return"AstType"===t?`Array<${n}>`:`${Qt(e.elementType,n)}[]`}if(Mt(e))return cn(e.types.map((e=>Qt(e,Jt(e,t))))).join(" | ");if(jt(e))return e.value.name;if(qt(e))return e.primitive;if(Ut(e)){const n="AstType"===t?"'":'"';return`${n}${e.string}${n}`}throw new Error("Invalid type")}function Qt(e,t){return Mt(e)&&(t=`(${t})`),t}function Zt(e,t,n,r=new Set){cn(t,((e,t)=>e.name.localeCompare(t.name))).forEach((t=>e.append(function(e){return`${"AstType"===n?e.name:rn(e.name,r)}${e.optional&&!en(e.type)?"?":""}: ${Jt(e.type,n)}`}(t),It)))}function en(e){return!!Lt(e)||!Ot(e)&&(Mt(e)?e.types.every((e=>en(e))):!!qt(e)&&"boolean"===e.primitive)}function tn(e,t){e.append(`export const ${t} = '${t}';`,It),e.append(It),e.append(`export function is${t}(item: unknown): item is ${t} {`,It),e.indent((e=>e.append(`return reflection.isInstance(item, ${t});`,It))),e.append("}",It)}function nn(e){let t=!0;if(qt(e))return"string"===e.primitive;if(Ut(e))return!0;if(!Mt(e))return!1;for(const n of e.types)if(jt(n)){if(!Kt(n.value))return!1;if(!nn(n.value.type))return!1}else if(qt(n)){if("string"!==n.primitive||!n.regex)return!1}else if(Mt(n))t=nn(n);else if(!Ut(n))return!1;return t}function rn(e,t){return t.has(e)?`^${e}`:e}function on(e){const t=[];if(Ut(e))return[e.string];if(Mt(e))for(const n of e.types)Ut(n)?t.push(n.string):Mt(n)&&t.push(...on(n));return t}function sn(e){const t=[];if(qt(e)&&"string"===e.primitive&&e.regex&&t.push(e.regex),Mt(e))for(const n of e.types)qt(n)&&"string"===n.primitive&&n.regex?t.push(n.regex):Mt(n)&&t.push(...sn(n));return t}function an(e,t,n){e.append(It,`export function is${t}(item: unknown): item is ${t} {`,It),e.indent((e=>e.append(`return ${n};`,It))),e.append("}",It)}function cn(e,t){return Array.from(new Set(e)).sort(t)}function un(e,t,n,r){const i=new Set;return i.add(e),t.findReferences(e,{}).forEach((e=>{const o=n.getOrCreateDocument(e.sourceUri),s=r.getAstNode(o.parseResult.value,e.sourcePath);oe(s)?(i.add(s),un(s,t,n,r).forEach((e=>i.add(e)))):s&&be(s.$container)&&i.add(s.$container)})),i}function ln(e){const t=new Set;if(oe(e))t.add(e),e.superTypes.forEach((e=>{if(oe(e.ref)){t.add(e.ref);const n=ln(e.ref);for(const e of n)t.add(e)}}));else if(be(e)){const n=dn(e.type);for(const e of n){const n=ln(e);for(const e of n)t.add(e)}}return t}function dn(e){var t;if($e(e))return e.types.flatMap((e=>dn(e)));if(ve(e)){const n=null===(t=e.typeRef)||void 0===t?void 0:t.ref;if(be(n)||oe(n))return[n]}return[]}function fn(e,t){return e.interfaces.concat(t.interfaces)}function pn(e){return e.interfaces.concat(e.unions)}function hn(e){const t=e.sort(((e,t)=>e.name.localeCompare(t.name))).map((e=>({value:e,nodes:[]})));for(const e of t)e.nodes=t.filter((t=>e.value.superTypes.has(t.value.name)));const n=[],r=t.filter((e=>0===e.nodes.length));for(;r.length>0;){const e=r.shift();n.includes(e)||(n.push(e),t.filter((t=>t.nodes.includes(e))).forEach((e=>r.push(e))))}return n.map((e=>e.value))}function mn(e){return yn(e,new Set)}function yn(e,t){if(t.has(e))return[];if(t.add(e),Mt(e))return e.types.flatMap((e=>yn(e,t)));if(jt(e)){const n=e.value;return"type"in n?yn(n.type,t):[n.name]}return Lt(e)?yn(e.elementType,t):[]}function gn(e){return"string"==typeof e.name}class vn{getName(e){if(gn(e))return e.name}getNameNode(e){return Ko(e.$cstNode,"name")}}function Tn(e){return e.charCodeAt(0)}function Rn(e,t){Array.isArray(e)?e.forEach((function(e){t.push(e)})):t.push(e)}function kn(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t],e[t]=!0}function bn(e){if(void 0===e)throw Error("Internal Error - Should never get here!");return!0}function wn(){throw Error("Internal Error - Should never get here!")}function Sn(e){return"Character"===e.type}const $n=[];for(let e=Tn("0");e<=Tn("9");e++)$n.push(e);const xn=[Tn("_")].concat($n);for(let e=Tn("a");e<=Tn("z");e++)xn.push(e);for(let e=Tn("A");e<=Tn("Z");e++)xn.push(e);const Cn=[Tn(" "),Tn("\f"),Tn("\n"),Tn("\r"),Tn("\t"),Tn("\v"),Tn("\t"),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn(""),Tn("\u2028"),Tn("\u2029"),Tn(""),Tn(""),Tn(""),Tn("\ufeff")],En=/[0-9a-fA-F]/,An=/[0-9]/,Nn=/[1-9]/;class Dn{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const t=this.disjunction();this.consumeChar("/");const n={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":kn(n,"global");break;case"i":kn(n,"ignoreCase");break;case"m":kn(n,"multiLine");break;case"u":kn(n,"unicode");break;case"y":kn(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t,loc:this.loc(0)}}disjunction(){const e=[],t=this.idx;for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){const e=[],t=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(t)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":let t;switch(this.consumeChar("?"),this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead"}bn(t);const n=this.disjunction();return this.consumeChar(")"),{type:t,value:n,loc:this.loc(e)}}return wn()}quantifier(e=!1){let t;const n=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":const n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":let e;this.isDigit()?(e=this.integerIncludingZero(),t={atLeast:n,atMost:e}):t={atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;bn(t)}if(!0!==e||void 0!==t)return bn(t)?("?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t.loc=this.loc(n),t):void 0}atom(){let e;const t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),bn(e)?(e.loc=this.loc(t),this.isQuantifier()&&(e.quantifier=this.quantifier()),e):wn()}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Tn("\n"),Tn("\r"),Tn("\u2028"),Tn("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,t=!1;switch(this.popChar()){case"d":e=$n;break;case"D":e=$n,t=!0;break;case"s":e=Cn;break;case"S":e=Cn,t=!0;break;case"w":e=xn;break;case"W":e=xn,t=!0}return bn(e)?{type:"Set",value:e,complement:t}:wn()}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Tn("\f");break;case"n":e=Tn("\n");break;case"r":e=Tn("\r");break;case"t":e=Tn("\t");break;case"v":e=Tn("\v")}return bn(e)?{type:"Character",value:e}:wn()}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Tn("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){return{type:"Character",value:Tn(this.popChar())}}classPatternCharacterAtom(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:Tn(this.popChar())}}}characterClass(){const e=[];let t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){const t=this.classAtom();if(t.type,Sn(t)&&this.isRangeDash()){this.consumeChar("-");const n=this.classAtom();if(n.type,Sn(n)){if(n.value<t.value)throw Error("Range out of order in character class");e.push({from:t.value,to:n.value})}else Rn(t.value,e),e.push(Tn("-")),Rn(n.value,e)}else Rn(t.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Tn("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;this.consumeChar("("),"?"===this.peekChar(0)?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;const t=this.disjunction();this.consumeChar(")");const n={type:"Group",capturing:e,value:t};return e&&(n.idx=this.groupIdx),n}positiveInteger(){let e=this.popChar();if(!1===Nn.test(e))throw Error("Expecting a positive integer");for(;An.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(!1===An.test(e))throw Error("Expecting an integer");for(;An.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Tn(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return"-"===this.peekChar()&&this.isClassAtom(1)}isDigit(){return An.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}}isQuantifier(){const e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let t="";for(let n=0;n<e;n++){const e=this.popChar();if(!1===En.test(e))throw Error("Expecting a HexDecimal digits");t+=e}return{type:"Character",value:parseInt(t,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class _n{visitChildren(e){for(const t in e){const n=e[t];e.hasOwnProperty(t)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((e=>{this.visit(e)}),this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}const In=new Dn,Pn=new class extends _n{constructor(){super(...arguments),this.isStarting=!0,this.endRegexStack=[],this.multiline=!1}get endRegex(){return this.endRegexStack.join("")}reset(e){this.multiline=!1,this.regex=e,this.startRegex="",this.isStarting=!0,this.endRegexStack=[]}visitGroup(e){e.quantifier&&(this.isStarting=!1,this.endRegexStack=[])}visitCharacter(e){const t=String.fromCharCode(e.value);if(this.multiline||"\n"!==t||(this.multiline=!0),e.quantifier)this.isStarting=!1,this.endRegexStack=[];else{const e=Mn(t);this.endRegexStack.push(e),this.isStarting&&(this.startRegex+=e)}}visitSet(e){if(!this.multiline){const t=this.regex.substring(e.loc.begin,e.loc.end),n=new RegExp(t);this.multiline=Boolean("\n".match(n))}if(e.quantifier)this.isStarting=!1,this.endRegexStack=[];else{const t=this.regex.substring(e.loc.begin,e.loc.end);this.endRegexStack.push(t),this.isStarting&&(this.startRegex+=t)}}visitChildren(e){"Group"===e.type&&e.quantifier||super.visitChildren(e)}};function On(e){try{return"string"==typeof e&&(e=new RegExp(e)),e=e.toString(),Pn.reset(e),Pn.visit(In.pattern(e)),Pn.multiline}catch(e){return!1}}function Ln(e){return("string"==typeof e?new RegExp(e):e).test(" ")}function Mn(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Fn;(()=>{var e={470:e=>{function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function n(e,t){for(var n,r="",i=0,o=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(47===n)break;n=47}if(47===n){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){-1===c?(r="",i=0):i=(r=r.slice(0,c)).length-1-r.lastIndexOf("/"),o=a,s=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=a,s=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,a):r=e.slice(o+1,a),i=a-o-1;o=a,s=0}else 46===n&&-1!==s?++s:s=-1}return r}var r={resolve:function(){for(var e,r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s;o>=0?s=arguments[o]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(r=s+"/"+r,i=47===s.charCodeAt(0))}return r=n(r,!i),i?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(e){if(t(e),0===e.length)return".";var r=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=n(e,!r)).length||r||(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,n=0;n<arguments.length;++n){var i=arguments[n];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":r.normalize(e)},relative:function(e,n){if(t(e),t(n),e===n)return"";if((e=r.resolve(e))===(n=r.resolve(n)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var o=e.length,s=o-i,a=1;a<n.length&&47===n.charCodeAt(a);++a);for(var c=n.length-a,u=s<c?s:c,l=-1,d=0;d<=u;++d){if(d===u){if(c>u){if(47===n.charCodeAt(a+d))return n.slice(a+d+1);if(0===d)return n.slice(a+d)}else s>u&&(47===e.charCodeAt(i+d)?l=d:0===d&&(l=0));break}var f=e.charCodeAt(i+d);if(f!==n.charCodeAt(a+d))break;47===f&&(l=d)}var p="";for(d=i+l+1;d<=o;++d)d!==o&&47!==e.charCodeAt(d)||(0===p.length?p+="..":p+="/..");return p.length>0?p+n.slice(a+l):(a+=l,47===n.charCodeAt(a)&&++a,n.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var n=e.charCodeAt(0),r=47===n,i=-1,o=!0,s=e.length-1;s>=1;--s)if(47===(n=e.charCodeAt(s))){if(!o){i=s;break}}else o=!1;return-1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename:function(e,n){if(void 0!==n&&"string"!=typeof n)throw new TypeError('"ext" argument must be a string');t(e);var r,i=0,o=-1,s=!0;if(void 0!==n&&n.length>0&&n.length<=e.length){if(n.length===e.length&&n===e)return"";var a=n.length-1,c=-1;for(r=e.length-1;r>=0;--r){var u=e.charCodeAt(r);if(47===u){if(!s){i=r+1;break}}else-1===c&&(s=!1,c=r+1),a>=0&&(u===n.charCodeAt(a)?-1==--a&&(o=r):(a=-1,o=c))}return i===o?o=c:-1===o&&(o=e.length),e.slice(i,o)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!s){i=r+1;break}}else-1===o&&(s=!1,o=r+1);return-1===o?"":e.slice(i,o)},extname:function(e){t(e);for(var n=-1,r=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===i&&(o=!1,i=a+1),46===c?-1===n?n=a:1!==s&&(s=1):-1!==n&&(s=-1);else if(!o){r=a+1;break}}return-1===n||-1===i||0===s||1===s&&n===i-1&&n===r+1?"":e.slice(n,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){t(e);var n={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;var r,i=e.charCodeAt(0),o=47===i;o?(n.root="/",r=1):r=0;for(var s=-1,a=0,c=-1,u=!0,l=e.length-1,d=0;l>=r;--l)if(47!==(i=e.charCodeAt(l)))-1===c&&(u=!1,c=l+1),46===i?-1===s?s=l:1!==d&&(d=1):-1!==s&&(d=-1);else if(!u){a=l+1;break}return-1===s||-1===c||0===d||1===d&&s===c-1&&s===a+1?-1!==c&&(n.base=n.name=0===a&&o?e.slice(1,c):e.slice(a,c)):(0===a&&o?(n.name=e.slice(1,s),n.base=e.slice(1,c)):(n.name=e.slice(a,s),n.base=e.slice(a,c)),n.ext=e.slice(s,c)),a>0?n.dir=e.slice(0,a-1):o&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};r.posix=r,e.exports=r}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{let e;if(n.r(r),n.d(r,{URI:()=>l,Utils:()=>S}),"object"==typeof process)e="win32"===process.platform;else if("object"==typeof navigator){let t=navigator.userAgent;e=t.indexOf("Windows")>=0}const t=/^\w[\w\d+.-]*$/,i=/^\//,o=/^\/\//;function s(e,n){if(!e.scheme&&n)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!t.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path)if(e.authority){if(!i.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(o.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}const a="",c="/",u=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class l{static isUri(e){return e instanceof l||!!e&&"string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"string"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString}scheme;authority;path;query;fragment;constructor(e,t,n,r,i,o=!1){"object"==typeof e?(this.scheme=e.scheme||a,this.authority=e.authority||a,this.path=e.path||a,this.query=e.query||a,this.fragment=e.fragment||a):(this.scheme=function(e,t){return e||t?e:"file"}(e,o),this.authority=t||a,this.path=function(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==c&&(t=c+t):t=c}return t}(this.scheme,n||a),this.query=r||a,this.fragment=i||a,s(this,o))}get fsPath(){return y(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:n,path:r,query:i,fragment:o}=e;return void 0===t?t=this.scheme:null===t&&(t=a),void 0===n?n=this.authority:null===n&&(n=a),void 0===r?r=this.path:null===r&&(r=a),void 0===i?i=this.query:null===i&&(i=a),void 0===o?o=this.fragment:null===o&&(o=a),t===this.scheme&&n===this.authority&&r===this.path&&i===this.query&&o===this.fragment?this:new f(t,n,r,i,o)}static parse(e,t=!1){const n=u.exec(e);return n?new f(n[2]||a,R(n[4]||a),R(n[5]||a),R(n[7]||a),R(n[9]||a),t):new f(a,a,a,a,a)}static file(t){let n=a;if(e&&(t=t.replace(/\\/g,c)),t[0]===c&&t[1]===c){const e=t.indexOf(c,2);-1===e?(n=t.substring(2),t=c):(n=t.substring(2,e),t=t.substring(e)||c)}return new f("file",n,t,a,a)}static from(e){const t=new f(e.scheme,e.authority,e.path,e.query,e.fragment);return s(t,!0),t}toString(e=!1){return g(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof l)return e;{const t=new f(e);return t._formatted=e.external,t._fsPath=e._sep===d?e.fsPath:null,t}}return e}}const d=e?1:void 0;class f extends l{_formatted=null;_fsPath=null;get fsPath(){return this._fsPath||(this._fsPath=y(this,!1)),this._fsPath}toString(e=!1){return e?g(this,!0):(this._formatted||(this._formatted=g(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=d),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}}const p={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function h(e,t,n){let r,i=-1;for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||t&&47===s||n&&91===s||n&&93===s||n&&58===s)-1!==i&&(r+=encodeURIComponent(e.substring(i,o)),i=-1),void 0!==r&&(r+=e.charAt(o));else{void 0===r&&(r=e.substr(0,o));const t=p[s];void 0!==t?(-1!==i&&(r+=encodeURIComponent(e.substring(i,o)),i=-1),r+=t):-1===i&&(i=o)}}return-1!==i&&(r+=encodeURIComponent(e.substring(i))),void 0!==r?r:e}function m(e){let t;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);35===r||63===r?(void 0===t&&(t=e.substr(0,n)),t+=p[r]):void 0!==t&&(t+=e[n])}return void 0!==t?t:e}function y(t,n){let r;return r=t.authority&&t.path.length>1&&"file"===t.scheme?`//${t.authority}${t.path}`:47===t.path.charCodeAt(0)&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&58===t.path.charCodeAt(2)?n?t.path.substr(1):t.path[1].toLowerCase()+t.path.substr(2):t.path,e&&(r=r.replace(/\//g,"\\")),r}function g(e,t){const n=t?m:h;let r="",{scheme:i,authority:o,path:s,query:a,fragment:u}=e;if(i&&(r+=i,r+=":"),(o||"file"===i)&&(r+=c,r+=c),o){let e=o.indexOf("@");if(-1!==e){const t=o.substr(0,e);o=o.substr(e+1),e=t.lastIndexOf(":"),-1===e?r+=n(t,!1,!1):(r+=n(t.substr(0,e),!1,!1),r+=":",r+=n(t.substr(e+1),!1,!0)),r+="@"}o=o.toLowerCase(),e=o.lastIndexOf(":"),-1===e?r+=n(o,!1,!0):(r+=n(o.substr(0,e),!1,!0),r+=o.substr(e))}if(s){if(s.length>=3&&47===s.charCodeAt(0)&&58===s.charCodeAt(2)){const e=s.charCodeAt(1);e>=65&&e<=90&&(s=`/${String.fromCharCode(e+32)}:${s.substr(3)}`)}else if(s.length>=2&&58===s.charCodeAt(1)){const e=s.charCodeAt(0);e>=65&&e<=90&&(s=`${String.fromCharCode(e+32)}:${s.substr(2)}`)}r+=n(s,!0,!1)}return a&&(r+="?",r+=n(a,!1,!1)),u&&(r+="#",r+=t?u:h(u,!1,!1)),r}function v(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+v(e.substr(3)):e}}const T=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function R(e){return e.match(T)?e.replace(T,(e=>v(e))):e}var k=n(470);const b=k.posix||k,w="/";var S;!function(e){e.joinPath=function(e,...t){return e.with({path:b.join(e.path,...t)})},e.resolvePath=function(e,...t){let n=e.path,r=!1;n[0]!==w&&(n=w+n,r=!0);let i=b.resolve(n,...t);return r&&i[0]===w&&!e.authority&&(i=i.substring(1)),e.with({path:i})},e.dirname=function(e){if(0===e.path.length||e.path===w)return e;let t=b.dirname(e.path);return 1===t.length&&46===t.charCodeAt(0)&&(t=""),e.with({path:t})},e.basename=function(e){return b.basename(e.path)},e.extname=function(e){return b.extname(e.path)}}(S||(S={}))})(),Fn=r})();const{URI:jn,Utils:qn}=Fn;var Un;let Kn;!function(e){e.basename=qn.basename,e.dirname=qn.dirname,e.extname=qn.extname,e.joinPath=qn.joinPath,e.resolvePath=qn.resolvePath,e.equals=function(e,t){return(null==e?void 0:e.toString())===(null==t?void 0:t.toString())},e.relative=function(e,t){const n="string"==typeof e?e:e.path,r="string"==typeof t?t:t.path,i=n.split("/").filter((e=>e.length>0)),o=r.split("/").filter((e=>e.length>0));let s=0;for(;s<i.length&&i[s]===o[s];s++);return"../".repeat(i.length-s)+o.slice(s).join("/")}}(Un||(Un={})),Un.equals,Un.relative;var Gn=n(5879),Hn=n(141);let Wn=0,Bn=10;const zn=Symbol("OperationCancelled");function Vn(e){return e===zn}async function Yn(e){if(e===Hn.CancellationToken.None)return;const t=Date.now();if(t-Wn>=Bn&&(Wn=t,await new Promise((e=>{"undefined"==typeof setImmediate?setTimeout(e,0):setImmediate(e)}))),e.isCancellationRequested)throw zn}class Xn{constructor(){this.previousAction=Promise.resolve(),this.previousTokenSource=new Hn.CancellationTokenSource}lock(e){this.cancel();const t=new Hn.CancellationTokenSource;return this.previousTokenSource=t,this.previousAction=this.previousAction.then((()=>e(t.token).catch((e=>{Vn(e)||console.error("Error: ",e)}))))}cancel(){this.previousTokenSource.cancel()}}function Jn(e){return{code:e}}var Qn,Zn;!function(e){e.all=["fast","slow","built-in"]}(Qn||(Qn={}));class er{constructor(e){this.entries=new G,this.reflection=e.shared.AstReflection}register(e,t=this,n="fast"){if("built-in"===n)throw new Error("The 'built-in' category is reserved for lexer, parser, and linker errors.");for(const[r,i]of Object.entries(e)){const e=i;if(Array.isArray(e))for(const i of e){const e={check:this.wrapValidationException(i,t),category:n};this.addEntry(r,e)}else if("function"==typeof e){const i={check:this.wrapValidationException(e,t),category:n};this.addEntry(r,i)}}}wrapValidationException(e,t){return async(n,r,i)=>{try{await e.call(t,n,r,i)}catch(e){if(Vn(e))throw e;console.error("An error occurred during validation:",e);const t=e instanceof Error?e.message:String(e);e instanceof Error&&e.stack&&console.error(e.stack),r("error","An error occurred during validation: "+t,{node:n})}}}addEntry(e,t){if("AstNode"!==e)for(const n of this.reflection.getAllSubTypes(e))this.entries.add(n,t);else this.entries.add("AstNode",t)}getChecks(e,t){let n=R(this.entries.get(e)).concat(this.entries.get("AstNode"));return t&&(n=n.filter((e=>t.includes(e.category)))),n.map((e=>e.check))}}function tr(e){if(Y(e))return{elementType:tr(e.elementType)};if(he(e))return{referenceType:tr(e.referenceType)};if($e(e))return{types:e.types.map(tr)};if(ve(e)){let t;if(e.primitiveType)return t=e.primitiveType,{primitive:t};if(e.stringType)return t=e.stringType,{string:t};if(e.typeRef){const t=wr(e.typeRef.ref);if(t)return Fr(t)?{primitive:t}:{value:t}}}return{primitive:"unknown"}}function nr(e){return"referenceType"in e}function rr(e){return"elementType"in e}function ir(e){return"types"in e}function or(e){return"value"in e}function sr(e,t,n){return{name:e.name,optional:e.optional,astNodes:e.astNodes,type:ar(e.type,void 0,t,n)}}function ar(e,t,n,r){if(rr(e))return{elementType:ar(e.elementType,t,n,r)};if(nr(e))return{referenceType:ar(e.referenceType,void 0,n,r)};if(ir(e))return{types:e.types.map((e=>ar(e,t,n,r)))};if("string"in e)return{string:e.string};if("primitive"in e)return{primitive:e.primitive,regex:e.regex};if(or(e)){const i=n.get(e.value)||r.get(e.value);return i?(t&&t.subTypes.add(i),{value:i}):{primitive:"unknown"}}throw new Error("Invalid property type")}function cr(e,t){const n=dr(e),r=dr(t);for(const e of r)ur(n,e)||n.push(e);return 1===n.length?n[0]:{types:n}}function ur(e,t){return e.some((e=>lr(e,t)))}function lr(e,t){return rr(e)&&rr(t)?lr(e.elementType,t.elementType):nr(e)&&nr(t)?lr(e.referenceType,t.referenceType):!(!or(e)||!or(t))&&e.value===t.value}function dr(e){return ir(e)?e.types.flatMap((e=>dr(e))):[e]}!function(e){e.GrammarNameUppercase="grammar-name-uppercase",e.RuleNameUppercase="rule-name-uppercase",e.HiddenGrammarTokens="hidden-grammar-tokens",e.UseRegexTokens="use-regex-tokens",e.EntryRuleTokenSyntax="entry-rule-token-syntax",e.CrossRefTokenSyntax="cross-ref-token-syntax",e.UnnecessaryFileExtension="unnecessary-file-extension",e.InvalidReturns="invalid-returns",e.InvalidInfers="invalid-infers",e.MissingInfer="missing-infer",e.MissingReturns="missing-returns",e.SuperfluousInfer="superfluous-infer",e.OptionalUnorderedGroup="optional-unordered-group"}(Zn||(Zn={}));class fr{constructor(e){this.references=e.references.References,this.documents=e.shared.workspace.LangiumDocuments}checkGrammarName(e,t){if(e.name){const n=e.name.substring(0,1);n.toUpperCase()!==n&&t("warning","Grammar name should start with an upper case letter.",{node:e,property:"name",data:Jn(Zn.GrammarNameUppercase)})}}checkEntryGrammarRule(e,t){if(e.isDeclared&&!e.name)return;const n=e.rules.filter((e=>fe(e)&&e.entry));if(e.isDeclared&&0===n.length){const n=e.rules.find((e=>fe(e)&&!gr(e)));n?t("error","The grammar is missing an entry parser rule. This rule can be an entry one.",{node:n,property:"name",data:Jn(Zn.EntryRuleTokenSyntax)}):t("error","This grammar is missing an entry parser rule.",{node:e,property:"name"})}else!e.isDeclared&&n.length>=1?n.forEach((e=>t("error","Cannot declare entry rules for unnamed grammars.",{node:e,property:"name"}))):n.length>1?n.forEach((e=>t("error","The entry rule has to be unique.",{node:e,property:"name"}))):1===n.length&&gr(n[0])&&t("error","The entry rule cannot be a data type rule.",{node:n[0],property:"name"})}checkUniqueRuleName(e,t){this.checkUniqueName(e,t,(e=>R(e.rules).filter((e=>!pr(e)))),"rule")}checkUniqueTypeName(e,t){this.checkUniqueName(e,t,(e=>R(e.types).concat(e.interfaces)),"type")}checkUniqueName(e,t,n,r){const i=new G;n(e).forEach((e=>i.add(e.name,e)));for(const[,e]of i.entriesGroupedByKey())e.length>1&&e.forEach((e=>{t("error",`A ${r}'s name has to be unique.`,{node:e,property:"name"})}));const o=new Set,s=Pr(this.documents,e);for(const e of s)n(e).forEach((e=>o.add(e.name)));for(const e of i.keys())o.has(e)&&i.get(e).forEach((e=>{t("error",`A ${r} with the name '${e.name}' already exists in an imported grammar.`,{node:e,property:"name"})}))}checkDuplicateImportedGrammar(e,t){const n=new G;for(const t of e.imports){const e=Ir(this.documents,t);e&&n.add(e,t)}for(const[,e]of n.entriesGroupedByKey())e.length>1&&e.forEach(((e,n)=>{n>0&&t("warning","The grammar is already being directly imported.",{node:e,tags:[Gn.DiagnosticTag.Unnecessary]})}))}checkUniqueImportedRules(e,t){const n=new Map;for(const t of e.imports){const e=Pr(this.documents,t);n.set(t,e)}const r=new G;for(const t of e.imports){const i=n.get(t);for(const o of e.imports){if(t===o)continue;const e=n.get(o),s=this.getDuplicateExportedRules(i,e);for(const e of s)r.add(t,e)}}for(const n of e.imports){const e=r.get(n);e.length>0&&t("error","Some rules exported by this grammar are also included in other imports: "+R(e).distinct().join(", "),{node:n,property:"path"})}}getDuplicateExportedRules(e,t){const n=e.filter((e=>!t.includes(e))).flatMap((e=>e.rules)),r=t.flatMap((e=>e.rules)),i=new Set;for(const e of n){const t=e.name;for(const e of r)t===e.name&&i.add(e.name)}return i}checkGrammarTypeInfer(e,t){var n,r,i;const o=new Set;for(const t of e.types)o.add(t.name);for(const t of e.interfaces)o.add(t.name);for(const t of Pr(this.documents,e))t.types.forEach((e=>o.add(e.name))),t.interfaces.forEach((e=>o.add(e.name)));for(const i of e.rules.filter(fe)){if(pr(i))continue;const e=gr(i),a=!i.returnType&&!i.dataType,c=wr(i);if(!e&&c&&o.has(c)===a)if(!a&&void 0===(null===(n=i.returnType)||void 0===n?void 0:n.ref)||void 0!==i.inferredType){if(a||void 0!==(null===(r=i.returnType)||void 0===r?void 0:r.ref)){const e=Wo(i.inferredType.$cstNode,"infers");t("error",s(c,a),{node:i.inferredType,property:"name",data:{code:Zn.InvalidInfers,actionSegment:x(e)}})}}else t("error",s(c,a),{node:i,property:"name",data:Jn(Zn.MissingReturns)});else if(e&&a){const e=Wo(i.$cstNode,"infer");t("error","Data type rules cannot infer a type.",{node:i,property:"inferredType",data:{code:Zn.InvalidInfers,actionSegment:x(e)}})}}for(const n of ot(e).filter(Ce)){const e=this.getActionType(n);if(e){const r=Boolean(n.inferredType),a=wr(n);if(n.type&&a&&o.has(a)===r){const e=Wo(n.$cstNode,r?"infer":"{");t("error",s(a,r),{node:n,property:"type",data:{code:r?Zn.SuperfluousInfer:Zn.MissingInfer,actionSegment:x(e)}})}else if(e&&a&&o.has(a)&&r&&n.$cstNode){const e=Ko(null===(i=n.inferredType)||void 0===i?void 0:i.$cstNode,"name"),r=Wo(n.$cstNode,"{");e&&r&&t("error",`${a} is a declared type and cannot be redefined.`,{node:n,property:"type",data:{code:Zn.SuperfluousInfer,actionRange:{start:r.range.end,end:e.range.start}}})}}}function s(e,t){return t?`The type '${e}' is already explicitly declared and cannot be inferred.`:`The type '${e}' is not explicitly declared and must be inferred.`}}getActionType(e){var t;return e.type?null===(t=e.type)||void 0===t?void 0:t.ref:e.inferredType?e.inferredType:void 0}checkGrammarHiddenTokens(e,t){e.definesHiddenTokens&&t("error","Hidden terminals are declared at the terminal definition.",{node:e,property:"definesHiddenTokens",data:Jn(Zn.HiddenGrammarTokens)})}checkHiddenTerminalRule(e,t){e.hidden&&e.fragment&&t("error","Cannot use terminal fragments as hidden tokens.",{node:e,property:"hidden"})}checkEmptyTerminalRule(e,t){try{const n=Cr(e);new RegExp(n).test("")&&t("error","This terminal could match an empty string.",{node:e,property:"name"})}catch(e){}}checkInvalidRegexFlags(e,t){const n=e.regex;if(n){const r=n.lastIndexOf("/"),i=n.substring(r+1),o="gmy",s=o+"isu",a=new Set,c=new Set;for(let e=0;e<i.length;e++){const t=i.charAt(e);s.includes(t)?o.includes(t)&&c.add(t):a.add(t)}const u=this.getFlagRange(e);u&&(a.size>0?t("error",`'${Array.from(a).join("")}' ${a.size>1?"are":"is"} not valid regular expression flag${a.size>1?"s":""}.`,{node:e,range:u}):c.size>0&&t("warning",`'${Array.from(c).join("")}' regular expression flag${c.size>1?"s":""} will be ignored by Langium.`,{node:e,range:u}))}}checkDirectlyUsedRegexFlags(e,t){if(!Re(e.$container)){const n=this.getFlagRange(e);n&&t("warning","Regular expression flags are only applied if the terminal is not a composition",{node:e,range:n})}}getFlagRange(e){const t=Ko(e.$cstNode,"regex");if(!t||!e.regex)return;const n=e.regex,r=n.lastIndexOf("/")+1;return{start:{line:t.range.end.line,character:t.range.end.character-n.length+r},end:t.range.end}}checkUsedHiddenTerminalRule(e,t){const n=tt(e,(e=>Re(e)||fe(e)));if(n){if("hidden"in n&&n.hidden)return;const r=e.rule.ref;Re(r)&&r.hidden&&t("error","Cannot use hidden terminal in non-hidden rule",{node:e,property:"rule"})}}checkUsedFragmentTerminalRule(e,t){const n=e.rule.ref;Re(n)&&n.fragment&&tt(e,fe)&&t("error","Cannot use terminal fragments as part of parser rules.",{node:e,property:"rule"})}checkCrossReferenceSyntax(e,t){e.deprecatedSyntax&&t("error","'|' is deprecated. Please, use ':' instead.",{node:e,property:"deprecatedSyntax",data:Jn(Zn.CrossRefTokenSyntax)})}checkPackageImport(e,t){void 0===Ir(this.documents,e)?t("error","Import cannot be resolved.",{node:e,property:"path"}):e.path.endsWith(".langium")&&t("warning","Imports do not need file extensions.",{node:e,property:"path",data:Jn(Zn.UnnecessaryFileExtension)})}checkInvalidCharacterRange(e,t){if(e.right){const n="Character ranges cannot use more than one character";let r=!1;e.left.value.length>1&&(r=!0,t("error",n,{node:e.left,property:"value"})),e.right.value.length>1&&(r=!0,t("error",n,{node:e.right,property:"value"})),r||t("hint","Consider using regex instead of character ranges",{node:e,data:Jn(Zn.UseRegexTokens)})}}checkGrammarForUnusedRules(e,t){const n=Fo(e,!0);for(const r of e.rules)Re(r)&&r.hidden||pr(r)||n.has(r)||t("hint","This rule is declared but never referenced.",{node:r,property:"name",tags:[Gn.DiagnosticTag.Unnecessary]})}checkClashingTerminalNames(e,t){const n=new G,r=new Set;for(const t of e.rules)Re(t)&&t.name&&n.add(t.name,t),fe(t)&&ot(t).filter(qe).forEach((e=>r.add(e.value)));const i=new G,o=new G;for(const t of e.imports){const e=Pr(this.documents,t);for(const n of e)for(const e of n.rules)Re(e)&&e.name?i.add(e.name,t):fe(e)&&e.name&&ot(e).filter(qe).forEach((e=>o.add(e.value,t)))}for(const e of n.values())r.has(e.name)?t("error","Terminal name clashes with existing keyword.",{node:e,property:"name"}):o.has(e.name)&&t("error",`Terminal name clashes with imported keyword from "${o.get(e.name)[0].path}".`,{node:e,property:"name"});const s=new G;for(const e of r)for(const t of i.get(e))s.add(t,e);for(const[e,n]of s.entriesGroupedByKey())n.length>0&&t("error",`Imported terminals (${n.join(", ")}) clash with locally defined keywords.`,{node:e,property:"path"});const a=new G;for(const[e,t]of i.entriesGroupedByKey()){const n=o.get(e);n.length>0&&t.filter((e=>!n.includes(e))).forEach((t=>a.add(t,e)))}for(const[e,n]of a.entriesGroupedByKey())n.length>0&&t("error",`Imported terminals (${n.join(", ")}) clash with imported keywords.`,{node:e,property:"path"})}checkRuleName(e,t){if(e.name&&!pr(e)){const n=e.name.substring(0,1);n.toUpperCase()!==n&&t("warning","Rule name should start with an upper case letter.",{node:e,property:"name",data:Jn(Zn.RuleNameUppercase)})}}checkTypeReservedName(e,t){this.checkReservedName(e,"name",t)}checkAssignmentReservedName(e,t){this.checkReservedName(e,"feature",t)}checkParserRuleReservedName(e,t){e.inferredType||this.checkReservedName(e,"name",t)}checkReservedName(e,t,n){const r=e[t];"string"==typeof r&&hr.has(r)&&n("error",`'${r}' is a reserved name of the JavaScript runtime.`,{node:e,property:t})}checkKeyword(e,t){tt(e,fe)&&(0===e.value.length?t("error","Keywords cannot be empty.",{node:e}):0===e.value.trim().length?t("error","Keywords cannot only consist of whitespace characters.",{node:e}):/\s/g.test(e.value)&&t("warning","Keywords should not contain whitespace characters.",{node:e}))}checkUnorderedGroup(e,t){e.elements.forEach((e=>{yr(e.cardinality)&&t("error","Optional elements in Unordered groups are currently not supported",{node:e,data:Jn(Zn.OptionalUnorderedGroup)})}))}checkRuleParametersUsed(e,t){const n=e.parameters;if(n.length>0){const r=ot(e).filter(le);for(const e of n)r.some((t=>t.parameter.ref===e))||t("hint",`Parameter '${e.name}' is unused.`,{node:e,tags:[Gn.DiagnosticTag.Unnecessary]})}}checkParserRuleDataType(e,t){if(pr(e))return;const n=function(e){var t;const n=null===(t=e.returnType)||void 0===t?void 0:t.ref;return void 0!==e.dataType||be(n)&&Tr(n.type,new Set)}(e),r=gr(e);!n&&r?t("error","This parser rule does not create an object. Add a primitive return type or an action to the start of the rule to force object instantiation.",{node:e,property:"name"}):n&&!r&&t("error","Normal parser rules are not allowed to return a primitive value. Use a datatype rule for that.",{node:e,property:e.dataType?"dataType":"returnType"})}checkAssignmentToFragmentRule(e,t){e.terminal&&He(e.terminal)&&fe(e.terminal.rule.ref)&&e.terminal.rule.ref.fragment&&t("error",`Cannot use fragment rule '${e.terminal.rule.ref.name}' for assignment of property '${e.feature}'.`,{node:e,property:"terminal"})}checkAssignmentTypes(e,t){if(!e.terminal)return;let n;ot(e.terminal).map((e=>Oe(e)?"ref":"other")).find((e=>n?e!==n:(n=e,!1)))&&t("error",this.createMixedTypeError(e.feature),{node:e,property:"terminal"})}checkInterfacePropertyTypes(e,t){for(const n of e.attributes)if(n.type){const e=dr(tr(n.type));let r=!1,i=!1;for(const t of e)nr(t)?r=!0:nr(t)||(i=!0);r&&i&&t("error",this.createMixedTypeError(n.name),{node:n,property:"type"})}}createMixedTypeError(e){return`Mixing a cross-reference with other types is not supported. Consider splitting property "${e}" into two or more different properties.`}checkTerminalRuleReturnType(e,t){var n;(null===(n=e.type)||void 0===n?void 0:n.name)&&!Fr(e.type.name)&&t("error","Terminal rules can only return primitive types like 'string', 'boolean', 'number', 'Date' or 'bigint'.",{node:e.type,property:"name"})}checkRuleCallParameters(e,t){const n=e.rule.ref;if(fe(n)){const r=n.parameters.length,i=e.arguments.length;r!==i&&t("error",`Rule '${n.name}' expects ${r} arguments, but got ${i}.`,{node:e})}else Re(n)&&e.arguments.length>0&&t("error","Terminal rules do not accept any arguments",{node:e})}checkCrossRefNameAssignment(e,t){e.terminal||!e.type.ref||Vo(e.type.ref)||t("error","Cannot infer terminal or data type rule for cross-reference.",{node:e,property:"type"})}checkCrossRefTerminalType(e,t){var n;const r=e.terminal;if(He(r)){const e=r.rule.ref;fe(e)&&!gr(e)?t("error","Parser rules cannot be used for cross-references.",{node:r,property:"rule"}):fe(e)&&!Rr(e,new Set)?t("error","Data type rules for cross-references must be of type string.",{node:r,property:"rule"}):Re(e)&&(null===(n=e.type)||void 0===n?void 0:n.name)&&"string"!==e.type.name&&t("error","Terminal rules for cross-references must be of type string.",{node:r,property:"rule"})}}checkCrossRefType(e,t){const n=this.checkReferenceToRuleButNotType(null==e?void 0:e.type);n&&t("error",n,{node:e,property:"type"})}checkCrossReferenceToTypeUnion(e,t){if(be(e.type.ref)&&$e(e.type.ref.type)){const n=mr(e.type.ref.type);n.length>0&&t("error",`Cross-reference on type union is only valid if all alternatives are AST nodes. ${n.join(", ")} ${n.length>1?"are":"is"} not ${n.length>1?"":"an "}AST node${n.length>1?"s":""}.`,{node:e,property:"type"})}}checkFragmentsInTypes(e,t){var n,r;fe(null===(n=e.typeRef)||void 0===n?void 0:n.ref)&&(null===(r=e.typeRef)||void 0===r?void 0:r.ref.fragment)&&t("error","Cannot use rule fragments in types.",{node:e,property:"typeRef"})}checkReferenceTypeUnion(e,t){ve(e.referenceType)||t("error","Only direct rule references are allowed in reference types.",{node:e,property:"referenceType"})}checkReferenceToRuleButNotType(e){if(e&&fe(e.ref)&&!gr(e.ref)&&(e.ref.returnType||e.ref.inferredType)){const t=wr(e.ref);if(t)return`Use the rule type '${t}' instead of the typed rule name '${e.ref.name}' for cross-references.`}}checkAssignmentWithFeatureName(e,t){"name"===e.feature&&Oe(e.terminal)&&t("warning",'The "name" property is not recommended for cross-references.',{node:e,property:"feature"})}}function pr(e){return!e.definition||!e.definition.$cstNode||0===e.definition.$cstNode.length}const hr=new Set(["Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Map","Set","WeakMap","WeakSet","Error","AggregateError","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","BigInt","RegExp","Number","Object","Function","Symbol","String","Math","NaN","Infinity","isFinite","isNaN","Buffer","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","globalThis","decodeURIComponent","decodeURI","encodeURIComponent","encodeURI","parseInt","parseFloat","Promise","Generator","GeneratorFunction","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Reflect","Proxy","Date","Intl","eval","undefined"]);function mr(e){const t=[];return e.types.forEach((e=>{var n;ve(e)&&((null===(n=e.typeRef)||void 0===n?void 0:n.ref)?be(e.typeRef.ref)&&($e(e.typeRef.ref.type)?t.push(...mr(e.typeRef.ref.type)):t.push(e.typeRef.ref.name)):e.stringType?t.push(`"${e.stringType}"`):e.primitiveType&&t.push(e.primitiveType))})),Array.from(new Set(t))}function yr(e,t){return"?"===e||"*"===e||Fe(t)&&Boolean(t.guardCondition)}function gr(e){return vr(e,new Set)}function vr(e,t){if(t.has(e))return!0;t.add(e);for(const n of ot(e))if(He(n)){if(!n.rule.ref)return!1;if(fe(n.rule.ref)&&!vr(n.rule.ref,t))return!1}else{if(De(n))return!1;if(Ce(n))return!1}return Boolean(e.definition)}function Tr(e,t){if(t.has(e))return!0;if(t.add(e),Y(e))return!1;if(he(e))return!1;if($e(e))return e.types.every((e=>Tr(e,t)));if(ve(e)){if(void 0!==e.primitiveType)return!0;if(void 0!==e.stringType)return!0;if(void 0!==e.typeRef){const n=e.typeRef.ref;return!!be(n)&&Tr(n.type,t)}return!1}return!1}function Rr(e,t){var n,r;if(t.has(e))return!0;if(t.add(e),fe(e)){if(e.dataType)return"string"===e.dataType;if(null===(n=e.returnType)||void 0===n?void 0:n.ref)return Rr(e.returnType.ref,t)}else{if(be(e))return Rr(e.type,t);if(Y(e))return!1;if(he(e))return!1;if($e(e))return e.types.every((e=>Rr(e,t)));if(ve(e)){if("string"===e.primitiveType)return!0;if(e.stringType)return!0;if(null===(r=e.typeRef)||void 0===r?void 0:r.ref)return Rr(e.typeRef.ref,t)}}return!1}function kr(e){const t=e.$container;if(Fe(t)){const n=t.elements;for(let t=n.indexOf(e)-1;t>=0;t--){const e=n[t];if(Ce(e))return e;{const e=ot(n[t]).find(Ce);if(e)return e}}}return z(t)?kr(t):void 0}function br(e){var t;if(fe(e))return gr(e)?e.name:null!==(t=Sr(e))&&void 0!==t?t:e.name;if(oe(e)||be(e)||ye(e))return e.name;if(Ce(e)){const t=$r(e);if(t)return t}else if(re(e))return e.name;throw new Bt("Cannot get name of Unknown Type",e.$cstNode)}function wr(e){if(e)try{return br(e)}catch(e){return}}function Sr(e){if(e.inferredType)return e.inferredType.name;if(e.dataType)return e.dataType;if(e.returnType){const t=e.returnType.ref;if(t){if(fe(t))return t.name;if(oe(t)||be(t))return t.name}}}function $r(e){var t;return e.inferredType?e.inferredType.name:(null===(t=e.type)||void 0===t?void 0:t.ref)?br(e.type.ref):void 0}function xr(e){var t,n,r;return Re(e)?null!==(n=null===(t=e.type)||void 0===t?void 0:t.name)&&void 0!==n?n:"string":gr(e)?e.name:null!==(r=Sr(e))&&void 0!==r?r:e.name}function Cr(e){const t={s:!1,i:!1,u:!1},n=Ar(e.definition,t),r=Object.entries(t).filter((([,e])=>e)).map((([e])=>e)).join("");return new RegExp(n,r)}const Er=/[\s\S]/.source;function Ar(e,t){if(a=e,et.isInstance(a,We))return Dr((s=e).elements.map((e=>Ar(e))).join("|"),{cardinality:s.cardinality,lookahead:s.lookahead});if(function(e){return et.isInstance(e,Be)}(e))return Dr((o=e).elements.map((e=>Ar(e))).join(""),{cardinality:o.cardinality,lookahead:o.lookahead});if(Ie(e))return(n=e).right?Dr(`[${Nr(n.left)}-${Nr(n.right)}]`,{cardinality:n.cardinality,lookahead:n.lookahead,wrap:!1}):Dr(Nr(n.left),{cardinality:n.cardinality,lookahead:n.lookahead,wrap:!1});var n,r,i,o,s,a;if(Ve(e)){const t=e.rule.ref;if(!t)throw new Error("Missing rule reference.");return Dr(Ar(t.definition),{cardinality:e.cardinality,lookahead:e.lookahead})}if(function(e){return et.isInstance(e,Ue)}(e))return Dr(`(?!${Ar((r=e).terminal)})${Er}*?`,{cardinality:r.cardinality,lookahead:r.lookahead});if(function(e){return et.isInstance(e,Je)}(e))return Dr(`${Er}*?${Ar((i=e).terminal)}`,{cardinality:i.cardinality,lookahead:i.lookahead});if(function(e){return et.isInstance(e,Ke)}(e)){const n=e.regex.lastIndexOf("/"),r=e.regex.substring(1,n),i=e.regex.substring(n+1);return t&&(t.i=i.includes("i"),t.s=i.includes("s"),t.u=i.includes("u")),Dr(r,{cardinality:e.cardinality,lookahead:e.lookahead,wrap:!1})}if(function(e){return et.isInstance(e,Qe)}(e))return Dr(Er,{cardinality:e.cardinality,lookahead:e.lookahead});throw new Error(`Invalid terminal element: ${null==e?void 0:e.$type}`)}function Nr(e){return Mn(e.value)}function Dr(e,t){var n;return(!1!==t.wrap||t.lookahead)&&(e=`(${null!==(n=t.lookahead)&&void 0!==n?n:""}${e})`),t.cardinality?`${e}${t.cardinality}`:e}function _r(e){if(void 0===e.path||0===e.path.length)return;const t=Un.dirname(nt(e).uri);let n=e.path;return n.endsWith(".langium")||(n+=".langium"),Un.resolvePath(t,n)}function Ir(e,t){const n=_r(t);try{if(n){const t=e.getOrCreateDocument(n).parseResult.value;if(Z(t))return t}}catch(e){}}function Pr(e,t){if(te(t)){const n=Ir(e,t);if(n){const t=Or(e,n);return t.push(n),t}return[]}return Or(e,t)}function Or(e,t,n=t,r=new Set,i=new Set){const o=nt(t);if(n!==t&&i.add(t),!r.has(o.uri)){r.add(o.uri);for(const o of t.imports){const t=Ir(e,o);t&&Or(e,t,n,r,i)}}return Array.from(i)}function Lr(e){return De(e)?[e]:Ae(e)||Fe(e)||Xe(e)?e.elements.flatMap((e=>Lr(e))):He(e)&&e.rule.ref?Lr(e.rule.ref.definition):[]}const Mr=["string","number","boolean","Date","bigint"];function Fr(e){return Mr.includes(e)}class jr{constructor(e,t){this.context=e,this.root=t}getTypes(){const e={name:this.root.name,properties:this.root.properties,ruleCalls:this.root.ruleCalls,super:[]};return 0===this.root.children.length?[{alt:e,next:[]}]:this.applyNext(this.root,{alt:e,next:this.root.children})}applyNext(e,t){const n=this.splitType(t.alt,t.next.length),r=[];for(let i=0;i<t.next.length;i++){const o=n[i],s=t.next[i];s.actionWithAssignment&&r.push({alt:qr(o),next:[]}),void 0!==s.name&&s.name!==o.name&&(s.actionWithAssignment?(o.properties=[],o.ruleCalls=[],o.super=[e.name],o.name=s.name):(o.super=[o.name,...o.ruleCalls],o.properties=[],o.ruleCalls=[],o.name=s.name)),o.properties.push(...s.properties),o.ruleCalls.push(...s.ruleCalls);const a={alt:o,next:s.children};0===a.next.length?(a.alt.super=a.alt.super.filter((e=>e!==a.alt.name)),r.push(a)):r.push(...this.applyNext(e,a))}return Yr(r)}splitType(e,t){const n=[];for(let r=0;r<t;r++)n.push(qr(e));return n}getSuperTypes(e){const t=new Set;return this.collectSuperTypes(e,e,t),Array.from(t)}collectSuperTypes(e,t,n){if(t.ruleCalls.length>0)for(const e of t.ruleCalls)n.add(e);else{for(const r of t.parents)void 0===e.name?this.collectSuperTypes(r,r,n):void 0!==r.name&&r.name!==e.name?n.add(r.name):this.collectSuperTypes(e,r,n);0===t.parents.length&&t.name&&n.add(t.name)}}connect(e,t){return t.parents.push(e),e.children.push(t),t}merge(...e){if(1===e.length)return e[0];if(0===e.length)throw new Error("No parts to merge");const t=Br();t.parents=e;for(const n of e)n.children.push(t);return t}hasLeafNode(e){return this.partHasLeafNode(e)}partHasLeafNode(e,t){return!!e.children.some((e=>e!==t))||!e.name&&e.parents.some((t=>this.partHasLeafNode(t,e)))}}function qr(e){return{name:e.name,super:e.super,ruleCalls:e.ruleCalls,properties:e.properties.map((e=>Ur(e)))}}function Ur(e){return{name:e.name,optional:e.optional,type:e.type,astNodes:e.astNodes}}function Kr(e,t,n){const r=[],i={fragments:new Map};for(const t of e)r.push(...Wr(i,t));const o=function(e){const t=new Map,n=[],r=Yr(e).map((e=>e.alt));for(const e of r){const r={name:e.name,properties:e.properties,superTypes:new Set(e.super),subTypes:new Set,declared:!1,abstract:!1};t.set(r.name,r),e.ruleCalls.length>0&&(n.push(e),e.ruleCalls.forEach((e=>{e!==r.name&&r.subTypes.add(e)})))}for(const e of n)for(const n of e.ruleCalls){const r=t.get(n);r&&r.name!==e.name&&r.superTypes.add(e.name)}return Array.from(t.values())}(r),s=function(e){const t=new Map(e.map((e=>[e.name,e]))),n=[],r=new G;for(const t of e)for(const e of t.superTypes)r.add(e,t.name);for(const[e,i]of r.entriesGroupedByKey())if(!t.has(e)){const t={declared:!1,name:e,subTypes:new Set,superTypes:new Set,type:Xr(!1,!1,i)};n.push(t)}return n}(o),a=function(e,t,n){const r=new G;for(const t of e)for(const e of t.superTypes)r.add(e,t.name);const i=new Set(n.interfaces.map((e=>e.name))),o={interfaces:[],unions:t},s=new Map(t.map((e=>[e.name,e])));for(const t of e){const e=new Set(r.get(t.name));if(0===t.properties.length&&e.size>0)if(i.has(t.name))t.abstract=!0,o.interfaces.push(t);else{const n=Xr(!1,!1,Array.from(e)),r=s.get(t.name);if(r)r.type=cr(r.type,n);else{const r={name:t.name,declared:!1,subTypes:e,superTypes:t.superTypes,type:n};o.unions.push(r),s.set(t.name,r)}}else o.interfaces.push(t)}for(const e of o.interfaces)e.superTypes=new Set([...e.superTypes].filter((e=>!s.has(e))));return o}(o,s,n);for(const e of t){const t=Gr(e);a.unions.push({name:e.name,declared:!1,type:t,subTypes:new Set,superTypes:new Set,dataType:e.dataType})}return a}function Gr(e){if(e.dataType&&"string"!==e.dataType)return{primitive:e.dataType};let t=!1;const n=Hr(e.definition,(()=>(t=!0,{primitive:"unknown"})));return t?{primitive:"string"}:n}function Hr(e,t){var n,r,i;if(e.cardinality)return t();if(Ae(e))return{types:e.elements.map((e=>Hr(e,t)))};if(Fe(e)||Xe(e))return 1!==e.elements.length?t():Hr(e.elements[0],t);if(He(e)){const o=null===(n=e.rule)||void 0===n?void 0:n.ref;return o?Re(o)?{primitive:null!==(i=null===(r=o.type)||void 0===r?void 0:r.name)&&void 0!==i?i:"string",regex:Cr(o).toString()}:{value:o.name}:t()}return qe(e)?{string:e.value}:t()}function Wr(e,t){const n=Br(t),r=new jr(e,n);return t.definition&&zr(r,r.root,t.definition),r.getTypes()}function Br(e){return{name:fe(e)||Ce(e)?wr(e):e,properties:[],ruleCalls:[],children:[],parents:[],actionWithAssignment:!1}}function zr(e,t,n){const r=yr(n.cardinality,n);if(Ae(n)){const i=[];r&&i.push(e.connect(t,Br()));for(const r of n.elements){const n=e.connect(t,Br());i.push(zr(e,n,r))}return e.merge(...i)}if(Fe(n)||Xe(n)){let i,o=e.connect(t,Br());r&&(i=e.connect(t,Br()));for(const t of n.elements)o=zr(e,o,t);return i?e.merge(i,o):o}return Ce(n)?function(e,t,n){var r,i;if(!e.hasLeafNode(t)){const n={name:(i=t).name,children:[],parents:[],actionWithAssignment:i.actionWithAssignment,ruleCalls:[...i.ruleCalls],properties:i.properties.map(Ur)};e.connect(t,n)}const o=e.connect(t,Br(n));if(n.type){const e=null===(r=n.type)||void 0===r?void 0:r.ref;e&&gn(e)&&(o.name=e.name)}return n.feature&&n.operator&&(o.actionWithAssignment=!0,o.properties.push({name:n.feature,optional:!1,type:Xr("+="===n.operator,!1,0!==e.root.ruleCalls.length?e.root.ruleCalls:e.getSuperTypes(o)),astNodes:new Set([n])})),o}(e,t,n):(De(n)?function(e,t){const n={types:new Set,reference:!1};Vr(t.terminal,n);const r=Xr("+="===t.operator,n.reference,"?="===t.operator?["boolean"]:Array.from(n.types));e.properties.push({name:t.feature,optional:yr(t.cardinality),type:r,astNodes:new Set([t])})}(t,n):He(n)&&function(e,t,n){const r=n.rule.ref;if(fe(r)&&r.fragment){const i=function(e,t){const n=t.fragments.get(e);if(n)return n;const r=[];t.fragments.set(e,r);const i=wr(e),o=Wr(t,e).filter((e=>e.alt.name===i));return r.push(...o.flatMap((e=>e.alt.properties))),r}(r,e.context);yr(n.cardinality)?t.properties.push(...i.map((e=>Object.assign(Object.assign({},e),{optional:!0})))):t.properties.push(...i)}else fe(r)&&t.ruleCalls.push(xr(r))}(e,t,n),t)}function Vr(e,t){if(Ae(e)||Xe(e)||Fe(e))for(const n of e.elements)Vr(n,t);else if(qe(e))t.types.add(`'${e.value}'`);else if(He(e)&&e.rule.ref)t.types.add(xr(e.rule.ref));else if(Oe(e)&&e.type.ref){const n=wr(e.type.ref);n&&t.types.add(n),t.reference=!0}}function Yr(e){const t=e.reduce(((e,t)=>e.add(t.alt.name,t)),new G),n=[];for(const[e,r]of t.entriesGroupedByKey()){const t=[],i=new Set,o={alt:{name:e,properties:t,ruleCalls:[],super:[]},next:[]};for(const e of r){const n=e.alt;o.alt.super.push(...n.super),o.next.push(...e.next);const r=n.properties;for(const e of r){const n=t.find((t=>t.name===e.name));n?(n.type=cr(n.type,e.type),e.astNodes.forEach((e=>n.astNodes.add(e)))):t.push(Object.assign({},e))}n.ruleCalls.forEach((e=>i.add(e)))}for(const e of r){const n=e.alt;if(0===n.ruleCalls.length)for(const e of t)n.properties.find((t=>t.name===e.name))||(e.optional=!0)}o.alt.ruleCalls=Array.from(i),n.push(o)}return n}function Xr(e,t,n){if(e)return{elementType:Xr(!1,t,n)};if(t)return{referenceType:Xr(!1,!1,n)};if(1===n.length){const e=n[0];return e.startsWith("'")?{string:e.substring(1,e.length-1)}:Fr(e)?{primitive:e}:{value:e}}return{types:n.map((e=>Xr(!1,!1,[e])))}}function Jr(e,t){const n=Qr(e,t),r=function(e,t){const n={unions:[],interfaces:[]};for(const t of e){const e=[];for(const n of t.attributes)e.push({name:n.name,optional:n.isOptional,astNodes:new Set([n]),type:tr(n.type)});const r=new Set;for(const e of t.superTypes)e.ref&&r.add(br(e.ref));const i={name:t.name,declared:!0,abstract:!1,properties:e,superTypes:r,subTypes:new Set};n.interfaces.push(i)}for(const e of t){const t={name:e.name,declared:!0,type:tr(e.type),superTypes:new Set,subTypes:new Set};n.unions.push(t)}return n}(n.interfaces,n.types);return{astResources:n,inferred:Kr(n.parserRules,n.datatypeRules,r),declared:r}}function Qr(e,t,n=new Set,r={parserRules:[],datatypeRules:[],interfaces:[],types:[]}){Array.isArray(e)||(e=[e]);for(const i of e){const e=nt(i);if(!n.has(e.uri)){n.add(e.uri);for(const e of i.rules)fe(e)&&!e.fragment&&(gr(e)?r.datatypeRules.push(e):r.parserRules.push(e));i.interfaces.forEach((e=>r.interfaces.push(e))),i.types.forEach((e=>r.types.push(e))),t&&Qr(i.imports.map((e=>Ir(t,e))).filter((e=>void 0!==e)),t,n,r)}}return r}function Zr(e,t){var n,r;const i=function(e){const t=new Map,n=new Map;for(const n of e.interfaces){const e=new Wt(n.name,n.declared,n.abstract);t.set(n.name,e)}for(const t of e.unions){const e=new Ht(t.name,{declared:t.declared,dataType:t.dataType});n.set(t.name,e)}for(const r of e.interfaces){const e=t.get(r.name);for(const i of r.superTypes){const r=t.get(i)||n.get(i);r&&e.superTypes.add(r)}for(const i of r.subTypes){const r=t.get(i)||n.get(i);r&&e.subTypes.add(r)}for(const i of r.properties){const r=sr(i,t,n);e.properties.push(r)}}for(const r of e.unions){const e=n.get(r.name);e.type=ar(r.type,e,t,n)}return{interfaces:Array.from(t.values()),unions:Array.from(n.values())}}({interfaces:hn(ei(...e.interfaces,...null!==(n=null==t?void 0:t.interfaces)&&void 0!==n?n:[])),unions:ei(...e.unions,...null!==(r=null==t?void 0:t.unions)&&void 0!==r?r:[])});return function(e){const t=function({interfaces:e,unions:t}){const n=e.concat(t).reduce(((e,t)=>(e.set(t.name,t),e)),new Map),r=new Map;for(const e of t)r.set(e,ti(e.type,new Set));for(const[e,t]of r)t&&n.delete(e.name);return n}(e),n=Array.from(t.values());(function(e){for(const t of e)for(const e of t.superTypes)e.subTypes.add(t)})(n),function(e){var t;const n=e.reduce(((e,t)=>(e.set(t.name,t),e)),new Map);for(const r of e){const e=r.properties.flatMap((e=>mn(e.type)));for(const i of e)null===(t=n.get(i))||void 0===t||t.containerTypes.add(r)}const r=new Set,i=e.filter((e=>0===e.subTypes.size)),o=new Set(i);for(;i.length>0;){const e=i.shift();if(e)for(const t of e.superTypes)Gt(t)&&(0===e.containerTypes.size?(r.add(t.name),t.containerTypes.clear()):r.has(t.name)||e.containerTypes.forEach((e=>t.containerTypes.add(e))),o.has(t)||(o.add(t),i.push(t)))}}(e.interfaces),function(e){const t=new Set,n=e=>{if(!t.has(e)){t.add(e),e.typeNames.add(e.name);for(const t of e.subTypes)n(t),t.typeNames.forEach((t=>e.typeNames.add(t)))}};e.forEach(n)}(n)}(i),i}function ei(...e){return Array.from(e.reduce(((e,t)=>(e.set(t.name,t),e)),new Map).values()).sort(((e,t)=>e.name.localeCompare(t.name)))}function ti(e,t){if(t.has(e))return!0;if(t.add(e),Mt(e))return e.types.every((e=>ti(e,t)));if(jt(e)){const n=e.value;return!!Kt(n)&&ti(n.type,t)}return qt(e)||Ut(e)}const ni={languageId:"langium",fileExtensions:[".langium"],caseInsensitive:!1},ri={maxLookahead:3},ii={AstReflection:()=>new Ze},oi={Grammar:()=>null!=Kn?Kn:Kn=Xo('{"$type":"Grammar","isDeclared":true,"name":"LangiumGrammar","rules":[{"$type":"ParserRule","name":"Grammar","entry":true,"definition":{"$type":"Group","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"isDeclared","operator":"?=","terminal":{"$type":"Keyword","value":"grammar"}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"with"},{"$type":"Assignment","feature":"usedGrammars","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"usedGrammars","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}],"cardinality":"?"},{"$type":"Group","elements":[{"$type":"Assignment","feature":"definesHiddenTokens","operator":"?=","terminal":{"$type":"Keyword","value":"hidden"}},{"$type":"Keyword","value":"("},{"$type":"Group","elements":[{"$type":"Assignment","feature":"hiddenTokens","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"hiddenTokens","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}],"cardinality":"?"},{"$type":"Keyword","value":")"}],"cardinality":"?"}],"cardinality":"?"},{"$type":"Assignment","feature":"imports","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@12"},"arguments":[]},"cardinality":"*"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"rules","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@11"},"arguments":[]}},{"$type":"Assignment","feature":"interfaces","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@1"},"arguments":[]}},{"$type":"Assignment","feature":"types","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@10"},"arguments":[]}}],"cardinality":"+"}]},"definesHiddenTokens":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Interface","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"interface"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"extends"},{"$type":"Assignment","feature":"superTypes","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"superTypes","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}],"cardinality":"?"},{"$type":"RuleCall","rule":{"$ref":"#/rules@2"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SchemaType","fragment":true,"definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"{"},{"$type":"Assignment","feature":"attributes","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@3"},"arguments":[]},"cardinality":"*"},{"$type":"Keyword","value":"}"},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TypeAttribute","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]}},{"$type":"Assignment","feature":"isOptional","operator":"?=","terminal":{"$type":"Keyword","value":"?"},"cardinality":"?"},{"$type":"Keyword","value":":"},{"$type":"Assignment","feature":"type","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TypeDefinition","definition":{"$type":"RuleCall","rule":{"$ref":"#/rules@5"},"arguments":[]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"UnionType","inferredType":{"$type":"InferredType","name":"TypeDefinition"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@6"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"UnionType"},"feature":"types","operator":"+="},{"$type":"Group","elements":[{"$type":"Keyword","value":"|"},{"$type":"Assignment","feature":"types","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@6"},"arguments":[]}}],"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ArrayType","inferredType":{"$type":"InferredType","name":"TypeDefinition"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@7"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ArrayType"},"feature":"elementType","operator":"="},{"$type":"Keyword","value":"["},{"$type":"Keyword","value":"]"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ReferenceType","inferredType":{"$type":"InferredType","name":"TypeDefinition"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@8"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"ReferenceType"}},{"$type":"Keyword","value":"@"},{"$type":"Assignment","feature":"referenceType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@8"},"arguments":[]}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"SimpleType","inferredType":{"$type":"InferredType","name":"TypeDefinition"},"definition":{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]},{"$type":"Keyword","value":")"}]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"SimpleType"}},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"typeRef","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"primitiveType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]}},{"$type":"Assignment","feature":"stringType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}}]}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PrimitiveType","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"string"},{"$type":"Keyword","value":"number"},{"$type":"Keyword","value":"boolean"},{"$type":"Keyword","value":"Date"},{"$type":"Keyword","value":"bigint"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Type","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"type"},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},{"$type":"Keyword","value":"="},{"$type":"Assignment","feature":"type","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@4"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AbstractRule","definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@13"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@47"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"GrammarImport","definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"import"},{"$type":"Assignment","feature":"path","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}},{"$type":"Keyword","value":";","cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParserRule","definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"entry","operator":"?=","terminal":{"$type":"Keyword","value":"entry"}},{"$type":"Assignment","feature":"fragment","operator":"?=","terminal":{"$type":"Keyword","value":"fragment"}}],"cardinality":"?"},{"$type":"RuleCall","rule":{"$ref":"#/rules@15"},"arguments":[]},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"wildcard","operator":"?=","terminal":{"$type":"Keyword","value":"*"}},{"$type":"Group","elements":[{"$type":"Keyword","value":"returns"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"returnType","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"dataType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]}}]}]},{"$type":"Assignment","feature":"inferredType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@14"},"arguments":[{"$type":"NamedArgument","value":{"$type":"LiteralCondition","true":false},"calledByName":false}]}}],"cardinality":"?"},{"$type":"Group","elements":[{"$type":"Assignment","feature":"definesHiddenTokens","operator":"?=","terminal":{"$type":"Keyword","value":"hidden"}},{"$type":"Keyword","value":"("},{"$type":"Group","elements":[{"$type":"Assignment","feature":"hiddenTokens","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"hiddenTokens","operator":"+=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}}],"cardinality":"*"}],"cardinality":"?"},{"$type":"Keyword","value":")"}],"cardinality":"?"},{"$type":"Keyword","value":":"},{"$type":"Assignment","feature":"definition","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}},{"$type":"Keyword","value":";"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"InferredType","parameters":[{"$type":"Parameter","name":"imperative"}],"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Group","guardCondition":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@14/parameters@0"}},"elements":[{"$type":"Keyword","value":"infer"}]},{"$type":"Group","guardCondition":{"$type":"Negation","value":{"$type":"ParameterReference","parameter":{"$ref":"#/rules@14/parameters@0"}}},"elements":[{"$type":"Keyword","value":"infers"}]}]},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"wildcard":false},{"$type":"ParserRule","name":"RuleNameAndParams","fragment":true,"definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"<"},{"$type":"Group","elements":[{"$type":"Assignment","feature":"parameters","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@16"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"parameters","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@16"},"arguments":[]}}],"cardinality":"*"}],"cardinality":"?"},{"$type":"Keyword","value":">"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Parameter","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Alternatives","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Alternatives"},"feature":"elements","operator":"+="},{"$type":"Group","elements":[{"$type":"Keyword","value":"|"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@18"},"arguments":[]}}],"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ConditionalBranch","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@19"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Group"}},{"$type":"Keyword","value":"<"},{"$type":"Assignment","feature":"guardCondition","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}},{"$type":"Keyword","value":">"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@21"},"arguments":[]},"cardinality":"+"}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"UnorderedGroup","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"UnorderedGroup"},"feature":"elements","operator":"+="},{"$type":"Group","elements":[{"$type":"Keyword","value":"&"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@20"},"arguments":[]}}],"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Group","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@21"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Group"},"feature":"elements","operator":"+="},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@21"},"arguments":[]},"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AbstractToken","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@22"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@23"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AbstractTokenWithCardinality","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@38"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@24"},"arguments":[]}]},{"$type":"Assignment","feature":"cardinality","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"?"},{"$type":"Keyword","value":"*"},{"$type":"Keyword","value":"+"}]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Action","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Action"}},{"$type":"Keyword","value":"{"},{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"type","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"inferredType","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@14"},"arguments":[{"$type":"NamedArgument","value":{"$type":"LiteralCondition","true":true},"calledByName":false}]}}]},{"$type":"Group","elements":[{"$type":"Keyword","value":"."},{"$type":"Assignment","feature":"feature","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]}},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"="},{"$type":"Keyword","value":"+="}]}},{"$type":"Keyword","value":"current"}],"cardinality":"?"},{"$type":"Keyword","value":"}"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AbstractTerminal","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@44"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@36"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@37"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@45"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@25"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"EndOfFile","definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"EndOfFile"}},{"$type":"Keyword","value":"EOF"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Keyword","definition":{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RuleCall","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"rule","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":"<"},{"$type":"Assignment","feature":"arguments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"arguments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":">"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NamedArgument","definition":{"$type":"Group","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"parameter","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@16"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Assignment","feature":"calledByName","operator":"?=","terminal":{"$type":"Keyword","value":"="}}],"cardinality":"?"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"LiteralCondition","definition":{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"true","operator":"?=","terminal":{"$type":"Keyword","value":"true"}},{"$type":"Keyword","value":"false"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Disjunction","inferredType":{"$type":"InferredType","name":"Condition"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Disjunction"},"feature":"left","operator":"="},{"$type":"Keyword","value":"|"},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@31"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Conjunction","inferredType":{"$type":"InferredType","name":"Condition"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Conjunction"},"feature":"left","operator":"="},{"$type":"Keyword","value":"&"},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Negation","inferredType":{"$type":"InferredType","name":"Condition"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@33"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Negation"}},{"$type":"Keyword","value":"!"},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@32"},"arguments":[]}}]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Atom","inferredType":{"$type":"InferredType","name":"Condition"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@35"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@34"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@29"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParenthesizedCondition","inferredType":{"$type":"InferredType","name":"Condition"},"definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@30"},"arguments":[]},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParameterReference","definition":{"$type":"Assignment","feature":"parameter","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@16"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PredicatedKeyword","inferredType":{"$type":"InferredType","name":"Keyword"},"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"=>"},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"value","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@61"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PredicatedRuleCall","inferredType":{"$type":"InferredType","name":"RuleCall"},"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"=>"},{"$type":"Keyword","value":"->"}]},{"$type":"Assignment","feature":"rule","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@11"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Keyword","value":"<"},{"$type":"Assignment","feature":"arguments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":","},{"$type":"Assignment","feature":"arguments","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@28"},"arguments":[]}}],"cardinality":"*"},{"$type":"Keyword","value":">"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Assignment","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Assignment"}},{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"=>"},{"$type":"Keyword","value":"->"}],"cardinality":"?"},{"$type":"Assignment","feature":"feature","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@59"},"arguments":[]}},{"$type":"Assignment","feature":"operator","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"+="},{"$type":"Keyword","value":"="},{"$type":"Keyword","value":"?="}]}},{"$type":"Assignment","feature":"terminal","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AssignableTerminal","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@40"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@42"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParenthesizedAssignableElement","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@41"},"arguments":[]},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"AssignableAlternatives","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Alternatives"},"feature":"elements","operator":"+="},{"$type":"Group","elements":[{"$type":"Keyword","value":"|"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@39"},"arguments":[]}}],"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CrossReference","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"CrossReference"}},{"$type":"Keyword","value":"["},{"$type":"Assignment","feature":"type","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/types@0"},"deprecatedSyntax":false}},{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Assignment","feature":"deprecatedSyntax","operator":"?=","terminal":{"$type":"Keyword","value":"|"}},{"$type":"Keyword","value":":"}]},{"$type":"Assignment","feature":"terminal","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@43"},"arguments":[]}}],"cardinality":"?"},{"$type":"Keyword","value":"]"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CrossReferenceableTerminal","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@27"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParenthesizedElement","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"PredicatedGroup","inferredType":{"$type":"InferredType","name":"Group"},"definition":{"$type":"Group","elements":[{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"=>"},{"$type":"Keyword","value":"->"}]},{"$type":"Keyword","value":"("},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@17"},"arguments":[]}},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ReturnType","definition":{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}]}},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalRule","definition":{"$type":"Group","elements":[{"$type":"Assignment","feature":"hidden","operator":"?=","terminal":{"$type":"Keyword","value":"hidden"},"cardinality":"?"},{"$type":"Keyword","value":"terminal"},{"$type":"Alternatives","elements":[{"$type":"Group","elements":[{"$type":"Assignment","feature":"fragment","operator":"?=","terminal":{"$type":"Keyword","value":"fragment"}},{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}}]},{"$type":"Group","elements":[{"$type":"Assignment","feature":"name","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":"returns"},{"$type":"Assignment","feature":"type","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@46"},"arguments":[]}}],"cardinality":"?"}]}]},{"$type":"Keyword","value":":"},{"$type":"Assignment","feature":"definition","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]}},{"$type":"Keyword","value":";"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalAlternatives","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@49"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"TerminalAlternatives"},"feature":"elements","operator":"+="},{"$type":"Keyword","value":"|"},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@49"},"arguments":[]}}],"cardinality":"*"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalGroup","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@50"},"arguments":[]},{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"TerminalGroup"},"feature":"elements","operator":"+="},{"$type":"Assignment","feature":"elements","operator":"+=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@50"},"arguments":[]},"cardinality":"+"}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalToken","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]},{"$type":"Assignment","feature":"cardinality","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"?"},{"$type":"Keyword","value":"*"},{"$type":"Keyword","value":"+"}]},"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalTokenElement","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Alternatives","elements":[{"$type":"RuleCall","rule":{"$ref":"#/rules@58"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@53"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@52"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@54"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@55"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@56"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@57"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"ParenthesizedTerminalElement","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Keyword","value":"("},{"$type":"Assignment","feature":"lookahead","operator":"=","terminal":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"?="},{"$type":"Keyword","value":"?!"}]},"cardinality":"?"},{"$type":"RuleCall","rule":{"$ref":"#/rules@48"},"arguments":[]},{"$type":"Keyword","value":")"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"TerminalRuleCall","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"TerminalRuleCall"}},{"$type":"Assignment","feature":"rule","operator":"=","terminal":{"$type":"CrossReference","type":{"$ref":"#/rules@47"},"terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]},"deprecatedSyntax":false}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"NegatedToken","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"NegatedToken"}},{"$type":"Keyword","value":"!"},{"$type":"Assignment","feature":"terminal","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"UntilToken","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"UntilToken"}},{"$type":"Keyword","value":"->"},{"$type":"Assignment","feature":"terminal","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@51"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"RegexToken","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"RegexToken"}},{"$type":"Assignment","feature":"regex","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@62"},"arguments":[]}}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"Wildcard","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"Wildcard"}},{"$type":"Keyword","value":"."}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"CharacterRange","inferredType":{"$type":"InferredType","name":"AbstractElement"},"definition":{"$type":"Group","elements":[{"$type":"Action","inferredType":{"$type":"InferredType","name":"CharacterRange"}},{"$type":"Assignment","feature":"left","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]}},{"$type":"Group","elements":[{"$type":"Keyword","value":".."},{"$type":"Assignment","feature":"right","operator":"=","terminal":{"$type":"RuleCall","rule":{"$ref":"#/rules@26"},"arguments":[]}}],"cardinality":"?"}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"ParserRule","name":"FeatureName","dataType":"string","definition":{"$type":"Alternatives","elements":[{"$type":"Keyword","value":"current"},{"$type":"Keyword","value":"entry"},{"$type":"Keyword","value":"extends"},{"$type":"Keyword","value":"false"},{"$type":"Keyword","value":"fragment"},{"$type":"Keyword","value":"grammar"},{"$type":"Keyword","value":"hidden"},{"$type":"Keyword","value":"import"},{"$type":"Keyword","value":"interface"},{"$type":"Keyword","value":"returns"},{"$type":"Keyword","value":"terminal"},{"$type":"Keyword","value":"true"},{"$type":"Keyword","value":"type"},{"$type":"Keyword","value":"infer"},{"$type":"Keyword","value":"infers"},{"$type":"Keyword","value":"with"},{"$type":"RuleCall","rule":{"$ref":"#/rules@9"},"arguments":[]},{"$type":"RuleCall","rule":{"$ref":"#/rules@60"},"arguments":[]}]},"definesHiddenTokens":false,"entry":false,"fragment":false,"hiddenTokens":[],"parameters":[],"wildcard":false},{"$type":"TerminalRule","name":"ID","definition":{"$type":"RegexToken","regex":"/\\\\^?[_a-zA-Z][\\\\w_]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"STRING","definition":{"$type":"RegexToken","regex":"/\\"(\\\\\\\\.|[^\\"\\\\\\\\])*\\"|\'(\\\\\\\\.|[^\'\\\\\\\\])*\'/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","name":"RegexLiteral","type":{"$type":"ReturnType","name":"string"},"definition":{"$type":"RegexToken","regex":"/\\\\/(?![*+?])(?:[^\\\\r\\\\n\\\\[/\\\\\\\\]|\\\\\\\\.|\\\\[(?:[^\\\\r\\\\n\\\\]\\\\\\\\]|\\\\\\\\.)*\\\\])+\\\\/[a-z]*/"},"fragment":false,"hidden":false},{"$type":"TerminalRule","hidden":true,"name":"WS","definition":{"$type":"RegexToken","regex":"/\\\\s+/"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"ML_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\//"},"fragment":false},{"$type":"TerminalRule","hidden":true,"name":"SL_COMMENT","definition":{"$type":"RegexToken","regex":"/\\\\/\\\\/[^\\\\n\\\\r]*/"},"fragment":false}],"types":[{"$type":"Type","name":"AbstractType","type":{"$type":"UnionType","types":[{"$type":"SimpleType","typeRef":{"$ref":"#/rules@1"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@10"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@23/definition/elements@0"}},{"$type":"SimpleType","typeRef":{"$ref":"#/rules@13"}}]}}],"definesHiddenTokens":false,"hiddenTokens":[],"imports":[],"interfaces":[],"usedGrammars":[]}'),LanguageMetaData:()=>ni,parser:{ParserConfig:()=>ri}};class si{constructor(e,t,n){var r;this.elements=e,this.outerScope=t,this.caseInsensitive=null!==(r=null==n?void 0:n.caseInsensitive)&&void 0!==r&&r}getAllElements(){return this.outerScope?this.elements.concat(this.outerScope.getAllElements()):this.elements}getElement(e){return(this.caseInsensitive?this.elements.find((t=>t.name.toLowerCase()===e.toLowerCase())):this.elements.find((t=>t.name===e)))||(this.outerScope?this.outerScope.getElement(e):void 0)}}class ai{constructor(e,t,n){var r;this.elements=new Map,this.caseInsensitive=null!==(r=null==n?void 0:n.caseInsensitive)&&void 0!==r&&r;for(const t of e){const e=this.caseInsensitive?t.name.toLowerCase():t.name;this.elements.set(e,t)}this.outerScope=t}getElement(e){const t=this.caseInsensitive?e.toLowerCase():e;return this.elements.get(t)||(this.outerScope?this.outerScope.getElement(e):void 0)}getAllElements(){let e=R(this.elements.values());return this.outerScope&&(e=e.concat(this.outerScope.getAllElements())),e}}const ci={getElement(){},getAllElements:()=>v};class ui{constructor(e){this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider}async computeExports(e,t=Hn.CancellationToken.None){return this.computeExportsForNode(e.parseResult.value,e,void 0,t)}async computeExportsForNode(e,t,n=it,r=Hn.CancellationToken.None){const i=[];this.exportNode(e,i,t);for(const o of n(e))await Yn(r),this.exportNode(o,i,t);return i}exportNode(e,t,n){const r=this.nameProvider.getName(e);r&&t.push(this.descriptions.createDescription(e,r,n))}async computeLocalScopes(e,t=Hn.CancellationToken.None){const n=e.parseResult.value,r=new G;for(const i of ot(n))await Yn(t),this.processNode(i,e,r);return r}processNode(e,t,n){const r=e.$container;if(r){const i=this.nameProvider.getName(e);i&&n.add(r,this.descriptions.createDescription(e,i,t))}}}class li{constructor(){this.toDispose=[],this.isDisposed=!1}onDispose(e){this.toDispose.push(e)}dispose(){this.throwIfDisposed(),this.clear(),this.isDisposed=!0,this.toDispose.forEach((e=>e.dispose()))}throwIfDisposed(){if(this.isDisposed)throw new Error("This cache has already been disposed")}}class di extends li{constructor(){super(...arguments),this.cache=new Map}has(e){return this.throwIfDisposed(),this.cache.has(e)}set(e,t){this.throwIfDisposed(),this.cache.set(e,t)}get(e,t){if(this.throwIfDisposed(),this.cache.has(e))return this.cache.get(e);if(t){const n=t();return this.cache.set(e,n),n}}delete(e){return this.throwIfDisposed(),this.cache.delete(e)}clear(){this.throwIfDisposed(),this.cache.clear()}}class fi extends li{constructor(e){super(),this.cache=new Map,this.converter=null!=e?e:e=>e}has(e,t){return this.throwIfDisposed(),this.cacheForContext(e).has(t)}set(e,t,n){this.throwIfDisposed(),this.cacheForContext(e).set(t,n)}get(e,t,n){this.throwIfDisposed();const r=this.cacheForContext(e);if(r.has(t))return r.get(t);if(n){const e=n();return r.set(t,e),e}}delete(e,t){return this.throwIfDisposed(),this.cacheForContext(e).delete(t)}clear(e){if(this.throwIfDisposed(),e){const t=this.converter(e);this.cache.delete(t)}else this.cache.clear()}cacheForContext(e){const t=this.converter(e);let n=this.cache.get(t);return n||(n=new Map,this.cache.set(t,n)),n}}class pi extends di{constructor(e){super(),this.onDispose(e.workspace.DocumentBuilder.onUpdate((()=>{this.clear()})))}}class hi{constructor(e){this.reflection=e.shared.AstReflection,this.nameProvider=e.references.NameProvider,this.descriptions=e.workspace.AstNodeDescriptionProvider,this.indexManager=e.shared.workspace.IndexManager,this.globalScopeCache=new pi(e.shared)}getScope(e){const t=[],n=this.reflection.getReferenceType(e),r=nt(e.container).precomputedScopes;if(r){let i=e.container;do{const e=r.get(i);e.length>0&&t.push(R(e).filter((e=>this.reflection.isSubtype(e.type,n)))),i=i.$container}while(i)}let i=this.getGlobalScope(n,e);for(let e=t.length-1;e>=0;e--)i=this.createScope(t[e],i);return i}createScope(e,t,n){return new si(R(e),t,n)}createScopeForNodes(e,t,n){const r=R(e).map((e=>{const t=this.nameProvider.getName(e);if(t)return this.descriptions.createDescription(e,t)})).nonNullable();return new si(r,t,n)}getGlobalScope(e,t){return this.globalScopeCache.get(e,(()=>new ai(this.indexManager.allElements(e))))}}class mi extends hi{constructor(e){super(e),this.langiumDocuments=e.shared.workspace.LangiumDocuments}getScope(e){const t=this.reflection.getReferenceType(e);return t===W?this.getTypeScope(t,e):super.getScope(e)}getTypeScope(e,t){let n;const r=nt(t.container).precomputedScopes,i=rt(t.container);if(r&&i){const e=r.get(i);e.length>0&&(n=R(e).filter((e=>e.type===ie||e.type===ke)))}const o=this.getGlobalScope(e,t);return n?this.createScope(n,o):o}getGlobalScope(e,t){const n=tt(t.container,Z);if(!n)return ci;const r=new Set;this.gatherImports(n,r);let i=this.indexManager.allElements(e,r);return e===W&&(i=i.filter((e=>e.type===ie||e.type===ke))),new ai(i)}gatherImports(e,t){for(const n of e.imports){const e=_r(n);if(e&&!t.has(e.toString())&&(t.add(e.toString()),this.langiumDocuments.hasDocument(e))){const n=this.langiumDocuments.getOrCreateDocument(e).parseResult.value;Z(n)&&this.gatherImports(n,t)}}}}class yi extends ui{constructor(e){super(e),this.astNodeLocator=e.workspace.AstNodeLocator}exportNode(e,t,n){var r;if(super.exportNode(e,t,n),fe(e)){if(!e.returnType&&!e.dataType){const i=null!==(r=e.inferredType)&&void 0!==r?r:e;t.push(this.createInterfaceDescription(i,i.name,n))}ot(e).forEach((e=>{if(Ce(e)&&e.inferredType){const r=$r(e);r&&t.push(this.createInterfaceDescription(e,r,n))}}))}}processNode(e,t,n){ye(e)||(this.processTypeNode(e,t,n),this.processActionNode(e,t,n),super.processNode(e,t,n))}processTypeNode(e,t,n){var r;const i=e.$container;if(i&&fe(e)&&!e.returnType&&!e.dataType){const o=null!==(r=e.inferredType)&&void 0!==r?r:e;n.add(i,this.createInterfaceDescription(o,o.name,t))}}processActionNode(e,t,n){const r=rt(e);if(r&&Ce(e)&&e.inferredType){const i=$r(e);i&&n.add(r,this.createInterfaceDescription(e,i,t))}}createInterfaceDescription(e,t,n=nt(e)){let r;const i=()=>{var t;return null!=r?r:r=x(null!==(t=this.nameProvider.getNameNode(e))&&void 0!==t?t:e.$cstNode)};return{node:e,name:t,get nameSegment(){return i()},selectionSegment:x(e.$cstNode),type:"Interface",documentUri:n.uri,path:this.astNodeLocator.getAstNodePath(e)}}}class gi{constructor(e){this.validationRegistry=e.validation.ValidationRegistry,this.metadata=e.LanguageMetaData}async validateDocument(e,t={},n=i.CancellationToken.None){const r=e.parseResult,o=[];if(await Yn(n),!t.categories||t.categories.includes("built-in")){if(this.processLexingErrors(r,o,t),t.stopAfterLexingErrors&&o.some((e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===Ri.LexingError})))return o;if(this.processParsingErrors(r,o,t),t.stopAfterParsingErrors&&o.some((e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===Ri.ParsingError})))return o;if(this.processLinkingErrors(e,o,t),t.stopAfterLinkingErrors&&o.some((e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.code)===Ri.LinkingError})))return o}try{o.push(...await this.validateAst(r.value,t,n))}catch(e){if(Vn(e))throw e;console.error("An error occurred during validation:",e)}return await Yn(n),o}processLexingErrors(e,t,n){for(const n of e.lexerErrors){const e={severity:i.DiagnosticSeverity.Error,range:{start:{line:n.line-1,character:n.column-1},end:{line:n.line-1,character:n.column+n.length-1}},message:n.message,data:Jn(Ri.LexingError),source:this.getSource()};t.push(e)}}processParsingErrors(e,t,n){for(const n of e.parserErrors){let e;if(isNaN(n.token.startOffset)){if("previousToken"in n){const t=n.previousToken;if(isNaN(t.startOffset))e=i.Range.create(0,0,0,0);else{const n=i.Position.create(t.endLine-1,t.endColumn);e=i.Range.create(n,n)}}}else e=$(n.token);if(e){const r={severity:i.DiagnosticSeverity.Error,range:e,message:n.message,data:Jn(Ri.ParsingError),source:this.getSource()};t.push(r)}}}processLinkingErrors(e,t,n){for(const n of e.references){const e=n.error;if(e){const n={node:e.container,property:e.property,index:e.index,data:{code:Ri.LinkingError,containerType:e.container.$type,property:e.property,refText:e.reference.$refText}};t.push(this.toDiagnostic("error",e.message,n))}}}async validateAst(e,t,n=i.CancellationToken.None){const r=[],o=(e,t,n)=>{r.push(this.toDiagnostic(e,t,n))};return await Promise.all(st(e).map((async e=>{await Yn(n);const r=this.validationRegistry.getChecks(e.$type,t.categories);for(const t of r)await t(e,o,n)}))),r}toDiagnostic(e,t,n){return{message:t,range:vi(n),severity:Ti(e),code:n.code,codeDescription:n.codeDescription,tags:n.tags,relatedInformation:n.relatedInformation,data:n.data,source:this.getSource()}}getSource(){return this.metadata.languageId}}function vi(e){if(i.Range.is(e.range))return e.range;let t;return"string"==typeof e.property?t=Ko(e.node.$cstNode,e.property,e.index):"string"==typeof e.keyword&&(t=Wo(e.node.$cstNode,e.keyword,e.index)),null!=t||(t=e.node.$cstNode),t?t.range:{start:{line:0,character:0},end:{line:0,character:0}}}function Ti(e){switch(e){case"error":return i.DiagnosticSeverity.Error;case"warning":return i.DiagnosticSeverity.Warning;case"info":return i.DiagnosticSeverity.Information;case"hint":return i.DiagnosticSeverity.Hint;default:throw new Error("Invalid diagnostic severity: "+e)}}var Ri,ki;!function(e){e.LexingError="lexing-error",e.ParsingError="parsing-error",e.LinkingError="linking-error"}(Ri||(Ri={}));class bi{constructor(e){this.reflection=e.shared.AstReflection,this.indexManager=e.shared.workspace.IndexManager}getCodeActions(e,t){const n=[],r=e=>e&&n.push(e);for(const n of t.context.diagnostics)this.createCodeActions(n,e,r);return n}createCodeActions(e,t,n){var r;switch(null===(r=e.data)||void 0===r?void 0:r.code){case Zn.GrammarNameUppercase:case Zn.RuleNameUppercase:n(this.makeUpperCase(e,t));break;case Zn.HiddenGrammarTokens:n(this.fixHiddenTerminals(e,t));break;case Zn.UseRegexTokens:n(this.fixRegexTokens(e,t));break;case Zn.EntryRuleTokenSyntax:n(this.addEntryKeyword(e,t));break;case Zn.CrossRefTokenSyntax:n(this.fixCrossRefSyntax(e,t));break;case Zn.UnnecessaryFileExtension:n(this.fixUnnecessaryFileExtension(e,t));break;case Zn.MissingReturns:n(this.fixMissingReturns(e,t));break;case Zn.InvalidInfers:case Zn.InvalidReturns:n(this.fixInvalidReturnsInfers(e,t));break;case Zn.MissingInfer:n(this.fixMissingInfer(e,t));break;case Zn.SuperfluousInfer:n(this.fixSuperfluousInfer(e,t));break;case Ri.LinkingError:{const r=e.data;r&&"RuleCall"===r.containerType&&"rule"===r.property&&n(this.addNewRule(e,r,t)),r&&this.lookInGlobalScope(e,r,t).forEach(n);break}}}fixMissingReturns(e,t){const n=t.textDocument.getText(e.range);if(n)return{title:`Add explicit return type for parser rule ${n}`,kind:i.CodeActionKind.QuickFix,diagnostics:[e],edit:{changes:{[t.textDocument.uri]:[{range:e.range,newText:`${n} returns ${n}`}]}}}}fixInvalidReturnsInfers(e,t){const n=e.data;if(n&&n.actionSegment){const r=t.textDocument.getText(n.actionSegment.range);return{title:`Correct ${r} usage`,kind:i.CodeActionKind.QuickFix,diagnostics:[e],edit:{changes:{[t.textDocument.uri]:[{range:n.actionSegment.range,newText:"infers"===r?"returns":"infers"}]}}}}}fixMissingInfer(e,t){const n=e.data;if(n&&n.actionSegment)return{title:"Correct 'infer' usage",kind:i.CodeActionKind.QuickFix,diagnostics:[e],edit:{changes:{[t.textDocument.uri]:[{range:{start:n.actionSegment.range.end,end:n.actionSegment.range.end},newText:"infer "}]}}}}fixSuperfluousInfer(e,t){const n=e.data;if(n&&n.actionRange)return{title:"Remove the 'infer' keyword",kind:i.CodeActionKind.QuickFix,diagnostics:[e],edit:{changes:{[t.textDocument.uri]:[{range:n.actionRange,newText:""}]}}}}fixUnnecessaryFileExtension(e,t){const n=Object.assign({},e.range.end);n.character-=1;const r=Object.assign({},n);return r.character-=8,{title:"Remove file extension",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:[{range:{start:r,end:n},newText:""}]}}}}makeUpperCase(e,t){const n={start:e.range.start,end:{line:e.range.start.line,character:e.range.start.character+1}};return{title:"First letter to upper case",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:[{range:n,newText:t.textDocument.getText(n).toUpperCase()}]}}}}addEntryKeyword(e,t){return{title:"Add entry keyword",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:[{range:{start:e.range.start,end:e.range.start},newText:"entry "}]}}}}fixRegexTokens(e,t){const n=t.textDocument.offsetAt(e.range.start),r=t.parseResult.value.$cstNode;if(r){const o=D(r,n),s=tt(null==o?void 0:o.astNode,Ie);if(s&&s.right&&s.$cstNode){const n=s.left.value,r=s.right.value;return{title:"Refactor into regular expression",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:[{range:s.$cstNode.range,newText:`/[${Mn(n)}-${Mn(r)}]/`}]}}}}}}fixCrossRefSyntax(e,t){return{title:"Replace '|' with ':'",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:[{range:e.range,newText:":"}]}}}}fixHiddenTerminals(e,t){const n=t.parseResult.value,r=n.hiddenTokens,o=[],s=Ko(n.$cstNode,"definesHiddenTokens");if(s){const e=s.range.start,r=s.offset,i=n.$cstNode.text.indexOf(")",r)+1;o.push({newText:"",range:{start:e,end:t.textDocument.positionAt(i)}})}for(const e of r){const t=e.ref;if(t&&Re(t)&&!t.hidden&&t.$cstNode){const e=t.$cstNode.range.start;o.push({newText:"hidden ",range:{start:e,end:e}})}}return{title:"Fix hidden terminals",kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!0,edit:{changes:{[t.textDocument.uri]:o}}}}addNewRule(e,t,n){const r=n.textDocument.offsetAt(e.range.start),o=n.parseResult.value.$cstNode;if(o){const s=D(o,r),a=tt(null==s?void 0:s.astNode,fe);if(a&&a.$cstNode)return{title:`Add new rule '${t.refText}'`,kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!1,edit:{changes:{[n.textDocument.uri]:[{range:{start:a.$cstNode.range.end,end:a.$cstNode.range.end},newText:"\n\n"+t.refText+":\n    /* TODO implement rule */ {infer "+t.refText+"};"}]}}}}}lookInGlobalScope(e,t,n){var r,o;const s={container:{$type:t.containerType},property:t.property,reference:{$refText:t.refText}},a=this.reflection.getReferenceType(s),c=this.indexManager.allElements(a).filter((e=>e.name===t.refText)),u=[];let l=-1,d=-1;for(const t of c){if(Un.equals(t.documentUri,n.uri))continue;const s=wi(n.uri,t.documentUri);let a,c="";const f=n.parseResult.value,p=f.imports.find((e=>e.path&&s<e.path));if(p)a=null===(r=p.$cstNode)||void 0===r?void 0:r.range.start;else if(f.imports.length>0){const e=f.imports[f.imports.length-1].$cstNode.range.end;e&&(a={line:e.line+1,character:0})}else f.rules.length>0&&(a=null===(o=f.rules[0].$cstNode)||void 0===o?void 0:o.range.start,c="\n");a&&((l<0||s.length<d)&&(l=u.length,d=s.length),u.push({title:`Add import to '${s}'`,kind:i.CodeActionKind.QuickFix,diagnostics:[e],isPreferred:!1,edit:{changes:{[n.textDocument.uri]:[{range:{start:a,end:a},newText:`import '${s}'\n${c}`}]}}}))}return l>=0&&(u[l].isPreferred=!0),u}}function wi(e,t){const n=Un.dirname(e);let r=Un.relative(n,t);return r.startsWith("./")||r.startsWith("../")||(r="./"+r),r.endsWith(".langium")&&(r=r.substring(0,r.length-8)),r}function Si(e,t){const n={stacks:e,tokens:t};return function(e){for(const t of e.tokens){const n=Ni(e.stacks,t);e.stacks=n}}(n),n.stacks.flat().forEach((e=>{e.property=void 0})),Ni(n.stacks).map((e=>e[e.length-1]))}function $i(e){const{next:t,cardinalities:n,visited:r,plus:i}=e,o=[],s=t.feature;if(r.has(s))return[];let a;r.add(s);let c=s;for(;c.$container;){if(Fe(c.$container)){a=c.$container;break}if(!z(c.$container))break;c=c.$container}if("*"===(u=c.cardinality)||"+"===u){const e=Ci({next:{feature:c,type:t.type},cardinalities:n,visited:r,plus:i});for(const t of e)i.add(t.feature);o.push(...e)}var u;if(a){const e=a.elements.indexOf(c);void 0!==e&&e<a.elements.length-1&&o.push(...Ai({feature:a,type:t.type},e+1,n,r,i)),o.every((e=>yr(e.feature.cardinality,e.feature)||yr(n.get(e.feature))||i.has(e.feature)))&&o.push(...$i({next:{feature:a,type:t.type},cardinalities:n,visited:r,plus:i}))}return o}function xi(e){return l(e)&&(e={feature:e}),Ci({next:e,cardinalities:new Map,visited:new Set,plus:new Set})}function Ci(e){var t,n,r;const{next:i,cardinalities:o,visited:s,plus:a}=e;if(void 0===i)return[];const{feature:c,type:u}=i;if(Fe(c)){if(s.has(c))return[];s.add(c)}if(Fe(c))return Ai(i,0,o,s,a).map((e=>Ei(e,c.cardinality,o)));if(Ae(c)||Xe(c))return c.elements.flatMap((e=>Ci({next:{feature:e,type:u,property:i.property},cardinalities:o,visited:s,plus:a}))).map((e=>Ei(e,c.cardinality,o)));if(De(c))return Ci({next:{feature:c.terminal,type:u,property:null!==(t=i.property)&&void 0!==t?t:c.feature},cardinalities:o,visited:s,plus:a}).map((e=>Ei(e,c.cardinality,o)));if(Ce(c))return $i({next:{feature:c,type:br(c),property:null!==(n=i.property)&&void 0!==n?n:c.feature},cardinalities:o,visited:s,plus:a});if(He(c)&&fe(c.rule.ref)){const e=c.rule.ref;return Ci({next:{feature:e.definition,type:e.fragment||e.dataType?void 0:null!==(r=Sr(e))&&void 0!==r?r:e.name,property:i.property},cardinalities:o,visited:s,plus:a}).map((e=>Ei(e,c.cardinality,o)))}return[i]}function Ei(e,t,n){return n.set(e.feature,t),e}function Ai(e,t,n,r,i){var o;const s=[];let a;for(;t<e.feature.elements.length&&(a={feature:e.feature.elements[t++],type:e.type},s.push(...Ci({next:a,cardinalities:n,visited:r,plus:i})),yr(null!==(o=a.feature.cardinality)&&void 0!==o?o:n.get(a.feature),a.feature)););return s}function Ni(e,t){const n=[];for(const r of e)n.push(...Di(r,t));return n}function Di(e,t){const n=new Map,r=new Set(e.map((e=>e.feature)).filter(_i)),i=[];for(;e.length>0;){const o=$i({next:e.pop(),cardinalities:n,plus:r,visited:new Set}).filter((e=>!t||Ii(e.feature,t)));for(const t of o)i.push([...e,t]);if(!o.every((e=>yr(e.feature.cardinality,e.feature)||yr(n.get(e.feature)))))break}return i}function _i(e){if("+"===e.cardinality)return!0;const t=tt(e,De);return!(!t||"+"!==t.cardinality)}function Ii(e,t){if(qe(e))return e.value===t.image;if(He(e))return function(e,t){return fe(e)?xi(e.definition).some((e=>Ii(e.feature,t))):!!Re(e)&&Cr(e).test(t.image)}(e.rule.ref,t);if(Oe(e)){const n=qo(e);if(n)return Ii(n,t)}return!1}class Pi{constructor(e){this.scopeProvider=e.references.ScopeProvider,this.grammar=e.Grammar,this.completionParser=e.parser.CompletionParser,this.nameProvider=e.references.NameProvider,this.lexer=e.parser.Lexer,this.nodeKindProvider=e.shared.lsp.NodeKindProvider,this.fuzzyMatcher=e.shared.lsp.FuzzyMatcher,this.grammarConfig=e.parser.GrammarConfig,this.astReflection=e.shared.AstReflection}async getCompletion(e,t){const n=[],r=this.buildContexts(e,t.position),o=(e,t)=>{const r=this.fillCompletionItem(e,t);r&&n.push(r)},s=e=>qe(e.feature)?e.feature.value:e.feature,a=[];for(const e of r)if(await Promise.all(R(e.features).distinct(s).exclude(a).map((t=>this.completionFor(e,t,o)))),a.push(...e.features),!this.continueCompletion(n))break;return i.CompletionList.create(this.deduplicateItems(n),!0)}deduplicateItems(e){return R(e).distinct((e=>`${e.kind}_${e.label}_${e.detail}`)).toArray()}findFeaturesAt(e,t){const n=e.getText({start:i.Position.create(0,0),end:e.positionAt(t)}),r=this.completionParser.parse(n),o=r.tokens;if(0===r.tokenIndex){const e=Mo(this.grammar),t=xi({feature:e.definition,type:Sr(e)});return o.length>0?(o.shift(),Si(t.map((e=>[e])),o)):t}const s=[...o].splice(r.tokenIndex);return Si([r.elementStack.map((e=>({feature:e})))],s)}*buildContexts(e,t){var n,r;const i=e.parseResult.value.$cstNode;if(!i)return;const o=e.textDocument,s=o.getText(),a=o.offsetAt(t),c={document:e,textDocument:o,offset:a,position:t},u=this.findDataTypeRuleStart(i,a);if(u){const[e,t]=u,r=null===(n=_(i,e))||void 0===n?void 0:n.astNode;yield Object.assign(Object.assign({},c),{node:r,tokenOffset:e,tokenEndOffset:t,features:this.findFeaturesAt(o,e)})}const{nextTokenStart:l,nextTokenEnd:d,previousTokenStart:f,previousTokenEnd:p}=this.backtrackToAnyToken(s,a);let h=l;a<=l&&void 0!==f&&(h=f);const m=null===(r=_(i,h))||void 0===r?void 0:r.astNode;let y=!0;if(void 0!==f&&void 0!==p&&p===a&&(yield Object.assign(Object.assign({},c),{node:m,tokenOffset:f,tokenEndOffset:p,features:this.findFeaturesAt(o,f)}),y=this.performNextTokenCompletion(e,s.substring(f,p),f,p),y&&(yield Object.assign(Object.assign({},c),{node:m,tokenOffset:p,tokenEndOffset:p,features:this.findFeaturesAt(o,p)}))),m)y&&(yield Object.assign(Object.assign({},c),{node:m,tokenOffset:l,tokenEndOffset:d,features:this.findFeaturesAt(o,l)}));else{const e=Mo(this.grammar);if(!e)throw new Error("Missing entry parser rule");yield Object.assign(Object.assign({},c),{tokenOffset:l,tokenEndOffset:d,features:xi(e.definition)})}}performNextTokenCompletion(e,t,n,r){return/\P{L}$/u.test(t)}findDataTypeRuleStart(e,t){var n,r;let i=A(e,t,this.grammarConfig.nameRegexp),o=Boolean(null===(n=tt(null==i?void 0:i.grammarSource,fe))||void 0===n?void 0:n.dataType);if(o){for(;o;)i=null==i?void 0:i.container,o=Boolean(null===(r=tt(null==i?void 0:i.grammarSource,fe))||void 0===r?void 0:r.dataType);if(i)return[i.offset,i.end]}}continueCompletion(e){return 0===e.length}backtrackToAnyToken(e,t){const n=this.lexer.tokenize(e).tokens;if(0===n.length)return{nextTokenStart:t,nextTokenEnd:t};let r;for(const e of n){if(e.startOffset>=t)return{nextTokenStart:t,nextTokenEnd:t,previousTokenStart:r?r.startOffset:void 0,previousTokenEnd:r?r.endOffset+1:void 0};if(e.endOffset>=t)return{nextTokenStart:e.startOffset,nextTokenEnd:e.endOffset+1,previousTokenStart:r?r.startOffset:void 0,previousTokenEnd:r?r.endOffset+1:void 0};r=e}return{nextTokenStart:t,nextTokenEnd:t,previousTokenStart:r?r.startOffset:void 0,previousTokenEnd:r?r.endOffset+1:void 0}}completionFor(e,t,n){return qe(t.feature)?this.completionForKeyword(e,t.feature,n):Oe(t.feature)&&e.node?this.completionForCrossReference(e,t,n):void 0}completionForCrossReference(e,t,n){const r=tt(t.feature,De);let i=e.node;if(r&&i){t.type&&(i={$type:t.type,$container:i,$containerProperty:t.property},ut(this.astReflection,i));const o={reference:{$refText:""},container:i,property:r.feature};try{this.scopeProvider.getScope(o).getAllElements().forEach((t=>{this.filterCrossReference(e,t)&&n(e,this.createReferenceCompletionItem(t))}))}catch(e){console.error(e)}}}createReferenceCompletionItem(e){return{nodeDescription:e,kind:this.nodeKindProvider.getCompletionItemKind(e),detail:e.type,sortText:"0"}}filterCrossReference(e,t){return!0}completionForKeyword(e,t,n){this.filterKeyword(e,t)&&n(e,{label:t.value,kind:i.CompletionItemKind.Keyword,detail:"Keyword",sortText:"1"})}filterKeyword(e,t){return/\p{L}/u.test(t.value)}fillCompletionItem(e,t){var n,r;let i,o;if("string"==typeof t.label)i=t.label;else if("node"in t){const e=this.nameProvider.getName(t.node);if(!e)return;i=e}else{if(!("nodeDescription"in t))return;i=t.nodeDescription.name}o="string"==typeof(null===(n=t.textEdit)||void 0===n?void 0:n.newText)?t.textEdit.newText:"string"==typeof t.insertText?t.insertText:i;const s=null!==(r=t.textEdit)&&void 0!==r?r:this.buildCompletionTextEdit(e,i,o);if(s)return{additionalTextEdits:t.additionalTextEdits,command:t.command,commitCharacters:t.commitCharacters,data:t.data,detail:t.detail,documentation:t.documentation,filterText:t.filterText,insertText:t.insertText,insertTextFormat:t.insertTextFormat,insertTextMode:t.insertTextMode,kind:t.kind,labelDetails:t.labelDetails,preselect:t.preselect,sortText:t.sortText,tags:t.tags,textEditText:t.textEditText,textEdit:s,label:i}}buildCompletionTextEdit(e,t,n){const r=e.textDocument.getText().substring(e.tokenOffset,e.offset);if(this.fuzzyMatcher.match(r,t))return{newText:n,range:{start:e.textDocument.positionAt(e.tokenOffset),end:e.position}}}}class Oi extends Pi{constructor(e){super(e),this.documents=()=>e.shared.workspace.LangiumDocuments}completionFor(e,t,n){const r=tt(t.feature,De);if("path"!==(null==r?void 0:r.feature))return super.completionFor(e,t,n);this.completeImportPath(e,n)}completeImportPath(e,t){const n=e.textDocument.getText().substring(e.tokenOffset,e.offset);let r=this.getAllFiles(e.document),i={start:e.position,end:e.position};if(n.length>0){const t=n.substring(1);r=r.filter((e=>e.startsWith(t))),i={start:e.textDocument.positionAt(e.tokenOffset+1),end:e.textDocument.positionAt(e.tokenEndOffset-1)}}for(const o of r){const r=n.length>0?"":'"';t(e,{label:o,textEdit:{newText:`${r}${o}${r}`,range:i},kind:Gn.CompletionItemKind.File,sortText:"0"})}}getAllFiles(e){const t=this.documents().all,n=e.uri.toString(),r=Un.dirname(e.uri).toString(),i=[];for(const e of t)if(!Un.equals(e.uri,n)){const t=e.uri.toString(),n=t.substring(0,t.length-Un.extname(e.uri).length);let o=Un.relative(r,n);o.startsWith(".")||(o=`./${o}`),i.push(o)}return i}}class Li{constructor(e){this.commentNames=e.parser.GrammarConfig.multilineCommentRules}getFoldingRanges(e){const t=[];return this.collectFolding(e,(e=>t.push(e))),t}collectFolding(e,t){var n;const r=null===(n=e.parseResult)||void 0===n?void 0:n.value;if(r){if(this.shouldProcessContent(r)){const n=ot(r).iterator();let i;do{if(i=n.next(),!i.done){const r=i.value;this.shouldProcess(r)&&this.collectObjectFolding(e,r,t),this.shouldProcessContent(r)||n.prune()}}while(!i.done)}this.collectCommentFolding(e,r,t)}}shouldProcess(e){return!0}shouldProcessContent(e){return!0}collectObjectFolding(e,t,n){const r=t.$cstNode;if(r){const t=this.toFoldingRange(e,r);t&&n(t)}}collectCommentFolding(e,t,n){const r=t.$cstNode;if(r)for(const t of function(e){return S(e).filter(m)}(r))if(this.commentNames.includes(t.tokenType.name)){const r=this.toFoldingRange(e,t,i.FoldingRangeKind.Comment);r&&n(r)}}toFoldingRange(e,t,n){const r=t.range,o=r.start;let s=r.end;if(!(s.line-o.line<2))return this.includeLastFoldingLine(t,n)||(s=e.textDocument.positionAt(e.textDocument.offsetAt({line:s.line,character:0})-1)),i.FoldingRange.create(o.line,s.line,o.character,s.character,n)}includeLastFoldingLine(e,t){if(t===i.FoldingRangeKind.Comment)return!1;const n=e.text,r=n.charAt(n.length-1);return"}"!==r&&")"!==r&&"]"!==r}}class Mi extends Li{shouldProcessContent(e){return!fe(e)}}class Fi{constructor(){this.collector=()=>{}}getNodeFormatter(e){return new ji(e,this.collector)}formatDocument(e,t){const n=e.parseResult;return 0===n.lexerErrors.length&&0===n.parserErrors.length?this.doDocumentFormat(e,t.options):[]}isFormatRangeErrorFree(e,t){const n=e.parseResult;if(n.lexerErrors.length||n.parserErrors.length){const e=Math.min(...n.lexerErrors.map((e=>{var t;return null!==(t=e.line)&&void 0!==t?t:Number.MAX_VALUE})),...n.parserErrors.map((e=>{var t;return null!==(t=e.token.startLine)&&void 0!==t?t:Number.MAX_VALUE})));return e>t.end.line}return!0}formatDocumentRange(e,t){return this.isFormatRangeErrorFree(e,t.range)?this.doDocumentFormat(e,t.options,t.range):[]}formatDocumentOnType(e,t){const n={start:{character:0,line:t.position.line},end:t.position};return this.isFormatRangeErrorFree(e,n)?this.doDocumentFormat(e,t.options,n):[]}get formatOnTypeOptions(){}doDocumentFormat(e,t,n){const r=new Map;this.collector=(e,t,n)=>{var i,o;const s=this.nodeModeToKey(e,t),a=r.get(s),c=null!==(i=n.options.priority)&&void 0!==i?i:0,u=null!==(o=null==a?void 0:a.options.priority)&&void 0!==o?o:0;(!a||u<=c)&&r.set(s,n)},this.iterateAstFormatting(e,n);const i=this.iterateCstFormatting(e,r,t,n);return this.avoidOverlappingEdits(e.textDocument,i)}avoidOverlappingEdits(e,t){const n=[];for(const r of t){const t=n[n.length-1];t&&e.offsetAt(r.range.start)<e.offsetAt(t.range.end)&&n.pop(),n.push(r)}return n}iterateAstFormatting(e,t){const n=e.parseResult.value;this.format(n);const r=ot(n).iterator();let i;do{if(i=r.next(),!i.done){const e=i.value;this.insideRange(e.$cstNode.range,t)?this.format(e):r.prune()}}while(!i.done)}nodeModeToKey(e,t){return`${e.offset}:${e.end}:${t}`}insideRange(e,t){return!t||e.start.line<=t.start.line&&e.end.line>=t.end.line||e.start.line>=t.start.line&&e.end.line<=t.end.line||e.start.line<=t.end.line&&e.end.line>=t.end.line}isNecessary(e,t){return t.getText(e.range)!==e.newText}iterateCstFormatting(e,t,n,r){const i={indentation:0,options:n,document:e.textDocument},o=[],s=this.iterateCstTree(e,i).iterator();let a,c;do{if(c=s.next(),!c.done){const n=c.value,s=m(n),u=this.nodeModeToKey(n,"prepend"),l=t.get(u);if(t.delete(u),l){const t=this.createTextEdit(a,n,l,i);for(const n of t)n&&this.insideRange(n.range,r)&&this.isNecessary(n,e.textDocument)&&o.push(n)}const d=this.nodeModeToKey(n,"append"),f=t.get(d);if(t.delete(d),f){const t=P(n);if(t){const s=this.createTextEdit(n,t,f,i);for(const t of s)t&&this.insideRange(t.range,r)&&this.isNecessary(t,e.textDocument)&&o.push(t)}}if(!l&&n.hidden){const t=this.createHiddenTextEdits(a,n,void 0,i);for(const n of t)n&&this.insideRange(n.range,r)&&this.isNecessary(n,e.textDocument)&&o.push(n)}s&&(a=n)}}while(!c.done);return o}createHiddenTextEdits(e,t,n,r){var i;const o=t.range.start.line;if(e&&e.range.end.line===o)return[];const s=[],a={start:{character:0,line:o},end:t.range.start},c=r.document.getText(a),u=this.findFittingMove(a,null!==(i=null==n?void 0:n.moves)&&void 0!==i?i:[],r),l=this.getExistingIndentationCharacterCount(c,r),d=this.getIndentationCharacterCount(r,u)-l;if(0===d)return[];let f="";d>0&&(f=(r.options.insertSpaces?" ":"\t").repeat(d));const p=t.text.split("\n");p[0]=c+p[0];for(let e=0;e<p.length;e++){const t=o+e,n={character:0,line:t};if(d>0)s.push({newText:f,range:{start:n,end:n}});else{const r=p[e];let i=0;for(;i<r.length;i++){const e=r.charAt(i);if(" "!==e&&"\t"!==e)break}s.push({newText:"",range:{start:n,end:{line:t,character:Math.min(i,Math.abs(d))}}})}}return s}getExistingIndentationCharacterCount(e,t){const n=" ".repeat(t.options.tabSize);return(t.options.insertSpaces?e.replaceAll("\t",n):e.replaceAll(n,"\t")).length}getIndentationCharacterCount(e,t){let n=e.indentation;return t&&t.tabs&&(n+=t.tabs),(e.options.insertSpaces?e.options.tabSize:1)*n}createTextEdit(e,t,n,r){var i;if(t.hidden)return this.createHiddenTextEdits(e,t,n,r);const o={start:null!==(i=null==e?void 0:e.range.end)&&void 0!==i?i:{character:0,line:0},end:t.range.start},s=this.findFittingMove(o,n.moves,r);if(!s)return[];const a=s.characters,c=s.lines,u=s.tabs,l=r.indentation;r.indentation+=null!=u?u:0;const d=[];return void 0!==a?d.push(this.createSpaceTextEdit(o,a,n.options)):void 0!==c?d.push(this.createLineTextEdit(o,c,r,n.options)):void 0!==u&&d.push(this.createTabTextEdit(o,Boolean(e),r)),m(t)&&(r.indentation=l),d}createSpaceTextEdit(e,t,n){if(e.start.line===e.end.line){const r=e.end.character-e.start.character;t=this.fitIntoOptions(t,r,n)}return{newText:" ".repeat(t),range:e}}createLineTextEdit(e,t,n,r){const i=e.end.line-e.start.line;t=this.fitIntoOptions(t,i,r);const o=(n.options.insertSpaces?" ".repeat(n.options.tabSize):"\t").repeat(n.indentation);return{newText:`${"\n".repeat(t)}${o}`,range:e}}createTabTextEdit(e,t,n){const r=(n.options.insertSpaces?" ".repeat(n.options.tabSize):"\t").repeat(n.indentation),i=t?1:0,o=Math.max(e.end.line-e.start.line,i);return{newText:`${"\n".repeat(o)}${r}`,range:e}}fitIntoOptions(e,t,n){return n.allowMore?e=Math.max(t,e):n.allowLess&&(e=Math.min(t,e)),e}findFittingMove(e,t,n){if(0===t.length)return;if(1===t.length)return t[0];const r=e.end.line-e.start.line;for(const e of t){if(void 0!==e.lines&&r<=e.lines)return e;if(void 0===e.lines&&0===r)return e}return t[t.length-1]}iterateCstTree(e,t){const n=e.parseResult.value.$cstNode;return n?new k(n,(e=>this.iterateCst(e,t))):v}iterateCst(e,t){if(!h(e))return v;const n=t.indentation;return new y((()=>({index:0})),(r=>r.index<e.content.length?{done:!1,value:e.content[r.index++]}:(t.indentation=n,T)))}}class ji{constructor(e,t){this.astNode=e,this.collector=t}node(e){return new qi(e.$cstNode?[e.$cstNode]:[],this.collector)}nodes(...e){const t=[];for(const n of e)n.$cstNode&&t.push(n.$cstNode);return new qi(t,this.collector)}property(e,t){const n=Ko(this.astNode.$cstNode,e,t);return new qi(n?[n]:[],this.collector)}properties(...e){const t=[];for(const n of e){const e=Uo(this.astNode.$cstNode,n);t.push(...e)}return new qi(t,this.collector)}keyword(e,t){const n=Wo(this.astNode.$cstNode,e,t);return new qi(n?[n]:[],this.collector)}keywords(...e){const t=[];for(const n of e){const e=Ho(this.astNode.$cstNode,n);t.push(...e)}return new qi(t,this.collector)}cst(e){return new qi([...e],this.collector)}interior(e,t){const n=e.nodes,r=t.nodes;if(1!==n.length||1!==r.length)return new qi([],this.collector);let i=n[0],o=r[0];if(i.offset>o.offset){const e=i;i=o,o=e}return new qi(function(e,t){const n=function(e,t){const n=O(e),r=O(t);let i;for(let e=0;e<n.length&&e<r.length;e++){const t=n[e],o=r[e];if(t.parent!==o.parent)break;i={parent:t.parent,a:t.index,b:o.index}}return i}(e,t);return n?n.parent.content.slice(n.a+1,n.b):[]}(i,o),this.collector)}}class qi{constructor(e,t){this.nodes=e,this.collector=t}prepend(e){for(const t of this.nodes)this.collector(t,"prepend",e);return this}append(e){for(const t of this.nodes)this.collector(t,"append",e);return this}surround(e){for(const t of this.nodes)this.collector(t,"prepend",e),this.collector(t,"append",e);return this}slice(e,t){return new qi(this.nodes.slice(e,t),this.collector)}}!function(e){function t(e,t){return{options:null!=t?t:{},moves:[{characters:e}]}}function n(e,t){return{options:null!=t?t:{},moves:[{lines:e}]}}function r(e,t){var n,r,i,o,s,a;const c=null!==(n=e.lines)&&void 0!==n?n:0,u=null!==(r=t.lines)&&void 0!==r?r:0,l=null!==(i=e.tabs)&&void 0!==i?i:0,d=null!==(o=t.tabs)&&void 0!==o?o:0,f=null!==(s=e.characters)&&void 0!==s?s:0,p=null!==(a=t.characters)&&void 0!==a?a:0;return c<u?-1:c>u?1:l<d?-1:l>d?1:f<p?-1:f>p?1:0}e.fit=function(...e){return{options:{},moves:e.flatMap((e=>e.moves)).sort(r)}},e.noSpace=function(e){return t(0,e)},e.oneSpace=function(e){return t(1,e)},e.spaces=t,e.newLine=function(e){return n(1,e)},e.newLines=n,e.indent=function(e){return{options:null!=e?e:{},moves:[{tabs:1,lines:1}]}},e.noIndent=function(e){return{options:null!=e?e:{},moves:[{tabs:0}]}}}(ki||(ki={}));const Ui=ki.fit(ki.oneSpace(),ki.indent());class Ki extends Fi{format(e){if(Oe(e))this.getNodeFormatter(e).properties("type","terminal").surround(ki.noSpace());else if(fe(e)){const t=this.getNodeFormatter(e);t.keywords("entry","fragment","returns").append(ki.oneSpace()),(e.inferredType||e.returnType||e.dataType)&&0===e.parameters.length?t.property("name").append(ki.oneSpace()):t.property("name").append(ki.noSpace()),t.properties("parameters").append(ki.noSpace()),t.keywords(",").append(ki.oneSpace()),t.keywords("<").append(ki.noSpace());const n=t.keyword(";"),r=t.keyword(":");r.prepend(ki.noSpace()),t.interior(r,n).prepend(ki.indent()),n.prepend(ki.fit(ki.noSpace(),ki.newLine())),t.node(e).prepend(ki.noIndent())}else if(Re(e)){const t=this.getNodeFormatter(e);e.type&&(t.property("name").append(ki.oneSpace()),t.keyword("returns").append(ki.oneSpace())),t.keywords("hidden","terminal","fragment").append(ki.oneSpace()),t.keyword(":").prepend(ki.noSpace()),t.keyword(";").prepend(ki.fit(ki.noSpace(),ki.newLine())),t.node(e).prepend(ki.noIndent())}else if(Ce(e)){const t=this.getNodeFormatter(e);t.keyword("{").append(ki.noSpace()),t.keywords(".","+=","=").surround(ki.noSpace()),t.keyword("}").prepend(ki.noSpace())}else if(re(e))this.getNodeFormatter(e).keywords("infer","infers").append(ki.oneSpace());else if(De(e))this.getNodeFormatter(e).keywords("=","+=","?=").surround(ki.noSpace());else if(He(e)){const t=this.getNodeFormatter(e);t.keyword("<").surround(ki.noSpace()),t.keyword(",").append(ki.oneSpace()),t.properties("arguments").append(ki.noSpace())}else if(oe(e)){const t=this.getNodeFormatter(e);t.keyword("interface").append(ki.oneSpace()),t.keyword("extends").prepend(ki.oneSpace()).append(Ui),t.keywords(",").prepend(ki.noSpace()).append(Ui);const n=t.keyword("{");n.prepend(ki.fit(ki.oneSpace(),ki.newLine()));const r=t.keyword("}");r.prepend(ki.newLine()),t.interior(n,r).prepend(ki.indent())}else if(be(e)){const t=this.getNodeFormatter(e);t.keyword("type").append(ki.oneSpace()),t.keyword("=").prepend(ki.oneSpace()).append(Ui),t.keyword(";").prepend(ki.noSpace()).append(ki.newLine())}else if(Z(e)){const t=this.getNodeFormatter(e);t.nodes(...e.rules,...e.interfaces,...e.types,...e.imports).prepend(ki.noIndent()),t.keyword("grammar").prepend(ki.noSpace()).append(ki.oneSpace())}z(e)&&this.getNodeFormatter(e).property("cardinality").prepend(ki.noSpace())}}const Gi={[i.SemanticTokenTypes.class]:0,[i.SemanticTokenTypes.comment]:1,[i.SemanticTokenTypes.enum]:2,[i.SemanticTokenTypes.enumMember]:3,[i.SemanticTokenTypes.event]:4,[i.SemanticTokenTypes.function]:5,[i.SemanticTokenTypes.interface]:6,[i.SemanticTokenTypes.keyword]:7,[i.SemanticTokenTypes.macro]:8,[i.SemanticTokenTypes.method]:9,[i.SemanticTokenTypes.modifier]:10,[i.SemanticTokenTypes.namespace]:11,[i.SemanticTokenTypes.number]:12,[i.SemanticTokenTypes.operator]:13,[i.SemanticTokenTypes.parameter]:14,[i.SemanticTokenTypes.property]:15,[i.SemanticTokenTypes.regexp]:16,[i.SemanticTokenTypes.string]:17,[i.SemanticTokenTypes.struct]:18,[i.SemanticTokenTypes.type]:19,[i.SemanticTokenTypes.typeParameter]:20,[i.SemanticTokenTypes.variable]:21,[i.SemanticTokenTypes.decorator]:22},Hi={[i.SemanticTokenModifiers.abstract]:1,[i.SemanticTokenModifiers.async]:2,[i.SemanticTokenModifiers.declaration]:4,[i.SemanticTokenModifiers.defaultLibrary]:8,[i.SemanticTokenModifiers.definition]:16,[i.SemanticTokenModifiers.deprecated]:32,[i.SemanticTokenModifiers.documentation]:64,[i.SemanticTokenModifiers.modification]:128,[i.SemanticTokenModifiers.readonly]:256,[i.SemanticTokenModifiers.static]:512},Wi={legend:{tokenTypes:Object.keys(Gi),tokenModifiers:Object.keys(Hi)},full:{delta:!0},range:!0};class Bi extends i.SemanticTokensBuilder{constructor(){super(...arguments),this._tokens=[]}push(e,t,n,r,i){this._tokens.push({line:e,char:t,length:n,tokenType:r,tokenModifiers:i})}build(){return this.applyTokens(),super.build()}buildEdits(){return this.applyTokens(),super.buildEdits()}flush(){this.previousResult(this.id)}applyTokens(){for(const e of this._tokens.sort(this.compareTokens))super.push(e.line,e.char,e.length,e.tokenType,e.tokenModifiers);this._tokens=[]}compareTokens(e,t){return e.line===t.line?e.char-t.char:e.line-t.line}}class zi{constructor(e){this.tokensBuilders=new Map,e.shared.workspace.TextDocuments.onDidClose((e=>{this.tokensBuilders.delete(e.document.uri)})),e.shared.lsp.LanguageServer.onInitialize((e=>{var t;this.initialize(null===(t=e.capabilities.textDocument)||void 0===t?void 0:t.semanticTokens)}))}initialize(e){this.clientCapabilities=e}async semanticHighlight(e,t,n=i.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),n),this.currentTokensBuilder.build()}async semanticHighlightRange(e,t,n=i.CancellationToken.None){return this.currentRange=t.range,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.flush(),await this.computeHighlighting(e,this.createAcceptor(),n),this.currentTokensBuilder.build()}async semanticHighlightDelta(e,t,n=i.CancellationToken.None){return this.currentRange=void 0,this.currentDocument=e,this.currentTokensBuilder=this.getDocumentTokensBuilder(e),this.currentTokensBuilder.previousResult(t.previousResultId),await this.computeHighlighting(e,this.createAcceptor(),n),this.currentTokensBuilder.buildEdits()}createAcceptor(){return e=>{"line"in e?this.highlightToken({range:{start:{line:e.line,character:e.char},end:{line:e.line,character:e.char+e.length}},type:e.type,modifier:e.modifier}):"range"in e?this.highlightToken(e):"keyword"in e?this.highlightKeyword(e):"property"in e?this.highlightProperty(e):this.highlightNode({node:e.cst,type:e.type,modifier:e.modifier})}}getDocumentTokensBuilder(e){const t=this.tokensBuilders.get(e.uri.toString());if(t)return t;const n=new Bi;return this.tokensBuilders.set(e.uri.toString(),n),n}async computeHighlighting(e,t,n){const r=st(e.parseResult.value,{range:this.currentRange}).iterator();let i;do{if(i=r.next(),!i.done){await Yn(n);const e=i.value;"prune"===this.highlightElement(e,t)&&r.prune()}}while(!i.done)}highlightToken(e){var t;const{range:n,type:r}=e;let i=e.modifier;if(this.currentRange&&!C(n,this.currentRange)||!this.currentDocument||!this.currentTokensBuilder)return;const o=Gi[r];let s=0;if(void 0!==i){"string"==typeof i&&(i=[i]);for(const e of i)s|=Hi[e]}const a=n.start.line,c=n.end.line;if(a===c){const e=n.start.character,t=n.end.character-e;this.currentTokensBuilder.push(a,e,t,o,s)}else if(null===(t=this.clientCapabilities)||void 0===t?void 0:t.multilineTokenSupport){const e=n.start.character,t=this.currentDocument.textDocument.offsetAt(n.start),r=this.currentDocument.textDocument.offsetAt(n.end);this.currentTokensBuilder.push(a,e,r-t,o,s)}else{const e=n.start;let t=this.currentDocument.textDocument.offsetAt({line:a+1,character:0});this.currentTokensBuilder.push(e.line,e.character,t-e.character-1,o,s);for(let e=a+1;e<c;e++){const n=t;t=this.currentDocument.textDocument.offsetAt({line:e+1,character:0}),this.currentTokensBuilder.push(e,0,t-n-1,o,s)}this.currentTokensBuilder.push(c,0,n.end.character,o,s)}}highlightProperty(e){const t=[];if("number"==typeof e.index){const n=Ko(e.node.$cstNode,e.property,e.index);n&&t.push(n)}else t.push(...Uo(e.node.$cstNode,e.property));const{type:n,modifier:r}=e;for(const e of t)this.highlightNode({node:e,type:n,modifier:r})}highlightKeyword(e){const{node:t,keyword:n,type:r,index:i,modifier:o}=e,s=[];if("number"==typeof i){const e=Wo(t.$cstNode,n,i);e&&s.push(e)}else s.push(...Ho(t.$cstNode,n));for(const e of s)this.highlightNode({node:e,type:r,modifier:o})}highlightNode(e){const{node:t,type:n,modifier:r}=e,i=t.range;this.highlightToken({range:i,type:n,modifier:r})}}var Vi;!function(e){e.decode=function(e,t){const n=new Map;Object.entries(Gi).forEach((([e,t])=>n.set(t,e)));let r=0,i=0;return function(e,t){const n=[];for(let t=0;t<e.length;t+=5){const r=e.slice(t,t+5);n.push(r)}return n}(e.data).map((e=>{r+=e[0],0!==e[0]&&(i=0),i+=e[1];const o=e[2];return{offset:t.textDocument.offsetAt({line:r,character:i}),tokenType:n.get(e[3]),tokenModifiers:e[4],text:t.textDocument.getText({start:{line:r,character:i},end:{line:r,character:i+o}})}}))}}(Vi||(Vi={}));class Yi extends zi{highlightElement(e,t){var n,r;De(e)?t({node:e,property:"feature",type:i.SemanticTokenTypes.property}):Ce(e)?e.feature&&t({node:e,property:"feature",type:i.SemanticTokenTypes.property}):ye(e)?t({node:e,property:"name",type:i.SemanticTokenTypes.type}):ve(e)?(e.primitiveType||e.typeRef)&&t({node:e,property:e.primitiveType?"primitiveType":"typeRef",type:i.SemanticTokenTypes.type}):(r=e,et.isInstance(r,ce)?t({node:e,property:"name",type:i.SemanticTokenTypes.parameter}):le(e)?t({node:e,property:"parameter",type:i.SemanticTokenTypes.parameter}):He(e)?(null===(n=e.rule.ref)||void 0===n?void 0:n.fragment)&&t({node:e,property:"rule",type:i.SemanticTokenTypes.type}):we(e)&&t({node:e,property:"name",type:i.SemanticTokenTypes.property}))}}class Xi extends vn{getName(e){return De(e)?e.feature:super.getName(e)}getNameNode(e){return De(e)?Ko(e.$cstNode,"feature"):super.getNameNode(e)}}class Ji{constructor(e){this.nameProvider=e.references.NameProvider,this.index=e.shared.workspace.IndexManager,this.nodeLocator=e.workspace.AstNodeLocator}findDeclaration(e){if(e){const t=zo(e),n=e.astNode;if(t&&n){const r=n[t.feature];if(d(r))return r.ref;if(Array.isArray(r))for(const t of r)if(d(t)&&t.$refNode&&t.$refNode.offset<=e.offset&&t.$refNode.end>=e.end)return t.ref}if(n){const t=this.nameProvider.getNameNode(n);if(t&&(t===e||function(e,t){for(;e.container;)if((e=e.container)===t)return!0;return!1}(e,t)))return n}}}findDeclarationNode(e){const t=this.findDeclaration(e);if(null==t?void 0:t.$cstNode){const e=this.nameProvider.getNameNode(t);return null!=e?e:t.$cstNode}}findReferences(e,t){const n=[];if(t.includeDeclaration){const t=this.getReferenceToSelf(e);t&&n.push(t)}let r=this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e));return t.documentUri&&(r=r.filter((e=>Un.equals(e.sourceUri,t.documentUri)))),n.push(...r),R(n)}getReferenceToSelf(e){const t=this.nameProvider.getNameNode(e);if(t){const n=nt(e),r=this.nodeLocator.getAstNodePath(e);return{sourceUri:n.uri,sourcePath:r,targetUri:n.uri,targetPath:r,segment:x(t),local:!0}}}}class Qi extends Ji{constructor(e){super(e),this.documents=e.shared.workspace.LangiumDocuments}findDeclaration(e){const t=e.astNode,n=zo(e);if(n&&"feature"===n.feature){if(De(t))return this.findAssignmentDeclaration(t);if(Ce(t))return this.findActionDeclaration(t)}return super.findDeclaration(e)}findReferences(e,t){var n;return we(e)?this.findReferencesToTypeAttribute(e,null!==(n=t.includeDeclaration)&&void 0!==n&&n):super.findReferences(e,t)}findReferencesToTypeAttribute(e,t){const n=[],r=tt(e,oe);if(r){if(t){const t=this.getReferenceToSelf(e);t&&n.push(t)}const i=un(r,this,this.documents,this.nodeLocator),o=[];i.forEach((e=>{const t=this.findRulesWithReturnType(e);o.push(...t)})),o.forEach((t=>{const r=this.createReferencesToAttribute(t,e);n.push(...r)}))}return R(n)}createReferencesToAttribute(e,t){const n=[];if(fe(e)){const r=Lr(e.definition).find((e=>e.feature===t.name));if(null==r?void 0:r.$cstNode){const e=this.nameProvider.getNameNode(r);e&&n.push({sourceUri:nt(r).uri,sourcePath:this.nodeLocator.getAstNodePath(r),targetUri:nt(t).uri,targetPath:this.nodeLocator.getAstNodePath(t),segment:x(e),local:Un.equals(nt(r).uri,nt(t).uri)})}}else{if(e.feature===t.name){const r=Ko(e.$cstNode,"feature");r&&n.push({sourceUri:nt(e).uri,sourcePath:this.nodeLocator.getAstNodePath(e),targetUri:nt(t).uri,targetPath:this.nodeLocator.getAstNodePath(t),segment:x(r),local:Un.equals(nt(e).uri,nt(t).uri)})}const r=tt(e,fe);n.push(...this.createReferencesToAttribute(r,t))}return n}findAssignmentDeclaration(e){var t;const n=tt(e,fe),r=kr(e);if(r){const t=this.findActionDeclaration(r,e.feature);if(t)return t}if((null===(t=null==n?void 0:n.returnType)||void 0===t?void 0:t.ref)&&(oe(n.returnType.ref)||be(n.returnType.ref))){const t=ln(n.returnType.ref);for(const n of t){const t=n.attributes.find((t=>t.name===e.feature));if(t)return t}}return e}findActionDeclaration(e,t){var n;if(null===(n=e.type)||void 0===n?void 0:n.ref){const n=null!=t?t:e.feature,r=ln(e.type.ref);for(const e of r){const t=e.attributes.find((e=>e.name===n));if(t)return t}}}findRulesWithReturnType(e){const t=[];return this.index.findAllReferences(e,this.nodeLocator.getAstNodePath(e)).forEach((e=>{const n=this.documents.getOrCreateDocument(e.sourceUri),r=this.nodeLocator.getAstNode(n.parseResult.value,e.sourcePath);(fe(r)||Ce(r))&&t.push(r)})),t}}class Zi{constructor(e){this.grammarConfig=e.parser.GrammarConfig,this.nameProvider=e.references.NameProvider,this.documents=e.shared.workspace.LangiumDocuments,this.references=e.references.References}prepareCallHierarchy(e,t){const n=A(e.parseResult.value.$cstNode,e.textDocument.offsetAt(t.position),this.grammarConfig.nameRegexp);if(!n)return;const r=this.references.findDeclarationNode(n);return r?this.getCallHierarchyItems(r.astNode,e):void 0}getCallHierarchyItems(e,t){const n=this.nameProvider.getNameNode(e),r=this.nameProvider.getName(e);if(n&&e.$cstNode&&void 0!==r)return[Object.assign({kind:i.SymbolKind.Method,name:r,range:e.$cstNode.range,selectionRange:n.range,uri:t.uri.toString()},this.getCallHierarchyItem(e))]}getCallHierarchyItem(e){}incomingCalls(e){const t=this.documents.getOrCreateDocument(jn.parse(e.item.uri)),n=A(t.parseResult.value.$cstNode,t.textDocument.offsetAt(e.item.range.start),this.grammarConfig.nameRegexp);if(!n)return;const r=this.references.findReferences(n.astNode,{includeDeclaration:!1});return this.getIncomingCalls(n.astNode,r)}outgoingCalls(e){const t=this.documents.getOrCreateDocument(jn.parse(e.item.uri)),n=A(t.parseResult.value.$cstNode,t.textDocument.offsetAt(e.item.range.start),this.grammarConfig.nameRegexp);if(n)return this.getOutgoingCalls(n.astNode)}}class eo{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getDefinition(e,t){const n=e.parseResult.value;if(n.$cstNode){const r=A(n.$cstNode,e.textDocument.offsetAt(t.position),this.grammarConfig.nameRegexp);if(r)return this.collectLocationLinks(r,t)}}collectLocationLinks(e,t){var n;const r=this.findLink(e);if(r)return[i.LocationLink.create(r.targetDocument.textDocument.uri,(null!==(n=r.target.astNode.$cstNode)&&void 0!==n?n:r.target).range,r.target.range,r.source.range)]}findLink(e){const t=this.references.findDeclarationNode(e);if(null==t?void 0:t.astNode){const n=nt(t.astNode);if(t&&n)return{source:e,target:t,targetDocument:n}}}}class to{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,this.grammarConfig=e.parser.GrammarConfig}getDocumentHighlight(e,t){const n=e.parseResult.value.$cstNode;if(!n)return;const r=A(n,e.textDocument.offsetAt(t.position),this.grammarConfig.nameRegexp);if(!r)return;const i=this.references.findDeclaration(r);if(i){const t=Un.equals(nt(i).uri,e.uri),n={documentUri:e.uri,includeDeclaration:t};return this.references.findReferences(i,n).map((e=>this.createDocumentHighlight(e))).toArray()}}createDocumentHighlight(e){return i.DocumentHighlight.create(e.segment.range)}}class no{constructor(e){this.nameProvider=e.references.NameProvider,this.nodeKindProvider=e.shared.lsp.NodeKindProvider}getSymbols(e){return this.getSymbol(e,e.parseResult.value)}getSymbol(e,t){const n=t.$cstNode,r=this.nameProvider.getNameNode(t);if(r&&n){const i=this.nameProvider.getName(t);return[{kind:this.nodeKindProvider.getSymbolKind(t),name:null!=i?i:r.text,range:n.range,selectionRange:r.range,children:this.getChildSymbols(e,t)}]}return this.getChildSymbols(e,t)||[]}getChildSymbols(e,t){const n=[];for(const r of it(t)){const t=this.getSymbol(e,r);n.push(...t)}if(n.length>0)return n}}class ro{match(e,t){if(0===e.length)return!0;let n,r=!1,i=0;const o=(t=t.toLowerCase()).length;for(let s=0;s<o;s++){const o=t.charCodeAt(s),a=e.charCodeAt(i);if((o===a||this.toUpperCharCode(o)===this.toUpperCharCode(a))&&(r||(r=void 0===n||this.isWordTransition(n,o)),r&&i++,i===e.length))return!0;n=o}return!1}isWordTransition(e,t){return io<=e&&e<=oo&&so<=t&&t<=ao||e===co&&t!==co}toUpperCharCode(e){return io<=e&&e<=oo?e-32:e}}const io="a".charCodeAt(0),oo="z".charCodeAt(0),so="A".charCodeAt(0),ao="Z".charCodeAt(0),co="_".charCodeAt(0);class uo{constructor(e){this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}getHoverContent(e,t){var n,r;const i=null===(r=null===(n=e.parseResult)||void 0===n?void 0:n.value)||void 0===r?void 0:r.$cstNode;if(i){const n=e.textDocument.offsetAt(t.position),r=A(i,n,this.grammarConfig.nameRegexp);if(r&&r.offset+r.length>n){const e=this.references.findDeclaration(r);if(e)return this.getAstNodeHoverContent(e)}}}}class lo extends uo{constructor(e){super(e),this.documentationProvider=e.documentation.DocumentationProvider}getAstNodeHoverContent(e){const t=this.documentationProvider.getDocumentation(e);if(t)return{contents:{kind:"markdown",value:t}}}}var fo,po;(po=fo||(fo={}))[po.Changed=0]="Changed",po[po.Parsed=1]="Parsed",po[po.IndexedContent=2]="IndexedContent",po[po.ComputedScopes=3]="ComputedScopes",po[po.Linked=4]="Linked",po[po.IndexedReferences=5]="IndexedReferences",po[po.Validated=6]="Validated";class ho{constructor(e){this.serviceRegistry=e.ServiceRegistry,this.textDocuments=e.workspace.TextDocuments,this.fileSystemProvider=e.workspace.FileSystemProvider}fromTextDocument(e,t){return this.create(null!=t?t:jn.parse(e.uri),e)}fromString(e,t){return this.create(t,e)}fromModel(e,t){return this.create(t,{$model:e})}create(e,t){if(null!=t||(t=this.textDocuments.get(e.toString())),null!=t||(t=this.getContentFromFileSystem(e)),"string"==typeof t){const n=this.parse(e,t);return this.createLangiumDocument(n,e,void 0,t)}if("$model"in t){const n={value:t.$model,parserErrors:[],lexerErrors:[]};return this.createLangiumDocument(n,e)}{const n=this.parse(e,t.getText());return this.createLangiumDocument(n,e,t)}}createLangiumDocument(e,t,n,r){let i;if(n)i={parseResult:e,uri:t,state:fo.Parsed,references:[],textDocument:n};else{const n=this.createTextDocumentGetter(t,r);i={parseResult:e,uri:t,state:fo.Parsed,references:[],get textDocument(){return n()}}}return e.value.$document=i,i}update(e){const t=this.textDocuments.get(e.uri.toString()),n=t?t.getText():this.getContentFromFileSystem(e.uri);if(t)Object.defineProperty(e,"textDocument",{value:t});else{const t=this.createTextDocumentGetter(e.uri,n);Object.defineProperty(e,"textDocument",{get:t})}return e.parseResult=this.parse(e.uri,n),e.parseResult.value.$document=e,e}getContentFromFileSystem(e){return this.fileSystemProvider.readFileSync(e)}parse(e,t){return this.serviceRegistry.getServices(e).parser.LangiumParser.parse(t)}createTextDocumentGetter(e,t){const n=this.serviceRegistry;let i;return()=>null!=i?i:i=r.create(e.toString(),n.getServices(e).LanguageMetaData.languageId,0,null!=t?t:"")}}class mo{constructor(e){this.documentMap=new Map,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory}get all(){return R(this.documentMap.values())}addDocument(e){const t=e.uri.toString();if(this.documentMap.has(t))throw new Error(`A document with the URI '${t}' is already present.`);this.documentMap.set(t,e)}getOrCreateDocument(e){const t=e.toString();let n=this.documentMap.get(t);return n||(n=this.langiumDocumentFactory.create(e),this.documentMap.set(t,n),n)}hasDocument(e){return this.documentMap.has(e.toString())}invalidateDocument(e){const t=e.toString(),n=this.documentMap.get(t);return n&&(n.state=fo.Changed,n.precomputedScopes=void 0,n.references=[],n.diagnostics=void 0),n}deleteDocument(e){const t=e.toString(),n=this.documentMap.get(t);return n&&(n.state=fo.Changed,this.documentMap.delete(t)),n}}class yo{constructor(e){this.onInitializeEmitter=new i.Emitter,this.onInitializedEmitter=new i.Emitter,this.services=e}get onInitialize(){return this.onInitializeEmitter.event}get onInitialized(){return this.onInitializedEmitter.event}async initialize(e){return this.eagerLoadServices(),this.onInitializeEmitter.fire(e),this.onInitializeEmitter.dispose(),this.buildInitializeResult(e)}eagerLoadServices(){F(this.services),this.services.ServiceRegistry.all.forEach((e=>F(e)))}hasService(e){return this.services.ServiceRegistry.all.some((t=>void 0!==e(t)))}buildInitializeResult(e){var t;const n=this.services.ServiceRegistry.all,r=this.hasService((e=>e.lsp.Formatter)),o=n.map((e=>{var t;return null===(t=e.lsp.Formatter)||void 0===t?void 0:t.formatOnTypeOptions})).find((e=>Boolean(e))),s=this.hasService((e=>e.lsp.CodeActionProvider)),a=this.hasService((e=>e.lsp.SemanticTokenProvider)),c=null===(t=this.services.lsp.ExecuteCommandHandler)||void 0===t?void 0:t.commands,u=this.hasService((e=>e.lsp.DocumentLinkProvider)),l=function(e){const t=[],n=[];e.forEach((e=>{(null==e?void 0:e.triggerCharacters)&&t.push(...e.triggerCharacters),(null==e?void 0:e.retriggerCharacters)&&n.push(...e.retriggerCharacters)}));const r={triggerCharacters:t.length>0?Array.from(new Set(t)).sort():void 0,retriggerCharacters:n.length>0?Array.from(new Set(n)).sort():void 0};return r.triggerCharacters?r:void 0}(n.map((e=>{var t;return null===(t=e.lsp.SignatureHelp)||void 0===t?void 0:t.signatureHelpOptions}))),d=this.hasService((e=>e.lsp.TypeProvider)),f=this.hasService((e=>e.lsp.ImplementationProvider)),p=this.hasService((e=>e.lsp.CompletionProvider)),h=function(e){const t=Array.from(new Set(e.flatMap((e=>{var t;return null!==(t=null==e?void 0:e.triggerCharacters)&&void 0!==t?t:[]})))),n=Array.from(new Set(e.flatMap((e=>{var t;return null!==(t=null==e?void 0:e.allCommitCharacters)&&void 0!==t?t:[]}))));return{triggerCharacters:t.length>0?t:void 0,allCommitCharacters:n.length>0?n:void 0}}(n.map((e=>{var t;return null===(t=e.lsp.CompletionProvider)||void 0===t?void 0:t.completionOptions}))),m=this.hasService((e=>e.lsp.ReferencesProvider)),y=this.hasService((e=>e.lsp.DocumentSymbolProvider)),g=this.hasService((e=>e.lsp.DefinitionProvider)),v=this.hasService((e=>e.lsp.DocumentHighlightProvider)),T=this.hasService((e=>e.lsp.FoldingRangeProvider)),R=this.hasService((e=>e.lsp.HoverProvider)),k=this.hasService((e=>e.lsp.RenameProvider)),b=this.hasService((e=>e.lsp.CallHierarchyProvider)),w=this.hasService((e=>e.lsp.CodeLensProvider)),S=this.hasService((e=>e.lsp.DeclarationProvider)),$=this.hasService((e=>e.lsp.InlayHintProvider)),x=this.services.lsp.WorkspaceSymbolProvider;return{capabilities:{workspace:{workspaceFolders:{supported:!0}},executeCommandProvider:c&&{commands:c},textDocumentSync:i.TextDocumentSyncKind.Incremental,completionProvider:p?h:void 0,referencesProvider:m,documentSymbolProvider:y,definitionProvider:g,typeDefinitionProvider:d,documentHighlightProvider:v,codeActionProvider:s,documentFormattingProvider:r,documentRangeFormattingProvider:r,documentOnTypeFormattingProvider:o,foldingRangeProvider:T,hoverProvider:R,renameProvider:k?{prepareProvider:!0}:void 0,semanticTokensProvider:a?Wi:void 0,signatureHelpProvider:l,implementationProvider:f,callHierarchyProvider:b?{}:void 0,documentLinkProvider:u?{resolveProvider:!1}:void 0,codeLensProvider:w?{resolveProvider:!1}:void 0,declarationProvider:S,inlayHintProvider:$?{resolveProvider:!1}:void 0,workspaceSymbolProvider:x?{resolveProvider:Boolean(x.resolveSymbol)}:void 0}}}async initialized(e){this.onInitializedEmitter.fire(e),this.onInitializedEmitter.dispose()}}class go{getSymbolKind(){return i.SymbolKind.Field}getCompletionItemKind(){return i.CompletionItemKind.Reference}}class vo{constructor(e){this.nameProvider=e.references.NameProvider,this.references=e.references.References,this.grammarConfig=e.parser.GrammarConfig}findReferences(e,t){const n=e.parseResult.value.$cstNode;if(!n)return[];const r=A(n,e.textDocument.offsetAt(t.position),this.grammarConfig.nameRegexp);return r?this.getReferences(r,t,e):[]}getReferences(e,t,n){const r=[],o=this.references.findDeclaration(e);if(o){const e={includeDeclaration:t.context.includeDeclaration};this.references.findReferences(o,e).forEach((e=>{r.push(i.Location.create(e.sourceUri.toString(),e.segment.range))}))}return r}}class To{constructor(e){this.references=e.references.References,this.nameProvider=e.references.NameProvider,this.grammarConfig=e.parser.GrammarConfig}async rename(e,t){const n={},r=e.parseResult.value.$cstNode;if(!r)return;const o=A(r,e.textDocument.offsetAt(t.position),this.grammarConfig.nameRegexp);if(!o)return;const s=this.references.findDeclaration(o);return s?(this.references.findReferences(s,{onlyLocal:!1,includeDeclaration:!0}).forEach((e=>{const r=i.TextEdit.replace(e.segment.range,t.newName),o=e.sourceUri.toString();n[o]?n[o].push(r):n[o]=[r]})),{changes:n}):void 0}prepareRename(e,t){return this.renameNodeRange(e,t.position)}renameNodeRange(e,t){const n=e.parseResult.value.$cstNode,r=e.textDocument.offsetAt(t);if(n&&r){const e=A(n,r,this.grammarConfig.nameRegexp);if(!e)return;if(this.references.findDeclaration(e)||this.isNameNode(e))return e.range}}isNameNode(e){return(null==e?void 0:e.astNode)&&gn(e.astNode)&&e===this.nameProvider.getNameNode(e.astNode)}}class Ro{constructor(e){this.indexManager=e.workspace.IndexManager,this.nodeKindProvider=e.lsp.NodeKindProvider,this.fuzzyMatcher=e.lsp.FuzzyMatcher}async getSymbols(e,t=i.CancellationToken.None){const n=[],r=e.query.toLowerCase();for(const e of this.indexManager.allElements())if(await Yn(t),this.fuzzyMatcher.match(r,e.name)){const t=this.getWorkspaceSymbol(e);t&&n.push(t)}return n}getWorkspaceSymbol(e){const t=e.nameSegment;return t?{kind:this.nodeKindProvider.getSymbolKind(e),name:e.name,location:{range:t.range,uri:e.documentUri.toString()}}:void 0}}class ko extends eo{constructor(e){super(e),this.documents=e.shared.workspace.LangiumDocuments}collectLocationLinks(e,t){var n,r,o,s,a,c;if(!te(e.astNode)||"path"!==(null===(n=zo(e))||void 0===n?void 0:n.feature))return super.collectLocationLinks(e,t);{const t=Ir(this.documents,e.astNode);if(null==t?void 0:t.$document){const n=null!==(r=this.findTargetObject(t))&&void 0!==r?r:t,u=null!==(s=null===(o=this.nameProvider.getNameNode(n))||void 0===o?void 0:o.range)&&void 0!==s?s:i.Range.create(0,0,0,0),l=null!==(c=null===(a=n.$cstNode)||void 0===a?void 0:a.range)&&void 0!==c?c:i.Range.create(0,0,0,0);return[i.LocationLink.create(t.$document.uri.toString(),l,u,e.range)]}}}findTargetObject(e){return e.isDeclared?e:it(e).head()}}class bo extends Zi{getIncomingCalls(e,t){if(!fe(e))return;const n=new Map;return t.forEach((e=>{const t=this.documents.getOrCreateDocument(e.sourceUri).parseResult.value;if(!t.$cstNode)return;const r=D(t.$cstNode,e.segment.offset);if(!r)return;const i=tt(r.astNode,fe);if(!i||!i.$cstNode)return;const o=this.nameProvider.getNameNode(i);if(!o)return;const s=e.sourceUri.toString(),a=s+"@"+o.text;n.has(a)?n.set(a,{parserRule:i.$cstNode,nameNode:o,targetNodes:[...n.get(a).targetNodes,r],docUri:s}):n.set(a,{parserRule:i.$cstNode,nameNode:o,targetNodes:[r],docUri:s})})),0!==n.size?Array.from(n.values()).map((e=>({from:{kind:i.SymbolKind.Method,name:e.nameNode.text,range:e.parserRule.range,selectionRange:e.nameNode.range,uri:e.docUri},fromRanges:e.targetNodes.map((e=>e.range))}))):void 0}getOutgoingCalls(e){if(!fe(e))return;const t=ot(e).filter(He).toArray(),n=new Map;return t.forEach((e=>{var t;const r=e.$cstNode;if(!r)return;const i=null===(t=e.rule.ref)||void 0===t?void 0:t.$cstNode;if(!i)return;const o=this.nameProvider.getNameNode(i.astNode);if(!o)return;const s=nt(i.astNode).uri.toString(),a=s+"@"+o.text;n.has(a)?n.set(a,{refCstNode:i,to:o,from:[...n.get(a).from,r.range],docUri:s}):n.set(a,{refCstNode:i,to:o,from:[r.range],docUri:s})})),0!==n.size?Array.from(n.values()).map((e=>({to:{kind:i.SymbolKind.Method,name:e.to.text,range:e.refCstNode.range,selectionRange:e.to.range,uri:e.docUri},fromRanges:e.from}))):void 0}}class wo{constructor(e){this.documents=e.shared.workspace.LangiumDocuments}collectValidationResources(e){const t=function(e,t){const{inferred:n,declared:r,astResources:i}=Jr(e,t);return{astResources:i,inferred:Zr(r,n),declared:Zr(n,r)}}(e,this.documents);return{typeToValidationInfo:this.collectValidationInfo(t),typeToSuperProperties:this.collectSuperProperties(t)}}collectValidationInfo({astResources:e,inferred:t,declared:n}){const r=new Map,i=function({parserRules:e,datatypeRules:t}){const n=new G;function r(e){if(Ce(e)){const t=$r(e);t&&n.add(t,e)}(Ae(e)||Fe(e)||Xe(e))&&e.elements.forEach((e=>r(e)))}return R(e).concat(t).forEach((e=>n.add(xr(e),e))),e.forEach((e=>r(e.definition))),n}(e);for(const e of pn(t))r.set(e.name,{inferred:e,inferredNodes:i.get(e.name)});const o=R(e.interfaces).concat(e.types).reduce(((e,t)=>e.set(t.name,t)),new Map);for(const e of pn(n)){const t=o.get(e.name);if(t){const n=r.get(e.name);r.set(e.name,Object.assign(Object.assign({},null!=n?n:{}),{declared:e,declaredNode:t}))}}return r}collectSuperProperties({inferred:e,declared:t}){const n=new Map,r=fn(e,t),i=new Map(r.map((e=>[e.name,e])));for(const r of fn(e,t))n.set(r.name,this.addSuperProperties(r,i,new Set));return n}addSuperProperties(e,t,n){if(n.has(e.name))return[];n.add(e.name);const r=[...e.properties];for(const i of e.superTypes){const e=t.get(i.name);e&&r.push(...this.addSuperProperties(e,t,n))}return r}}function So(e){return e&&"inferred"in e&&"declared"in e}class $o{checkCyclicType(e,t){xo(e,new Set)&&t("error",`Type alias '${e.name}' circularly references itself.`,{node:e,property:"name"})}checkCyclicInterface(e,t){xo(e,new Set)&&t("error",`Type '${e.name}' recursively references itself as a base type.`,{node:e,property:"name"})}checkDeclaredTypesConsistency(e,t){var n;const r=null===(n=e.$document)||void 0===n?void 0:n.validationResources;if(r)for(const e of r.typeToValidationInfo.values())if((i=e)&&"declared"in i&&Gt(e.declared)&&oe(e.declaredNode)){const n=e;Eo(n,t),Ao(n,t)}var i}checkDeclaredAndInferredTypesConsistency(e,t){var n;const r=null===(n=e.$document)||void 0===n?void 0:n.validationResources;if(r)for(const e of r.typeToValidationInfo.values())(i=e)&&"inferred"in i&&e.inferred instanceof Wt&&Co(e.inferred,t),So(e)&&_o(e,r,t);var i}checkActionIsNotUnionType(e,t){be(e.type)&&t("error","Actions cannot create union types.",{node:e,property:"type"})}}function xo(e,t){var n;if(t.has(e))return!0;if(t.add(e),be(e))return xo(e.type,t);if(oe(e))return e.superTypes.some((e=>e.ref&&xo(e.ref,new Set(t))));if(ve(e)){if(null===(n=e.typeRef)||void 0===n?void 0:n.ref)return xo(e.typeRef.ref,t)}else{if(he(e))return xo(e.referenceType,t);if(Y(e))return xo(e.elementType,t);if($e(e))return e.types.some((e=>xo(e,new Set(t))))}return!1}function Co(e,t){e.properties.forEach((e=>{var n;const r=Ft(e.type);if(r.length>1){const i=e=>Ot(e)?"ref":"other",o=i(r[0]);if(r.slice(1).some((e=>i(e)!==o))){const r=null===(n=e.astNodes.values().next())||void 0===n?void 0:n.value;r&&t("error",`Mixing a cross-reference with other types is not supported. Consider splitting property "${e.name}" into two or more different properties.`,{node:r})}}}))}function Eo({declared:e,declaredNode:t},n){Array.from(e.superTypes).forEach(((e,r)=>{e&&(Kt(e)&&n("error","Interfaces cannot extend union types.",{node:t,property:"superTypes",index:r}),e.declared||n("error","Extending an inferred type is discouraged.",{node:t,property:"superTypes",index:r}))}))}function Ao({declared:e,declaredNode:t},n){const r=e.properties.reduce(((e,t)=>e.add(t.name,t)),new G);for(const[e,t]of r.entriesGroupedByKey())if(t.length>1)for(const r of t)n("error",`Cannot have two properties with the same name '${e}'.`,{node:Array.from(r.astNodes)[0],property:"name"});const i=Array.from(e.superTypes);for(let e=0;e<i.length;e++)for(let r=e+1;r<i.length;r++){const o=i[e],s=i[r],a=No(Gt(o)?o.superProperties:[],Gt(s)?s.superProperties:[]);a.length>0&&n("error",`Cannot simultaneously inherit from '${o}' and '${s}'. Their ${a.map((e=>"'"+e+"'")).join(", ")} properties are not identical.`,{node:t,property:"name"})}const o=new Set;for(const e of i){const t=Gt(e)?e.superProperties:[];for(const e of t)o.add(e.name)}for(const r of e.properties)if(o.has(r.name)){const e=t.attributes.find((e=>e.name===r.name));e&&n("error",`Cannot redeclare property '${r.name}'. It is already inherited from another interface.`,{node:e,property:"name"})}}function No(e,t){const n=[];for(const r of e){const e=t.find((e=>e.name===r.name));e&&!Do(r,e)&&n.push(r.name)}return n}function Do(e,t){return zt(e.type,t.type)&&zt(t.type,e.type)}function _o(e,t,n){const{inferred:r,declared:i,declaredNode:o,inferredNodes:s}=e,a=i.name,c=e=>t=>s.forEach((r=>n("error",`${t}${e?` ${e}`:""}.`,(null==r?void 0:r.inferredType)?{node:null==r?void 0:r.inferredType,property:"name"}:{node:r,property:Ce(r)?"type":"name"})));if(Kt(r)&&Kt(i))!function(e,t,n){zt(e,t)||n(`Cannot assign type '${Jt(e,"DeclaredType")}' to '${Jt(t,"DeclaredType")}'`)}(r.type,i.type,c(`in a rule that returns type '${a}'`));else if(Gt(r)&&Gt(i))!function(e,t,n,r,i,o){const s=new Set(e.properties.map((e=>e.name))),a=new Map(e.allProperties.map((e=>[e.name,e]))),c=new Map(t.superProperties.map((e=>[e.name,e]))),u=e=>{if(Mt(e))return{types:e.types.map((e=>u(e)))};if(Ot(e))return{referenceType:u(e.referenceType)};if(Lt(e))return{elementType:u(e.elementType)};if(jt(e)){const t=n.typeToValidationInfo.get(e.value.name);return t?{value:"declared"in t?t.declared:t.inferred}:e}return e};for(const[e,t]of a.entries()){const n=c.get(e);if(n){const r=Jt(t.type,"DeclaredType"),s=Jt(n.type,"DeclaredType");if(!zt(u(t.type),n.type)&&"unknown"!==s){const n=`The assigned type '${r}' is not compatible with the declared property '${e}' of type '${s}'.`;i(t.astNodes,n)}t.optional&&!Io(n)&&o(e)}else s.has(e)&&i(t.astNodes,`A property '${e}' is not expected.`)}const l=new Set;for(const[e,t]of c.entries())a.get(e)||Io(t)||l.add(e);if(l.size>0){const e=l.size>1?"Properties":"A property",t=l.size>1?"are expected":"is expected";r(`${e} ${Array.from(l).map((e=>`'${e}'`)).sort().join(", ")} ${t}.`)}}(r,i,t,c(`in a rule that returns type '${a}'`),((e,t)=>e.forEach((e=>n("error",t,{node:e,property:De(e)||Ce(e)?"feature":"name"})))),(e=>{s.forEach((t=>{fe(t)&&void 0===Lr(t.definition).find((t=>t.feature===e))&&n("error",`Property '${e}' is missing in a rule '${t.name}', but is required in type '${a}'.`,{node:t,property:"parameters"})}))}));else{const e=`Inferred and declared versions of type '${a}' both have to be interfaces or unions.`;c()(e),n("error",e,{node:o,property:"name"})}}function Io(e){return e.optional||en(e.type)}const Po={validation:{LangiumGrammarValidator:e=>new fr(e),ValidationResourcesCollector:e=>new wo(e),LangiumGrammarTypesValidator:()=>new $o},lsp:{FoldingRangeProvider:e=>new Mi(e),CodeActionProvider:e=>new bi(e),SemanticTokenProvider:e=>new Yi(e),Formatter:()=>new Ki,DefinitionProvider:e=>new ko(e),CallHierarchyProvider:e=>new bo(e),CompletionProvider:e=>new Oi(e)},references:{ScopeComputation:e=>new yi(e),ScopeProvider:e=>new mi(e),References:e=>new Qi(e),NameProvider:()=>new Xi}};class Oo{readFile(){throw new Error("Method not implemented.")}readFileSync(){throw new Error("Method not implemented.")}async readDirectory(){return[]}}const Lo={fileSystemProvider:()=>new Oo};function Mo(e){return e.rules.find((e=>fe(e)&&e.entry))}function Fo(e,t){const n=new Set,r=Mo(e);if(!r)return new Set(e.rules);const i=[r].concat(function(e){return e.rules.filter((e=>Re(e)&&e.hidden))}(e));for(const e of i)jo(e,n,t);const o=new Set;for(const t of e.rules)(n.has(t.name)||Re(t)&&t.hidden)&&o.add(t);return o}function jo(e,t,n){t.add(e.name),ot(e).forEach((e=>{if(He(e)||n&&Ve(e)){const r=e.rule.ref;r&&!t.has(r.name)&&jo(r,t,n)}}))}function qo(e){if(e.terminal)return e.terminal;if(e.type.ref){const t=Vo(e.type.ref);return null==t?void 0:t.terminal}}function Uo(e,t){return e&&t?Go(e,t,e.astNode,!0):[]}function Ko(e,t,n){if(!e||!t)return;const r=Go(e,t,e.astNode,!0);return 0!==r.length?r[n=void 0!==n?Math.max(0,Math.min(n,r.length-1)):0]:void 0}function Go(e,t,n,r){if(!r){const n=tt(e.grammarSource,De);if(n&&n.feature===t)return[e]}return h(e)&&e.astNode===n?e.content.flatMap((e=>Go(e,t,n,!1))):[]}function Ho(e,t){return e?Bo(e,t,null==e?void 0:e.astNode):[]}function Wo(e,t,n){if(!e)return;const r=Bo(e,t,null==e?void 0:e.astNode);return 0!==r.length?r[n=void 0!==n?Math.max(0,Math.min(n,r.length-1)):0]:void 0}function Bo(e,t,n){if(e.astNode!==n)return[];if(qe(e.grammarSource)&&e.grammarSource.value===t)return[e];const r=S(e).iterator();let i;const o=[];do{if(i=r.next(),!i.done){const e=i.value;e.astNode===n?qe(e.grammarSource)&&e.grammarSource.value===t&&o.push(e):r.prune()}}while(!i.done);return o}function zo(e){var t;const n=e.astNode;for(;n===(null===(t=e.container)||void 0===t?void 0:t.astNode);){const t=tt(e.grammarSource,De);if(t)return t;e=e.container}}function Vo(e){return re(e)&&(e=e.$container),Yo(e,new Map)}function Yo(e,t){var n;function r(n,r){let i;return tt(n,De)||(i=Yo(r,t)),t.set(e,i),i}if(t.has(e))return t.get(e);t.set(e,void 0);for(const i of ot(e)){if(De(i)&&"name"===i.feature.toLowerCase())return t.set(e,i),i;if(He(i)&&fe(i.rule.ref))return r(i,i.rule.ref);if(ve(i)&&(null===(n=i.typeRef)||void 0===n?void 0:n.ref))return r(i,i.typeRef.ref)}}function Xo(e){var t;const n=function(e,t){const n=L(Jm(e),ii,t),r=L(Xm({shared:n}),oi,Po);var i;return i=r,n.workspace.DocumentBuilder.onBuildPhase(fo.IndexedReferences,(async(e,t)=>{for(const n of e){await Yn(t);const e=i.validation.ValidationResourcesCollector,r=n.parseResult.value;n.validationResources=e.collectValidationResources(r)}})),n.ServiceRegistry.register(r),function(e){const t=e.validation.ValidationRegistry,n=e.validation.LangiumGrammarValidator,r={Action:[n.checkAssignmentReservedName],AbstractRule:n.checkRuleName,Assignment:[n.checkAssignmentWithFeatureName,n.checkAssignmentToFragmentRule,n.checkAssignmentTypes,n.checkAssignmentReservedName],ParserRule:[n.checkParserRuleDataType,n.checkRuleParametersUsed,n.checkParserRuleReservedName],TerminalRule:[n.checkTerminalRuleReturnType,n.checkHiddenTerminalRule,n.checkEmptyTerminalRule],InferredType:n.checkTypeReservedName,Keyword:n.checkKeyword,UnorderedGroup:n.checkUnorderedGroup,Grammar:[n.checkGrammarName,n.checkEntryGrammarRule,n.checkUniqueRuleName,n.checkUniqueTypeName,n.checkUniqueImportedRules,n.checkDuplicateImportedGrammar,n.checkGrammarHiddenTokens,n.checkGrammarForUnusedRules,n.checkGrammarTypeInfer,n.checkClashingTerminalNames],GrammarImport:n.checkPackageImport,CharacterRange:n.checkInvalidCharacterRange,Interface:[n.checkTypeReservedName,n.checkInterfacePropertyTypes],Type:[n.checkTypeReservedName],TypeAttribute:n.checkTypeReservedName,RuleCall:[n.checkUsedHiddenTerminalRule,n.checkUsedFragmentTerminalRule,n.checkRuleCallParameters],TerminalRuleCall:n.checkUsedHiddenTerminalRule,CrossReference:[n.checkCrossReferenceSyntax,n.checkCrossRefNameAssignment,n.checkCrossRefTerminalType,n.checkCrossRefType,n.checkCrossReferenceToTypeUnion],SimpleType:n.checkFragmentsInTypes,ReferenceType:n.checkReferenceTypeUnion,RegexToken:[n.checkInvalidRegexFlags,n.checkDirectlyUsedRegexFlags]};t.register(r,n)}(r),function(e){const t=e.validation.ValidationRegistry,n=e.validation.LangiumGrammarTypesValidator,r={Action:[n.checkActionIsNotUnionType],Grammar:[n.checkDeclaredTypesConsistency,n.checkDeclaredAndInferredTypesConsistency],Interface:[n.checkCyclicInterface],Type:[n.checkCyclicType]};t.register(r,n)}(r),{shared:n,grammar:r}}(Lo).grammar,r=n.serializer.JsonSerializer.deserialize(e);return n.shared.workspace.LangiumDocumentFactory.fromModel(r,jn.parse(`memory://${null!==(t=r.name)&&void 0!==t?t:"grammar"}.langium`)),r}const Jo=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},Qo=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),s=o.length;s--;){var a=o[++r];if(!1===t(i[a],a,i))break}return e},Zo="object"==typeof global&&global&&global.Object===Object&&global;var es="object"==typeof self&&self&&self.Object===Object&&self;const ts=Zo||es||Function("return this")(),ns=ts.Symbol;var rs=Object.prototype,is=rs.hasOwnProperty,os=rs.toString,ss=ns?ns.toStringTag:void 0;var as=Object.prototype.toString;var cs=ns?ns.toStringTag:void 0;const us=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":cs&&cs in Object(e)?function(e){var t=is.call(e,ss),n=e[ss];try{e[ss]=void 0;var r=!0}catch(e){}var i=os.call(e);return r&&(t?e[ss]=n:delete e[ss]),i}(e):function(e){return as.call(e)}(e)},ls=function(e){return null!=e&&"object"==typeof e},ds=function(e){return ls(e)&&"[object Arguments]"==us(e)};var ps=Object.prototype,hs=ps.hasOwnProperty,ms=ps.propertyIsEnumerable;const ys=ds(function(){return arguments}())?ds:function(e){return ls(e)&&hs.call(e,"callee")&&!ms.call(e,"callee")},gs=Array.isArray;var vs="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ts=vs&&"object"==typeof module&&module&&!module.nodeType&&module,Rs=Ts&&Ts.exports===vs?ts.Buffer:void 0;const ks=(Rs?Rs.isBuffer:void 0)||function(){return!1};var bs=/^(?:0|[1-9]\d*)$/;const ws=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&bs.test(e))&&e>-1&&e%1==0&&e<t},Ss=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var $s={};$s["[object Float32Array]"]=$s["[object Float64Array]"]=$s["[object Int8Array]"]=$s["[object Int16Array]"]=$s["[object Int32Array]"]=$s["[object Uint8Array]"]=$s["[object Uint8ClampedArray]"]=$s["[object Uint16Array]"]=$s["[object Uint32Array]"]=!0,$s["[object Arguments]"]=$s["[object Array]"]=$s["[object ArrayBuffer]"]=$s["[object Boolean]"]=$s["[object DataView]"]=$s["[object Date]"]=$s["[object Error]"]=$s["[object Function]"]=$s["[object Map]"]=$s["[object Number]"]=$s["[object Object]"]=$s["[object RegExp]"]=$s["[object Set]"]=$s["[object String]"]=$s["[object WeakMap]"]=!1;const xs=function(e){return function(t){return e(t)}};var Cs="object"==typeof exports&&exports&&!exports.nodeType&&exports,Es=Cs&&"object"==typeof module&&module&&!module.nodeType&&module,As=Es&&Es.exports===Cs&&Zo.process;const Ns=function(){try{return Es&&Es.require&&Es.require("util").types||As&&As.binding&&As.binding("util")}catch(e){}}();var Ds=Ns&&Ns.isTypedArray;const _s=Ds?xs(Ds):function(e){return ls(e)&&Ss(e.length)&&!!$s[us(e)]};var Is=Object.prototype.hasOwnProperty;const Ps=function(e,t){var n=gs(e),r=!n&&ys(e),i=!n&&!r&&ks(e),o=!n&&!r&&!i&&_s(e),s=n||r||i||o,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var u in e)!t&&!Is.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ws(u,c))||a.push(u);return a};var Os=Object.prototype;const Ls=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Os)},Ms=function(e,t){return function(n){return e(t(n))}},Fs=Ms(Object.keys,Object);var js=Object.prototype.hasOwnProperty;const qs=function(e){if(!Ls(e))return Fs(e);var t=[];for(var n in Object(e))js.call(e,n)&&"constructor"!=n&&t.push(n);return t},Us=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Ks=function(e){if(!Us(e))return!1;var t=us(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Gs=function(e){return null!=e&&Ss(e.length)&&!Ks(e)},Hs=function(e){return Gs(e)?Ps(e):qs(e)},Ws=function(e,t){if(null==e)return e;if(!Gs(e))return function(e,t){return e&&Qo(e,t,Hs)}(e,t);for(var n=e.length,r=-1,i=Object(e);++r<n&&!1!==t(i[r],r,i););return e},Bs=function(e){return e},zs=function(e,t){return(gs(e)?Jo:Ws)(e,"function"==typeof(n=t)?n:Bs);var n},Vs=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Ys=function(e){return null==e?[]:function(e,t){return Vs(t,(function(t){return e[t]}))}(e,Hs(e))},Xs=ts["__core-js_shared__"];var Js,Qs=(Js=/[^.]+$/.exec(Xs&&Xs.keys&&Xs.keys.IE_PROTO||""))?"Symbol(src)_1."+Js:"";var Zs=Function.prototype.toString;const ea=function(e){if(null!=e){try{return Zs.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var ta=/^\[object .+?Constructor\]$/,na=Function.prototype,ra=Object.prototype,ia=na.toString,oa=ra.hasOwnProperty,sa=RegExp("^"+ia.call(oa).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const aa=function(e){return!(!Us(e)||(t=e,Qs&&Qs in t))&&(Ks(e)?sa:ta).test(ea(e));var t},ca=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return aa(n)?n:void 0},ua=ca(ts,"DataView"),la=ca(ts,"Map"),da=ca(ts,"Promise"),fa=ca(ts,"Set"),pa=ca(ts,"WeakMap");var ha="[object Map]",ma="[object Promise]",ya="[object Set]",ga="[object WeakMap]",va="[object DataView]",Ta=ea(ua),Ra=ea(la),ka=ea(da),ba=ea(fa),wa=ea(pa),Sa=us;(ua&&Sa(new ua(new ArrayBuffer(1)))!=va||la&&Sa(new la)!=ha||da&&Sa(da.resolve())!=ma||fa&&Sa(new fa)!=ya||pa&&Sa(new pa)!=ga)&&(Sa=function(e){var t=us(e),n="[object Object]"==t?e.constructor:void 0,r=n?ea(n):"";if(r)switch(r){case Ta:return va;case Ra:return ha;case ka:return ma;case ba:return ya;case wa:return ga}return t});const $a=Sa;var xa=Object.prototype.hasOwnProperty;const Ca=function(e){if(null==e)return!0;if(Gs(e)&&(gs(e)||"string"==typeof e||"function"==typeof e.splice||ks(e)||_s(e)||ys(e)))return!e.length;var t=$a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Ls(e))return!qs(e).length;for(var n in e)if(xa.call(e,n))return!1;return!0},Ea=function(e,t){return e===t||e!=e&&t!=t},Aa=function(e,t){for(var n=e.length;n--;)if(Ea(e[n][0],t))return n;return-1};var Na=Array.prototype.splice;function Da(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Da.prototype.clear=function(){this.__data__=[],this.size=0},Da.prototype.delete=function(e){var t=this.__data__,n=Aa(t,e);return!(n<0||(n==t.length-1?t.pop():Na.call(t,n,1),--this.size,0))},Da.prototype.get=function(e){var t=this.__data__,n=Aa(t,e);return n<0?void 0:t[n][1]},Da.prototype.has=function(e){return Aa(this.__data__,e)>-1},Da.prototype.set=function(e,t){var n=this.__data__,r=Aa(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const _a=Da,Ia=ca(Object,"create");var Pa=Object.prototype.hasOwnProperty;var Oa=Object.prototype.hasOwnProperty;function La(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}La.prototype.clear=function(){this.__data__=Ia?Ia(null):{},this.size=0},La.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},La.prototype.get=function(e){var t=this.__data__;if(Ia){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Pa.call(t,e)?t[e]:void 0},La.prototype.has=function(e){var t=this.__data__;return Ia?void 0!==t[e]:Oa.call(t,e)},La.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ia&&void 0===t?"__lodash_hash_undefined__":t,this};const Ma=La,Fa=function(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map};function ja(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ja.prototype.clear=function(){this.size=0,this.__data__={hash:new Ma,map:new(la||_a),string:new Ma}},ja.prototype.delete=function(e){var t=Fa(this,e).delete(e);return this.size-=t?1:0,t},ja.prototype.get=function(e){return Fa(this,e).get(e)},ja.prototype.has=function(e){return Fa(this,e).has(e)},ja.prototype.set=function(e,t){var n=Fa(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};const qa=ja;function Ua(e){var t=this.__data__=new _a(e);this.size=t.size}Ua.prototype.clear=function(){this.__data__=new _a,this.size=0},Ua.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ua.prototype.get=function(e){return this.__data__.get(e)},Ua.prototype.has=function(e){return this.__data__.has(e)},Ua.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _a){var r=n.__data__;if(!la||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new qa(r)}return n.set(e,t),this.size=n.size,this};const Ka=Ua;function Ga(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new qa;++t<n;)this.add(e[t])}Ga.prototype.add=Ga.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ga.prototype.has=function(e){return this.__data__.has(e)};const Ha=Ga,Wa=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Ba=function(e,t){return e.has(t)},za=function(e,t,n,r,i,o){var s=1&n,a=e.length,c=t.length;if(a!=c&&!(s&&c>a))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var d=-1,f=!0,p=2&n?new Ha:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var h=e[d],m=t[d];if(r)var y=s?r(m,h,d,t,e,o):r(h,m,d,e,t,o);if(void 0!==y){if(y)continue;f=!1;break}if(p){if(!Wa(t,(function(e,t){if(!Ba(p,t)&&(h===e||i(h,e,n,r,o)))return p.push(t)}))){f=!1;break}}else if(h!==m&&!i(h,m,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f},Va=ts.Uint8Array,Ya=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},Xa=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n};var Ja=ns?ns.prototype:void 0,Qa=Ja?Ja.valueOf:void 0;const Za=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},ec=function(e,t,n){var r=t(e);return gs(e)?r:Za(r,n(e))},tc=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o},nc=function(){return[]};var rc=Object.prototype.propertyIsEnumerable,ic=Object.getOwnPropertySymbols;const oc=ic?function(e){return null==e?[]:(e=Object(e),tc(ic(e),(function(t){return rc.call(e,t)})))}:nc,sc=function(e){return ec(e,Hs,oc)};var ac=Object.prototype.hasOwnProperty;var cc="[object Arguments]",uc="[object Array]",lc="[object Object]",dc=Object.prototype.hasOwnProperty;const fc=function(e,t,n,r,i,o){var s=gs(e),a=gs(t),c=s?uc:$a(e),u=a?uc:$a(t),l=(c=c==cc?lc:c)==lc,d=(u=u==cc?lc:u)==lc,f=c==u;if(f&&ks(e)){if(!ks(t))return!1;s=!0,l=!1}if(f&&!l)return o||(o=new Ka),s||_s(e)?za(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Va(e),new Va(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ea(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=Ya;case"[object Set]":var c=1&r;if(a||(a=Xa),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var l=za(a(e),a(t),r,i,o,s);return s.delete(e),l;case"[object Symbol]":if(Qa)return Qa.call(e)==Qa.call(t)}return!1}(e,t,c,n,r,i,o);if(!(1&n)){var p=l&&dc.call(e,"__wrapped__"),h=d&&dc.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,y=h?t.value():t;return o||(o=new Ka),i(m,y,n,r,o)}}return!!f&&(o||(o=new Ka),function(e,t,n,r,i,o){var s=1&n,a=sc(e),c=a.length;if(c!=sc(t).length&&!s)return!1;for(var u=c;u--;){var l=a[u];if(!(s?l in t:ac.call(t,l)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=s;++u<c;){var m=e[l=a[u]],y=t[l];if(r)var g=s?r(y,m,l,t,e,o):r(m,y,l,e,t,o);if(!(void 0===g?m===y||i(m,y,n,r,o):g)){p=!1;break}h||(h="constructor"==l)}if(p&&!h){var v=e.constructor,T=t.constructor;v==T||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof T&&T instanceof T||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o))},pc=function e(t,n,r,i,o){return t===n||(null==t||null==n||!ls(t)&&!ls(n)?t!=t&&n!=n:fc(t,n,r,i,e,o))},hc=function(e){return e==e&&!Us(e)},mc=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},yc=function(e){var t=function(e){for(var t=Hs(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,hc(i)]}return t}(e);return 1==t.length&&t[0][2]?mc(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var c=(a=n[i])[0],u=e[c],l=a[1];if(s&&a[2]){if(void 0===u&&!(c in e))return!1}else{var d=new Ka;if(r)var f=r(u,l,c,e,t,d);if(!(void 0===f?pc(l,u,3,r,d):f))return!1}}return!0}(n,e,t)}},gc=function(e){return"symbol"==typeof e||ls(e)&&"[object Symbol]"==us(e)};var vc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tc=/^\w*$/;const Rc=function(e,t){if(gs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!gc(e))||Tc.test(e)||!vc.test(e)||null!=t&&e in Object(t)};function kc(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(kc.Cache||qa),n}kc.Cache=qa;var bc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wc=/\\(\\)?/g;const Sc=($c=kc((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(bc,(function(e,n,r,i){t.push(r?i.replace(wc,"$1"):n||e)})),t}),(function(e){return 500===xc.size&&xc.clear(),e})),xc=$c.cache,$c);var $c,xc,Cc=ns?ns.prototype:void 0,Ec=Cc?Cc.toString:void 0;const Ac=function e(t){if("string"==typeof t)return t;if(gs(t))return Vs(t,e)+"";if(gc(t))return Ec?Ec.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},Nc=function(e){return null==e?"":Ac(e)},Dc=function(e,t){return gs(e)?e:Rc(e,t)?[e]:Sc(Nc(e))},_c=function(e){if("string"==typeof e||gc(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Ic=function(e,t){for(var n=0,r=(t=Dc(t,e)).length;null!=e&&n<r;)e=e[_c(t[n++])];return n&&n==r?e:void 0},Pc=function(e,t){return null!=e&&t in Object(e)},Oc=function(e,t,n){for(var r=-1,i=(t=Dc(t,e)).length,o=!1;++r<i;){var s=_c(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ss(i)&&ws(s,i)&&(gs(e)||ys(e))},Lc=function(e,t){return Rc(e)&&hc(t)?mc(_c(e),t):function(n){var r=function(e,t,n){var r=null==e?void 0:Ic(e,t);return void 0===r?n:r}(n,e);return void 0===r&&r===t?function(e,t){return null!=e&&Oc(e,t,Pc)}(n,e):pc(t,r,3)}},Mc=function(e){return Rc(e)?(t=_c(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Ic(t,e)}}(e);var t},Fc=function(e){return"function"==typeof e?e:null==e?Bs:"object"==typeof e?gs(e)?Lc(e[0],e[1]):yc(e):Mc(e)},jc=function(e,t){var n=-1,r=Gs(e)?Array(e.length):[];return Ws(e,(function(e,i,o){r[++n]=t(e,i,o)})),r},qc=function(e,t){return(gs(e)?Vs:jc)(e,Fc(t))};var Uc=Object.prototype.hasOwnProperty;const Kc=function(e,t){return null!=e&&Uc.call(e,t)},Gc=function(e,t){return null!=e&&Oc(e,t,Kc)},Hc=function(){try{var e=ca(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Wc=function(e,t,n){"__proto__"==t&&Hc?Hc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var Bc=Object.prototype.hasOwnProperty;const zc=function(e,t,n){var r=e[t];Bc.call(e,t)&&Ea(r,n)&&(void 0!==n||t in e)||Wc(e,t,n)},Vc=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),i?Wc(n,a,c):zc(n,a,c)}return n};var Yc=Object.prototype.hasOwnProperty;const Xc=function(e){if(!Us(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Ls(e),n=[];for(var r in e)("constructor"!=r||!t&&Yc.call(e,r))&&n.push(r);return n},Jc=function(e){return Gs(e)?Ps(e,!0):Xc(e)};var Qc="object"==typeof exports&&exports&&!exports.nodeType&&exports,Zc=Qc&&"object"==typeof module&&module&&!module.nodeType&&module,eu=Zc&&Zc.exports===Qc?ts.Buffer:void 0,tu=eu?eu.allocUnsafe:void 0;const nu=Ms(Object.getPrototypeOf,Object),ru=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Za(t,oc(e)),e=nu(e);return t}:nc,iu=function(e){return ec(e,Jc,ru)};var ou=Object.prototype.hasOwnProperty;const su=function(e){var t=new e.constructor(e.byteLength);return new Va(t).set(new Va(e)),t};var au=/\w*$/;var cu=ns?ns.prototype:void 0,uu=cu?cu.valueOf:void 0;const lu=function(e,t,n){var r,i=e.constructor;switch(t){case"[object ArrayBuffer]":return su(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var n=t?su(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var n=t?su(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,au.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return r=e,uu?Object(uu.call(r)):{}}};var du=Object.create;const fu=function(){function e(){}return function(t){if(!Us(t))return{};if(du)return du(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var pu=Ns&&Ns.isMap;const hu=pu?xs(pu):function(e){return ls(e)&&"[object Map]"==$a(e)};var mu=Ns&&Ns.isSet;const yu=mu?xs(mu):function(e){return ls(e)&&"[object Set]"==$a(e)};var gu="[object Arguments]",vu="[object Function]",Tu="[object Object]",Ru={};Ru[gu]=Ru["[object Array]"]=Ru["[object ArrayBuffer]"]=Ru["[object DataView]"]=Ru["[object Boolean]"]=Ru["[object Date]"]=Ru["[object Float32Array]"]=Ru["[object Float64Array]"]=Ru["[object Int8Array]"]=Ru["[object Int16Array]"]=Ru["[object Int32Array]"]=Ru["[object Map]"]=Ru["[object Number]"]=Ru[Tu]=Ru["[object RegExp]"]=Ru["[object Set]"]=Ru["[object String]"]=Ru["[object Symbol]"]=Ru["[object Uint8Array]"]=Ru["[object Uint8ClampedArray]"]=Ru["[object Uint16Array]"]=Ru["[object Uint32Array]"]=!0,Ru["[object Error]"]=Ru[vu]=Ru["[object WeakMap]"]=!1;const ku=function e(t,n,r,i,o,s){var a,c=1&n,u=2&n,l=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!Us(t))return t;var d=gs(t);if(d){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ou.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(t),!c)return function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(t,a)}else{var f=$a(t),p=f==vu||"[object GeneratorFunction]"==f;if(ks(t))return function(e,t){if(t)return e.slice();var n=e.length,r=tu?tu(n):new e.constructor(n);return e.copy(r),r}(t,c);if(f==Tu||f==gu||p&&!o){if(a=u||p?{}:function(e){return"function"!=typeof e.constructor||Ls(e)?{}:fu(nu(e))}(t),!c)return u?function(e,t){return Vc(e,ru(e),t)}(t,function(e,t){return e&&Vc(t,Jc(t),e)}(a,t)):function(e,t){return Vc(e,oc(e),t)}(t,function(e,t){return e&&Vc(t,Hs(t),e)}(a,t))}else{if(!Ru[f])return o?t:{};a=lu(t,f,c)}}s||(s=new Ka);var h=s.get(t);if(h)return h;s.set(t,a),yu(t)?t.forEach((function(i){a.add(e(i,n,r,i,t,s))})):hu(t)&&t.forEach((function(i,o){a.set(o,e(i,n,r,o,t,s))}));var m=d?void 0:(l?u?iu:sc:u?Jc:Hs)(t);return Jo(m||t,(function(i,o){m&&(i=t[o=i]),zc(a,o,e(i,n,r,o,t,s))})),a},bu=function(e){return ku(e,4)};function wu(e){function t(){}t.prototype=e;const n=new t;function r(){return typeof n.bar}return r(),r(),e}const Su=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var $u=/\s/;var xu=/^\s+/;const Cu=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&$u.test(e.charAt(t)););return t}(e)+1).replace(xu,""):e};var Eu=/^[-+]0x[0-9a-f]+$/i,Au=/^0b[01]+$/i,Nu=/^0o[0-7]+$/i,Du=parseInt;const _u=function(e){return e?Infinity===(e=function(e){if("number"==typeof e)return e;if(gc(e))return NaN;if(Us(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Us(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Cu(e);var n=Au.test(e);return n||Nu.test(e)?Du(e.slice(2),n?2:8):Eu.test(e)?NaN:+e}(e))||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},Iu=function(e){var t=_u(e),n=t%1;return t==t?n?t-n:t:0},Pu=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:Iu(t),Su(e,t<0?0:t,r)):[]},Ou=function(e){return"string"==typeof e||!gs(e)&&ls(e)&&"[object String]"==us(e)};var Lu=Math.max;const Mu=Hc?function(e,t){return Hc(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Bs;var Fu=Date.now;const ju=(qu=Mu,Uu=0,Ku=0,function(){var e=Fu(),t=16-(e-Ku);if(Ku=e,t>0){if(++Uu>=800)return arguments[0]}else Uu=0;return qu.apply(void 0,arguments)});var qu,Uu,Ku;const Gu=function(e,t){return ju(function(e,t,n){return t=Lu(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Lu(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,a)}}(e,t,Bs),e+"")},Hu=function(e,t,n){if(!Us(n))return!1;var r=typeof t;return!!("number"==r?Gs(n)&&ws(t,n.length):"string"==r&&t in n)&&Ea(n[t],e)};var Wu=Object.prototype.hasOwnProperty;const Bu=(zu=function(e,t){if(Ls(t)||Gs(t))Vc(t,Hs(t),e);else for(var n in t)Wu.call(t,n)&&zc(e,n,t[n])},Gu((function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,o=r>2?t[2]:void 0;for(i=zu.length>3&&"function"==typeof i?(r--,i):void 0,o&&Hu(t[0],t[1],o)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var s=t[n];s&&zu(e,s,n,i)}return e})));var zu;const Vu=function(e,t,n,r){if(!Us(e))return e;for(var i=-1,o=(t=Dc(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var c=_c(t[i]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(i!=s){var l=a[c];void 0===(u=r?r(l,c,a):void 0)&&(u=Us(l)?l:ws(t[i+1])?[]:{})}zc(a,c,u),a=a[c]}return e},Yu=function(e,t){if(null==e)return{};var n=Vs(iu(e),(function(e){return[e]}));return t=Fc(t),function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Ic(e,s);n(a,s)&&Vu(o,Dc(s,e),a)}return o}(e,n,(function(e,n){return t(e,n[0])}))};var Xu=Ns&&Ns.isRegExp;const Ju=Xu?xs(Xu):function(e){return ls(e)&&"[object RegExp]"==us(e)};class Qu{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),zs(this.definition,(t=>{t.accept(e)}))}}class Zu extends Qu{constructor(e){super([]),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}set definition(e){}get definition(){return void 0!==this.referencedRule?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class el extends Qu{constructor(e){super(e.definition),this.orgText="",Bu(this,Yu(e,(e=>void 0!==e)))}}class tl extends Qu{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Bu(this,Yu(e,(e=>void 0!==e)))}}class nl extends Qu{constructor(e){super(e.definition),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}}class rl extends Qu{constructor(e){super(e.definition),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}}class il extends Qu{constructor(e){super(e.definition),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}}class ol extends Qu{constructor(e){super(e.definition),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}}class sl extends Qu{constructor(e){super(e.definition),this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}}class al extends Qu{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Bu(this,Yu(e,(e=>void 0!==e)))}}class cl{constructor(e){this.idx=1,Bu(this,Yu(e,(e=>void 0!==e)))}accept(e){e.visit(this)}}function ul(e){function t(e){return qc(e,ul)}if(e instanceof Zu){const t={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return Ou(e.label)&&(t.label=e.label),t}if(e instanceof tl)return{type:"Alternative",definition:t(e.definition)};if(e instanceof nl)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof rl)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof il)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:ul(new cl({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof sl)return{type:"RepetitionWithSeparator",idx:e.idx,separator:ul(new cl({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof ol)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof al)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof cl){const t={type:"Terminal",name:e.terminalType.name,label:(n=e.terminalType,Ou((r=n).LABEL)&&""!==r.LABEL?n.LABEL:n.name),idx:e.idx};Ou(e.label)&&(t.terminalLabel=e.label);const i=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(t.pattern=Ju(i)?i.source:i),t}var n,r;if(e instanceof el)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}class ll{visit(e){const t=e;switch(t.constructor){case Zu:return this.visitNonTerminal(t);case tl:return this.visitAlternative(t);case nl:return this.visitOption(t);case rl:return this.visitRepetitionMandatory(t);case il:return this.visitRepetitionMandatoryWithSeparator(t);case sl:return this.visitRepetitionWithSeparator(t);case ol:return this.visitRepetition(t);case al:return this.visitAlternation(t);case cl:return this.visitTerminal(t);case el:return this.visitRule(t);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}const dl=function(e,t){var n;return Ws(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n},fl=function(e,t,n){var r=gs(e)?Wa:dl;return n&&Hu(e,t,n)&&(t=void 0),r(e,Fc(t))},pl=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1},hl=function(e){return e!=e},ml=function(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):pl(e,hl,n)};var yl=Math.max;const gl=function(e,t,n,r){e=Gs(e)?e:Ys(e),n=n&&!r?Iu(n):0;var i=e.length;return n<0&&(n=yl(i+n,0)),Ou(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&ml(e,t,n)>-1},vl=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0},Tl=function(e,t){var n=!0;return Ws(e,(function(e,r,i){return n=!!t(e,r,i)})),n},Rl=function(e,t,n){var r=gs(e)?vl:Tl;return n&&Hu(e,t,n)&&(t=void 0),r(e,Fc(t))};function kl(e,t=[]){return!!(e instanceof nl||e instanceof ol||e instanceof sl)||(e instanceof al?fl(e.definition,(e=>kl(e,t))):!(e instanceof Zu&&gl(t,e))&&e instanceof Qu&&(e instanceof Zu&&t.push(e),Rl(e.definition,(e=>kl(e,t)))))}function bl(e){if(e instanceof Zu)return"SUBRULE";if(e instanceof nl)return"OPTION";if(e instanceof al)return"OR";if(e instanceof rl)return"AT_LEAST_ONE";if(e instanceof il)return"AT_LEAST_ONE_SEP";if(e instanceof sl)return"MANY_SEP";if(e instanceof ol)return"MANY";if(e instanceof cl)return"CONSUME";throw Error("non exhaustive match")}class wl{walk(e,t=[]){zs(e.definition,((n,r)=>{const i=Pu(e.definition,r+1);if(n instanceof Zu)this.walkProdRef(n,i,t);else if(n instanceof cl)this.walkTerminal(n,i,t);else if(n instanceof tl)this.walkFlat(n,i,t);else if(n instanceof nl)this.walkOption(n,i,t);else if(n instanceof rl)this.walkAtLeastOne(n,i,t);else if(n instanceof il)this.walkAtLeastOneSep(n,i,t);else if(n instanceof sl)this.walkManySep(n,i,t);else if(n instanceof ol)this.walkMany(n,i,t);else{if(!(n instanceof al))throw Error("non exhaustive match");this.walkOr(n,i,t)}}))}walkTerminal(e,t,n){}walkProdRef(e,t,n){}walkFlat(e,t,n){const r=t.concat(n);this.walk(e,r)}walkOption(e,t,n){const r=t.concat(n);this.walk(e,r)}walkAtLeastOne(e,t,n){const r=[new nl({definition:e.definition})].concat(t,n);this.walk(e,r)}walkAtLeastOneSep(e,t,n){const r=Sl(e,t,n);this.walk(e,r)}walkMany(e,t,n){const r=[new nl({definition:e.definition})].concat(t,n);this.walk(e,r)}walkManySep(e,t,n){const r=Sl(e,t,n);this.walk(e,r)}walkOr(e,t,n){const r=t.concat(n);zs(e.definition,(e=>{const t=new tl({definition:[e]});this.walk(t,r)}))}}function Sl(e,t,n){return[new nl({definition:[new cl({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}const $l=function(e,t){return!(null==e||!e.length)&&ml(e,t,0)>-1},xl=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1},Cl=function(){},El=fa&&1/Xa(new fa([,-0]))[1]==1/0?function(e){return new fa(e)}:Cl,Al=function(e,t,n){var r=-1,i=$l,o=e.length,s=!0,a=[],c=a;if(n)s=!1,i=xl;else if(o>=200){var u=t?null:El(e);if(u)return Xa(u);s=!1,i=Ba,c=new Ha}else c=t?[]:a;e:for(;++r<o;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var f=c.length;f--;)if(c[f]===d)continue e;t&&c.push(d),a.push(l)}else i(c,d,n)||(c!==a&&c.push(d),a.push(l))}return a},Nl=function(e){return e&&e.length?Al(e):[]};var Dl=ns?ns.isConcatSpreadable:void 0;const _l=function(e){return gs(e)||ys(e)||!!(Dl&&e&&e[Dl])},Il=function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=_l),o||(o=[]);++s<a;){var c=t[s];n>0&&r(c)?n>1?e(c,n-1,r,i,o):Za(o,c):i||(o[o.length]=c)}return o},Pl=function(e){return null!=e&&e.length?Il(e,1):[]};function Ol(e){if(e instanceof Zu)return Ol(e.referencedRule);if(e instanceof cl)return[e.terminalType];if(function(e){return e instanceof tl||e instanceof nl||e instanceof ol||e instanceof rl||e instanceof il||e instanceof sl||e instanceof cl||e instanceof el}(e))return function(e){let t=[];const n=e.definition;let r,i=0,o=n.length>i,s=!0;for(;o&&s;)r=n[i],s=kl(r),t=t.concat(Ol(r)),i+=1,o=n.length>i;return Nl(t)}(e);if(function(e){return e instanceof al}(e))return function(e){const t=qc(e.definition,(e=>Ol(e)));return Nl(Pl(t))}(e);throw Error("non exhaustive match")}const Ll="_~IN~_";class Ml extends wl{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,t,n){}walkProdRef(e,t,n){const r=(i=e.referencedRule,o=e.idx,i.name+o+Ll+this.topProd.name);var i,o;const s=t.concat(n),a=Ol(new tl({definition:s}));this.follows[r]=a}}const Fl=function(e){return void 0===e};var jl=Object.prototype,ql=jl.hasOwnProperty;const Ul=Gu((function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&Hu(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=Jc(o),a=-1,c=s.length;++a<c;){var u=s[a],l=e[u];(void 0===l||Ea(l,jl[u])&&!ql.call(e,u))&&(e[u]=o[u])}return e})),Kl=function(e,t){var n=[];return Ws(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n},Gl=function(e,t){return(gs(e)?tc:Kl)(e,function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}(Fc(t)))};var Hl=Math.max;const Wl=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Iu(n);return i<0&&(i=Hl(r+i,0)),ml(e,t,i)},Bl=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n},zl=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n},Vl=function(e,t,n){var r=gs(e)?Bl:zl,i=arguments.length<3;return r(e,Fc(t),n,i,Ws)},Yl=function(e,t){return(gs(e)?tc:Kl)(e,Fc(t))},Xl=function(e){return ls(e)&&Gs(e)},Jl=Gu((function(e,t){return Xl(e)?function(e,t,n,r){var i=-1,o=$l,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;n&&(t=Vs(t,xs(n))),r?(o=xl,s=!1):t.length>=200&&(o=Ba,s=!1,t=new Ha(t));e:for(;++i<a;){var l=e[i],d=null==n?l:n(l);if(l=r||0!==l?l:0,s&&d==d){for(var f=u;f--;)if(t[f]===d)continue e;c.push(l)}else o(t,d,r)||c.push(l)}return c}(e,Il(t,1,Xl,!0)):[]})),Ql=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Zl=function(e){return e&&e.length?e[0]:void 0};var ed=Math.max;const td=(nd=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Iu(n);return i<0&&(i=ed(r+i,0)),pl(e,Fc(t),i)},function(e,t,n){var r=Object(e);if(!Gs(e)){var i=Fc(t);e=Hs(e),t=function(e){return i(r[e],e,r)}}var o=nd(e,t,n);return o>-1?r[i?e[o]:o]:void 0});var nd;function rd(e){console&&console.error&&console.error(`Error: ${e}`)}function id(e){console&&console.warn&&console.warn(`Warning: ${e}`)}let od={};const sd=new Dn;function ad(e){const t=e.toString();if(od.hasOwnProperty(t))return od[t];{const e=sd.pattern(t);return od[t]=e,e}}const cd="Complement Sets are not supported for first char optimization",ud='Unable to use "first char" lexer optimizations:\n';function ld(e,t=!1){try{const t=ad(e);return dd(t.value,{},t.flags.ignoreCase)}catch(n){if(n.message===cd)t&&id(`${ud}\tUnable to optimize: < ${e.toString()} >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let n="";t&&(n="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),rd(`${ud}\n\tFailed parsing: < ${e.toString()} >\n\tUsing the @chevrotain/regexp-to-ast library\n\tPlease open an issue at: https://github.com/chevrotain/chevrotain/issues`+n)}}return[]}function dd(e,t,n){switch(e.type){case"Disjunction":for(let r=0;r<e.value.length;r++)dd(e.value[r],t,n);break;case"Alternative":const r=e.value;for(let e=0;e<r.length;e++){const i=r[e];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const o=i;switch(o.type){case"Character":fd(o.value,t,n);break;case"Set":if(!0===o.complement)throw Error(cd);zs(o.value,(e=>{if("number"==typeof e)fd(e,t,n);else{const r=e;if(!0===n)for(let e=r.from;e<=r.to;e++)fd(e,t,n);else{for(let e=r.from;e<=r.to&&e<Dd;e++)fd(e,t,n);if(r.to>=Dd){const e=r.from>=Dd?r.from:Dd,n=r.to,i=Id(e),o=Id(n);for(let e=i;e<=o;e++)t[e]=e}}}}));break;case"Group":dd(o.value,t,n);break;default:throw Error("Non Exhaustive Match")}const s=void 0!==o.quantifier&&0===o.quantifier.atLeast;if("Group"===o.type&&!1===hd(o)||"Group"!==o.type&&!1===s)break}break;default:throw Error("non exhaustive match!")}return Ys(t)}function fd(e,t,n){const r=Id(e);t[r]=r,!0===n&&function(e,t){const n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){const e=Id(r.charCodeAt(0));t[e]=e}else{const e=n.toLowerCase();if(e!==n){const n=Id(e.charCodeAt(0));t[n]=n}}}(e,t)}function pd(e,t){return td(e.value,(e=>{if("number"==typeof e)return gl(t,e);{const n=e;return void 0!==td(t,(e=>n.from<=e&&e<=n.to))}}))}function hd(e){const t=e.quantifier;return!(!t||0!==t.atLeast)||!!e.value&&(gs(e.value)?Rl(e.value,hd):hd(e.value))}class md extends _n{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}super.visitChildren(e)}}visitCharacter(e){gl(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?void 0===pd(e,this.targetCharCodes)&&(this.found=!0):void 0!==pd(e,this.targetCharCodes)&&(this.found=!0)}}function yd(e,t){if(t instanceof RegExp){const n=ad(t),r=new md(e);return r.visit(n),r.found}return void 0!==td(t,(t=>gl(e,t.charCodeAt(0))))}const gd="PATTERN",vd="defaultMode",Td="modes";let Rd="boolean"==typeof new RegExp("(?:)").sticky;const kd=/[^\\][$]/,bd=/[^\\[][\^]|^\^/;function wd(e){const t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function Sd(e){const t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function $d(e){const t=e.PATTERN;if(Ju(t))return!1;if(Ks(t))return!0;if(Gc(t,"exec"))return!0;if(Ou(t))return!1;throw Error("non exhaustive match")}function xd(e){return!(!Ou(e)||1!==e.length)&&e.charCodeAt(0)}const Cd={test:function(e){const t=e.length;for(let n=this.lastIndex;n<t;n++){const t=e.charCodeAt(n);if(10===t)return this.lastIndex=n+1,!0;if(13===t)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function Ed(e,t){if(Gc(e,"LINE_BREAKS"))return!1;if(Ju(e.PATTERN)){try{yd(t,e.PATTERN)}catch(e){return{issue:Wd.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Ou(e.PATTERN))return!1;if($d(e))return{issue:Wd.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function Ad(e){return qc(e,(e=>Ou(e)?e.charCodeAt(0):e))}function Nd(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}const Dd=256;let _d=[];function Id(e){return e<Dd?e:_d[e]}const Pd=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};function Od(e){const t=(new Date).getTime(),n=e();return{time:(new Date).getTime()-t,value:n}}function Ld(e,t){const n=e.tokenTypeIdx;return n===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[n]}function Md(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let Fd=1;const jd={};function qd(e){const t=function(e){let t=bu(e),n=e,r=!0;for(;r;){n=Ql(Pl(qc(n,(e=>e.CATEGORIES))));const e=Jl(n,t);t=t.concat(e),Ca(e)?r=!1:n=e}return t}(e);!function(e){zs(e,(e=>{Kd(e)||(jd[Fd]=e,e.tokenTypeIdx=Fd++),Gd(e)&&!gs(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Gd(e)||(e.CATEGORIES=[]),Gc(e,"categoryMatches")||(e.categoryMatches=[]),Gc(e,"categoryMatchesMap")||(e.categoryMatchesMap={})}))}(t),function(e){zs(e,(e=>{Ud([],e)}))}(t),function(e){zs(e,(e=>{e.categoryMatches=[],zs(e.categoryMatchesMap,((t,n)=>{e.categoryMatches.push(jd[n].tokenTypeIdx)}))}))}(t),zs(t,(e=>{e.isParent=e.categoryMatches.length>0}))}function Ud(e,t){zs(e,(e=>{t.categoryMatchesMap[e.tokenTypeIdx]=!0})),zs(t.CATEGORIES,(n=>{const r=e.concat(t);gl(r,n)||Ud(r,n)}))}function Kd(e){return Gc(e,"tokenTypeIdx")}function Gd(e){return Gc(e,"CATEGORIES")}function Hd(e){return Gc(e,"tokenTypeIdx")}var Wd;!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",e[e.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"}(Wd||(Wd={}));const Bd={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:{buildUnableToPopLexerModeMessage:e=>`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`,buildUnexpectedCharactersMessage:(e,t,n,r,i)=>`unexpected character: ->${e.charAt(t)}<- at offset: ${t}, skipped ${n} characters.`},traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Bd);class zd{constructor(e,t=Bd){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(e,t)=>{if(!0===this.traceInitPerf){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--\x3e <${e}>`);const{time:r,value:i}=Od(t),o=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${n}<-- <${e}> time: ${r}ms`),this.traceInitIndent--,i}return t()},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Bu({},Bd,t);const n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(()=>{let n,r=!0;this.TRACE_INIT("Lexer Config handling",(()=>{if(this.config.lineTerminatorsPattern===Bd.lineTerminatorsPattern)this.config.lineTerminatorsPattern=Cd;else if(this.config.lineTerminatorCharacters===Bd.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),gs(e)?n={modes:{defaultMode:bu(e)},defaultMode:vd}:(r=!1,n=bu(e))})),!1===this.config.skipValidations&&(this.TRACE_INIT("performRuntimeChecks",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(e,t,n){const r=[];return Gc(e,vd)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+vd+"> property in its definition\n",type:Wd.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Gc(e,Td)||r.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:Wd.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Gc(e,Td)&&Gc(e,vd)&&!Gc(e.modes,e.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${vd}: <${e.defaultMode}>which does not exist\n`,type:Wd.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Gc(e,Td)&&zs(e.modes,((e,t)=>{zs(e,((n,i)=>{if(Fl(n))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${t}> at index: <${i}>\n`,type:Wd.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Gc(n,"LONGER_ALT")){const i=gs(n.LONGER_ALT)?n.LONGER_ALT:[n.LONGER_ALT];zs(i,(i=>{Fl(i)||gl(e,i)||r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${i.name}> on token <${n.name}> outside of mode <${t}>\n`,type:Wd.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})}))}}))})),r}(n,this.trackStartLines,this.config.lineTerminatorCharacters))})),this.TRACE_INIT("performWarningRuntimeChecks",(()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(function(e,t,n){const r=[];let i=!1;const o=Ql(Pl(Ys(e.modes))),s=Gl(o,(e=>e[gd]===zd.NA)),a=Ad(n);return t&&zs(s,(e=>{const t=Ed(e,a);if(!1!==t){const n=function(e,t){if(t.issue===Wd.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <${e.name}> Token Type\n\t Root cause: ${t.errMsg}.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(t.issue===Wd.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <${e.name}> Token Type\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}(e,t),i={message:n,type:t.issue,tokenType:e};r.push(i)}else Gc(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):yd(a,e.PATTERN)&&(i=!0)})),t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:Wd.NO_LINE_BREAKS_FLAGS}),r}(n,this.trackStartLines,this.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},zs(n.modes,((e,t)=>{n.modes[t]=Gl(e,(e=>Fl(e)))}));const i=Hs(n.modes);if(zs(n.modes,((e,n)=>{this.TRACE_INIT(`Mode: <${n}> processing`,(()=>{if(this.modes.push(n),!1===this.config.skipValidations&&this.TRACE_INIT("validatePatterns",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(function(e,t){let n=[];const r=function(e){const t=Yl(e,(e=>!Gc(e,gd)));return{errors:qc(t,(e=>({message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:Wd.MISSING_PATTERN,tokenTypes:[e]}))),valid:Jl(e,t)}}(e);n=n.concat(r.errors);const i=function(e){const t=Yl(e,(e=>{const t=e[gd];return!(Ju(t)||Ks(t)||Gc(t,"exec")||Ou(t))}));return{errors:qc(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Wd.INVALID_PATTERN,tokenTypes:[e]}))),valid:Jl(e,t)}}(r.valid),o=i.valid;return n=n.concat(i.errors),n=n.concat(function(e){let t=[];const n=Yl(e,(e=>Ju(e[gd])));return t=t.concat(function(e){class t extends _n{constructor(){super(...arguments),this.found=!1}visitEndAnchor(e){this.found=!0}}const n=Yl(e,(e=>{const n=e.PATTERN;try{const e=ad(n),r=new t;return r.visit(e),r.found}catch(e){return kd.test(n.source)}}));return qc(n,(e=>({message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Wd.EOI_ANCHOR_FOUND,tokenTypes:[e]})))}(n)),t=t.concat(function(e){class t extends _n{constructor(){super(...arguments),this.found=!1}visitStartAnchor(e){this.found=!0}}const n=Yl(e,(e=>{const n=e.PATTERN;try{const e=ad(n),r=new t;return r.visit(e),r.found}catch(e){return bd.test(n.source)}}));return qc(n,(e=>({message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Wd.SOI_ANCHOR_FOUND,tokenTypes:[e]})))}(n)),t=t.concat(function(e){const t=Yl(e,(e=>{const t=e[gd];return t instanceof RegExp&&(t.multiline||t.global)}));return qc(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Wd.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]})))}(n)),t=t.concat(function(e){const t=[];let n=qc(e,(n=>Vl(e,((e,r)=>(n.PATTERN.source!==r.PATTERN.source||gl(t,r)||r.PATTERN===zd.NA||(t.push(r),e.push(r)),e)),[])));n=Ql(n);const r=Yl(n,(e=>e.length>1));return qc(r,(e=>{const t=qc(e,(e=>e.name));return{message:`The same RegExp pattern ->${Zl(e).PATTERN}<-has been used in all of the following Token Types: ${t.join(", ")} <-`,type:Wd.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}(n)),t=t.concat(function(e){const t=Yl(e,(e=>e.PATTERN.test("")));return qc(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:Wd.EMPTY_MATCH_PATTERN,tokenTypes:[e]})))}(n)),t}(o)),n=n.concat(function(e){const t=Yl(e,(e=>{if(!Gc(e,"GROUP"))return!1;const t=e.GROUP;return t!==zd.SKIPPED&&t!==zd.NA&&!Ou(t)}));return qc(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Wd.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]})))}(o)),n=n.concat(function(e,t){const n=Yl(e,(e=>void 0!==e.PUSH_MODE&&!gl(t,e.PUSH_MODE)));return qc(n,(e=>({message:`Token Type: ->${e.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${e.PUSH_MODE}<-which does not exist`,type:Wd.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]})))}(o,t)),n=n.concat(function(e){const t=[],n=Vl(e,((e,t,n)=>{const r=t.PATTERN;return r===zd.NA||(Ou(r)?e.push({str:r,idx:n,tokenType:t}):Ju(r)&&(i=r,void 0===td([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(e=>-1!==i.source.indexOf(e))))&&e.push({str:r.source,idx:n,tokenType:t})),e;var i}),[]);return zs(e,((e,r)=>{zs(n,(({str:n,idx:i,tokenType:o})=>{if(r<i&&function(e,t){if(Ju(t)){const n=t.exec(e);return null!==n&&0===n.index}if(Ks(t))return t(e,0,[],{});if(Gc(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(n,e.PATTERN)){const n=`Token: ->${o.name}<- can never be matched.\nBecause it appears AFTER the Token Type ->${e.name}<-in the lexer's definition.\nSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:n,type:Wd.UNREACHABLE_PATTERN,tokenTypes:[e,o]})}}))})),t}(o)),n}(e,i))})),Ca(this.lexerDefinitionErrors)){let r;qd(e),this.TRACE_INIT("analyzeTokenTypes",(()=>{r=function(e,t){const n=(t=Ul(t,{useSticky:Rd,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:(e,t)=>t()})).tracer;let r;n("initCharCodeToOptimizedIndexMap",(()=>{!function(){if(Ca(_d)){_d=new Array(65536);for(let e=0;e<65536;e++)_d[e]=e>255?255+~~(e/255):e}}()})),n("Reject Lexer.NA",(()=>{r=Gl(e,(e=>e[gd]===zd.NA))}));let i,o,s,a,c,u,l,d,f,p,h,m=!1;n("Transform Patterns",(()=>{m=!1,i=qc(r,(e=>{const n=e[gd];if(Ju(n)){const e=n.source;return 1!==e.length||"^"===e||"$"===e||"."===e||n.ignoreCase?2!==e.length||"\\"!==e[0]||gl(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],e[1])?t.useSticky?Sd(n):wd(n):e[1]:e}if(Ks(n))return m=!0,{exec:n};if("object"==typeof n)return m=!0,n;if("string"==typeof n){if(1===n.length)return n;{const e=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),r=new RegExp(e);return t.useSticky?Sd(r):wd(r)}}throw Error("non exhaustive match")}))})),n("misc mapping",(()=>{o=qc(r,(e=>e.tokenTypeIdx)),s=qc(r,(e=>{const t=e.GROUP;if(t!==zd.SKIPPED){if(Ou(t))return t;if(Fl(t))return!1;throw Error("non exhaustive match")}})),a=qc(r,(e=>{const t=e.LONGER_ALT;if(t)return gs(t)?qc(t,(e=>Wl(r,e))):[Wl(r,t)]})),c=qc(r,(e=>e.PUSH_MODE)),u=qc(r,(e=>Gc(e,"POP_MODE")))})),n("Line Terminator Handling",(()=>{const e=Ad(t.lineTerminatorCharacters);l=qc(r,(e=>!1)),"onlyOffset"!==t.positionTracking&&(l=qc(r,(t=>Gc(t,"LINE_BREAKS")?!!t.LINE_BREAKS:!1===Ed(t,e)&&yd(e,t.PATTERN))))})),n("Misc Mapping #2",(()=>{d=qc(r,$d),f=qc(i,xd),p=Vl(r,((e,t)=>{const n=t.GROUP;return Ou(n)&&n!==zd.SKIPPED&&(e[n]=[]),e}),{}),h=qc(i,((e,t)=>({pattern:i[t],longerAlt:a[t],canLineTerminator:l[t],isCustom:d[t],short:f[t],group:s[t],push:c[t],pop:u[t],tokenTypeIdx:o[t],tokenType:r[t]})))}));let y=!0,g=[];return t.safeMode||n("First Char Optimization",(()=>{g=Vl(r,((e,n,r)=>{if("string"==typeof n.PATTERN){const t=Id(n.PATTERN.charCodeAt(0));Nd(e,t,h[r])}else if(gs(n.START_CHARS_HINT)){let t;zs(n.START_CHARS_HINT,(n=>{const i=Id("string"==typeof n?n.charCodeAt(0):n);t!==i&&(t=i,Nd(e,i,h[r]))}))}else if(Ju(n.PATTERN))if(n.PATTERN.unicode)y=!1,t.ensureOptimizations&&rd(`${ud}\tUnable to analyze < ${n.PATTERN.toString()} > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const i=ld(n.PATTERN,t.ensureOptimizations);Ca(i)&&(y=!1),zs(i,(t=>{Nd(e,t,h[r])}))}else t.ensureOptimizations&&rd(`${ud}\tTokenType: <${n.name}> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return e}),[])})),{emptyGroups:p,patternIdxToConfig:h,charCodeToPatternIdxToConfig:g,hasCustom:m,canBeOptimized:y}}(e,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})})),this.patternIdxToConfig[n]=r.patternIdxToConfig,this.charCodeToPatternIdxToConfig[n]=r.charCodeToPatternIdxToConfig,this.emptyGroups=Bu({},this.emptyGroups,r.emptyGroups),this.hasCustom=r.hasCustom||this.hasCustom,this.canModeBeOptimized[n]=r.canBeOptimized}}))})),this.defaultMode=n.defaultMode,!Ca(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const e=qc(this.lexerDefinitionErrors,(e=>e.message)).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+e)}zs(this.lexerDefinitionWarning,(e=>{id(e.message)})),this.TRACE_INIT("Choosing sub-methods implementations",(()=>{if(Rd?(this.chopInput=Bs,this.match=this.matchWithTest):(this.updateLastIndex=Cl,this.match=this.matchWithExec),r&&(this.handleModes=Cl),!1===this.trackStartLines&&(this.computeNewColumn=Bs),!1===this.trackEndLines&&(this.updateTokenEndLineColumnLocation=Cl),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else{if(!/onlyOffset/i.test(this.config.positionTracking))throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.createTokenInstance=this.createOffsetOnlyToken}this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)})),this.TRACE_INIT("Failed Optimization Warnings",(()=>{const e=Vl(this.canModeBeOptimized,((e,t,n)=>(!1===t&&e.push(n),e)),[]);if(t.ensureOptimizations&&!Ca(e))throw Error(`Lexer Modes: < ${e.join(", ")} > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.`)})),this.TRACE_INIT("clearRegExpParserCache",(()=>{od={}})),this.TRACE_INIT("toFastProperties",(()=>{wu(this)}))}))}tokenize(e,t=this.defaultMode){if(!Ca(this.lexerDefinitionErrors)){const e=qc(this.lexerDefinitionErrors,(e=>e.message)).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+e)}return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let n,r,i,o,s,a,c,u,l,d,f,p,h,m,y;const g=e,v=g.length;let T=0,R=0;const k=this.hasCustom?0:Math.floor(e.length/10),b=new Array(k),w=[];let S=this.trackStartLines?1:void 0,$=this.trackStartLines?1:void 0;const x=function(e){const t={},n=Hs(e);return zs(n,(n=>{const r=e[n];if(!gs(r))throw Error("non exhaustive match");t[n]=[]})),t}(this.emptyGroups),C=this.trackStartLines,E=this.config.lineTerminatorsPattern;let A=0,N=[],D=[];const _=[],I=[];let P;function O(){return N}function L(e){const t=Id(e),n=D[t];return void 0===n?I:n}Object.freeze(I);const M=e=>{if(1===_.length&&void 0===e.tokenType.PUSH_MODE){const t=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);w.push({offset:e.startOffset,line:e.startLine,column:e.startColumn,length:e.image.length,message:t})}else{_.pop();const e=Pd(_);N=this.patternIdxToConfig[e],D=this.charCodeToPatternIdxToConfig[e],A=N.length;const t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;P=D&&t?L:O}};function F(e){_.push(e),D=this.charCodeToPatternIdxToConfig[e],N=this.patternIdxToConfig[e],A=N.length,A=N.length;const t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;P=D&&t?L:O}let j;F.call(this,t);const q=this.config.recoveryEnabled;for(;T<v;){a=null;const t=g.charCodeAt(T),k=P(t),D=k.length;for(n=0;n<D;n++){j=k[n];const r=j.pattern;c=null;const l=j.short;if(!1!==l?t===l&&(a=r):!0===j.isCustom?(y=r.exec(g,T,b,x),null!==y?(a=y[0],void 0!==y.payload&&(c=y.payload)):a=null):(this.updateLastIndex(r,T),a=this.match(r,e,T)),null!==a){if(s=j.longerAlt,void 0!==s){const t=s.length;for(i=0;i<t;i++){const t=N[s[i]],n=t.pattern;if(u=null,!0===t.isCustom?(y=n.exec(g,T,b,x),null!==y?(o=y[0],void 0!==y.payload&&(u=y.payload)):o=null):(this.updateLastIndex(n,T),o=this.match(n,e,T)),o&&o.length>a.length){a=o,c=u,j=t;break}}}break}}if(null!==a){if(l=a.length,d=j.group,void 0!==d&&(f=j.tokenTypeIdx,p=this.createTokenInstance(a,T,f,j.tokenType,S,$,l),this.handlePayload(p,c),!1===d?R=this.addToken(b,R,p):x[d].push(p)),e=this.chopInput(e,l),T+=l,$=this.computeNewColumn($,l),!0===C&&!0===j.canLineTerminator){let e,t,n=0;E.lastIndex=0;do{e=E.test(a),!0===e&&(t=E.lastIndex-1,n++)}while(!0===e);0!==n&&(S+=n,$=l-t,this.updateTokenEndLineColumnLocation(p,d,t,n,S,$,l))}this.handleModes(j,M,F,p)}else{const t=T,n=S,i=$;let o=!1===q;for(;!1===o&&T<v;)for(e=this.chopInput(e,1),T++,r=0;r<A;r++){const t=N[r],n=t.pattern,i=t.short;if(!1!==i?g.charCodeAt(T)===i&&(o=!0):!0===t.isCustom?o=null!==n.exec(g,T,b,x):(this.updateLastIndex(n,T),o=null!==n.exec(e)),!0===o)break}if(h=T-t,$=this.computeNewColumn($,h),m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(g,t,h,n,i),w.push({offset:t,line:n,column:i,length:h,message:m}),!1===q)break}}return this.hasCustom||(b.length=R),{tokens:b,groups:x,errors:w}}handleModes(e,t,n,r){if(!0===e.pop){const i=e.push;t(r),void 0!==i&&n.call(this,i)}else void 0!==e.push&&n.call(this,e.push)}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,n,r,i,o,s){let a,c;void 0!==t&&(a=n===s-1,c=a?-1:0,1===r&&!0===a||(e.endLine=i+c,e.endColumn=o-1-c))}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}}createStartOnlyToken(e,t,n,r,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:r}}createFullToken(e,t,n,r,i,o,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:o,endColumn:o+s-1,tokenTypeIdx:n,tokenType:r}}addTokenUsingPush(e,t,n){return e.push(n),t}addTokenUsingMemberAccess(e,t,n){return e[t]=n,++t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){null!==t&&(e.payload=t)}matchWithTest(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null}matchWithExec(e,t){const n=e.exec(t);return null!==n?n[0]:null}}function Vd(e){return Yd(e)?e.LABEL:e.name}function Yd(e){return Ou(e.LABEL)&&""!==e.LABEL}zd.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",zd.NA=/NOT_APPLICABLE/;const Xd="categories",Jd="label",Qd="group",Zd="push_mode",ef="pop_mode",tf="longer_alt",nf="line_breaks",rf="start_chars_hint";function of(e){return function(e){const t=e.pattern,n={};if(n.name=e.name,Fl(t)||(n.PATTERN=t),Gc(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.";return Gc(e,Xd)&&(n.CATEGORIES=e[Xd]),qd([n]),Gc(e,Jd)&&(n.LABEL=e[Jd]),Gc(e,Qd)&&(n.GROUP=e[Qd]),Gc(e,ef)&&(n.POP_MODE=e[ef]),Gc(e,Zd)&&(n.PUSH_MODE=e[Zd]),Gc(e,tf)&&(n.LONGER_ALT=e[tf]),Gc(e,nf)&&(n.LINE_BREAKS=e[nf]),Gc(e,rf)&&(n.START_CHARS_HINT=e[rf]),n}(e)}const sf=of({name:"EOF",pattern:zd.NA});function af(e,t,n,r,i,o,s,a){return{image:t,startOffset:n,endOffset:r,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function cf(e,t){return Ld(e,t)}qd([sf]);const uf={buildMismatchTokenMessage:({expected:e,actual:t,previous:n,ruleName:r})=>`Expecting ${Yd(e)?`--\x3e ${Vd(e)} <--`:`token of type --\x3e ${e.name} <--`} but found --\x3e '${t.image}' <--`,buildNotAllInputParsedMessage:({firstRedundant:e,ruleName:t})=>"Redundant input, expecting EOF but found: "+e.image,buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:n,customUserDescription:r,ruleName:i}){const o="Expecting: ",s="\nbut found: '"+Zl(t).image+"'";if(r)return o+r+s;{const t=Vl(e,((e,t)=>e.concat(t)),[]),n=qc(t,(e=>`[${qc(e,(e=>Vd(e))).join(", ")}]`));return o+`one of these possible Token sequences:\n${qc(n,((e,t)=>`  ${t+1}. ${e}`)).join("\n")}`+s}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:n,ruleName:r}){const i="Expecting: ",o="\nbut found: '"+Zl(t).image+"'";return n?i+n+o:i+`expecting at least one iteration which starts with one of these possible Token sequences::\n  <${qc(e,(e=>`[${qc(e,(e=>Vd(e))).join(",")}]`)).join(" ,")}>`+o}};Object.freeze(uf);const lf={buildRuleNotFoundError:(e,t)=>"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"},df={buildDuplicateFoundError(e,t){const n=e.name,r=Zl(t),i=r.idx,o=bl(r),s=(a=r)instanceof cl?a.terminalType.name:a instanceof Zu?a.nonTerminalName:"";var a;let c=`->${o}${i>0?i:""}<- ${s?`with argument: ->${s}<-`:""}\n                  appears more than once (${t.length} times) in the top level rule: ->${n}<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,"\n"),c},buildNamespaceConflictError:e=>`Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter.`,buildAlternationPrefixAmbiguityError(e){const t=qc(e.prefixPath,(e=>Vd(e))).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix\nin <OR${n}> inside <${e.topLevelRule.name}> Rule,\n<${t}> may appears as a prefix path in all these alternatives.\nSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details.`},buildAlternationAmbiguityError(e){const t=qc(e.prefixPath,(e=>Vd(e))).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;let r=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${e.topLevelRule.name}> Rule,\n<${t}> may appears as a prefix path in all these alternatives.\n`;return r+="See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details.",r},buildEmptyRepetitionError(e){let t=bl(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.\nThis could lead to an infinite loop.`},buildTokenNameError:e=>"deprecated",buildEmptyAlternationError:e=>`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}> in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\nOnly the last alternative may be an empty alternative.`,buildTooManyAlternativesError:e=>`An Alternation cannot have more than 256 alternatives:\n<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\n has ${e.alternation.definition.length+1} alternatives.`,buildLeftRecursionError(e){const t=e.topLevelRule.name;return`Left Recursion found in grammar.\nrule: <${t}> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n ${t} --\x3e ${qc(e.leftRecursionPath,(e=>e.name)).concat([t]).join(" --\x3e ")}\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError:e=>"deprecated",buildDuplicateRuleNameError(e){let t;return t=e.topLevelRule instanceof el?e.topLevelRule.name:e.topLevelRule,`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`}};class ff extends ll{constructor(e,t){super(),this.nameToTopRule=e,this.errMsgProvider=t,this.errors=[]}resolveRefs(){zs(Ys(this.nameToTopRule),(e=>{this.currTopLevel=e,e.accept(this)}))}visitNonTerminal(e){const t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{const t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:t,type:Fp.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}const pf=function(e,t){return Il(qc(e,t),1)},hf=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r},mf=function(e,t,n,r){return Ws(e,(function(e,i,o){t(r,e,n(e),o)})),r};var yf=Object.prototype.hasOwnProperty;const gf=(vf=function(e,t,n){yf.call(e,n)?e[n].push(t):Wc(e,n,[t])},function(e,t){var n=gs(e)?hf:mf,r=Tf?Tf():{};return n(e,vf,Fc(t),r)});var vf,Tf;const Rf=function(e,t,n){var r=null==e?0:e.length;return r?(t=n||void 0===t?1:Iu(t),Su(e,0,(t=r-t)<0?0:t)):[]};class kf extends wl{constructor(e,t){super(),this.topProd=e,this.path=t,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=bu(this.path.ruleStack).reverse(),this.occurrenceStack=bu(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,t=[]){this.found||super.walk(e,t)}walkProdRef(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const r=t.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,r)}}updateExpectedNext(){Ca(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class bf extends kf{constructor(e,t){super(e,t),this.path=t,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const e=t.concat(n),r=new tl({definition:e});this.possibleTokTypes=Ol(r),this.found=!0}}}class wf extends wl{constructor(e,t){super(),this.topRule=e,this.occurrence=t,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class Sf extends wf{walkMany(e,t,n){if(e.idx===this.occurrence){const e=Zl(t.concat(n));this.result.isEndOfRule=void 0===e,e instanceof cl&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkMany(e,t,n)}}class $f extends wf{walkManySep(e,t,n){if(e.idx===this.occurrence){const e=Zl(t.concat(n));this.result.isEndOfRule=void 0===e,e instanceof cl&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkManySep(e,t,n)}}class xf extends wf{walkAtLeastOne(e,t,n){if(e.idx===this.occurrence){const e=Zl(t.concat(n));this.result.isEndOfRule=void 0===e,e instanceof cl&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkAtLeastOne(e,t,n)}}class Cf extends wf{walkAtLeastOneSep(e,t,n){if(e.idx===this.occurrence){const e=Zl(t.concat(n));this.result.isEndOfRule=void 0===e,e instanceof cl&&(this.result.token=e.terminalType,this.result.occurrence=e.idx)}else super.walkAtLeastOneSep(e,t,n)}}function Ef(e,t,n=[]){n=bu(n);let r=[],i=0;function o(o){const s=Ef(o.concat(Pu(e,i+1)),t,n);return r.concat(s)}for(;n.length<t&&i<e.length;){const t=e[i];if(t instanceof tl)return o(t.definition);if(t instanceof Zu)return o(t.definition);if(t instanceof nl)r=o(t.definition);else{if(t instanceof rl)return o(t.definition.concat([new ol({definition:t.definition})]));if(t instanceof il)return o([new tl({definition:t.definition}),new ol({definition:[new cl({terminalType:t.separator})].concat(t.definition)})]);if(t instanceof sl){const e=t.definition.concat([new ol({definition:[new cl({terminalType:t.separator})].concat(t.definition)})]);r=o(e)}else if(t instanceof ol){const e=t.definition.concat([new ol({definition:t.definition})]);r=o(e)}else{if(t instanceof al)return zs(t.definition,(e=>{!1===Ca(e.definition)&&(r=o(e.definition))})),r;if(!(t instanceof cl))throw Error("non exhaustive match");n.push(t.terminalType)}}i++}return r.push({partialPath:n,suffixDef:Pu(e,i)}),r}function Af(e,t,n,r){const i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE";let a=!1;const c=t.length,u=c-r-1,l=[],d=[];for(d.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Ca(d);){const e=d.pop();if(e===s){a&&Pd(d).idx<=u&&d.pop();continue}const r=e.def,f=e.idx,p=e.ruleStack,h=e.occurrenceStack;if(Ca(r))continue;const m=r[0];if(m===i){const e={idx:f,def:Pu(r),ruleStack:Rf(p),occurrenceStack:Rf(h)};d.push(e)}else if(m instanceof cl)if(f<c-1){const e=f+1;if(n(t[e],m.terminalType)){const t={idx:e,def:Pu(r),ruleStack:p,occurrenceStack:h};d.push(t)}}else{if(f!==c-1)throw Error("non exhaustive match");l.push({nextTokenType:m.terminalType,nextTokenOccurrence:m.idx,ruleStack:p,occurrenceStack:h}),a=!0}else if(m instanceof Zu){const e=bu(p);e.push(m.nonTerminalName);const t=bu(h);t.push(m.idx);const n={idx:f,def:m.definition.concat(o,Pu(r)),ruleStack:e,occurrenceStack:t};d.push(n)}else if(m instanceof nl){const e={idx:f,def:Pu(r),ruleStack:p,occurrenceStack:h};d.push(e),d.push(s);const t={idx:f,def:m.definition.concat(Pu(r)),ruleStack:p,occurrenceStack:h};d.push(t)}else if(m instanceof rl){const e=new ol({definition:m.definition,idx:m.idx}),t={idx:f,def:m.definition.concat([e],Pu(r)),ruleStack:p,occurrenceStack:h};d.push(t)}else if(m instanceof il){const e=new cl({terminalType:m.separator}),t=new ol({definition:[e].concat(m.definition),idx:m.idx}),n={idx:f,def:m.definition.concat([t],Pu(r)),ruleStack:p,occurrenceStack:h};d.push(n)}else if(m instanceof sl){const e={idx:f,def:Pu(r),ruleStack:p,occurrenceStack:h};d.push(e),d.push(s);const t=new cl({terminalType:m.separator}),n=new ol({definition:[t].concat(m.definition),idx:m.idx}),i={idx:f,def:m.definition.concat([n],Pu(r)),ruleStack:p,occurrenceStack:h};d.push(i)}else if(m instanceof ol){const e={idx:f,def:Pu(r),ruleStack:p,occurrenceStack:h};d.push(e),d.push(s);const t=new ol({definition:m.definition,idx:m.idx}),n={idx:f,def:m.definition.concat([t],Pu(r)),ruleStack:p,occurrenceStack:h};d.push(n)}else if(m instanceof al)for(let e=m.definition.length-1;e>=0;e--){const t={idx:f,def:m.definition[e].definition.concat(Pu(r)),ruleStack:p,occurrenceStack:h};d.push(t),d.push(s)}else if(m instanceof tl)d.push({idx:f,def:m.definition.concat(Pu(r)),ruleStack:p,occurrenceStack:h});else{if(!(m instanceof el))throw Error("non exhaustive match");d.push(Nf(m,f,p,h))}}return l}function Nf(e,t,n,r){const i=bu(n);i.push(e.name);const o=bu(r);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}var Df;function _f(e){if(e instanceof nl||"Option"===e)return Df.OPTION;if(e instanceof ol||"Repetition"===e)return Df.REPETITION;if(e instanceof rl||"RepetitionMandatory"===e)return Df.REPETITION_MANDATORY;if(e instanceof il||"RepetitionMandatoryWithSeparator"===e)return Df.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof sl||"RepetitionWithSeparator"===e)return Df.REPETITION_WITH_SEPARATOR;if(e instanceof al||"Alternation"===e)return Df.ALTERNATION;throw Error("non exhaustive match")}function If(e){const{occurrence:t,rule:n,prodType:r,maxLookahead:i}=e,o=_f(r);return o===Df.ALTERNATION?Kf(t,n,i):Gf(t,n,o,i)}function Pf(e,t,n,r){const i=e.length,o=Rl(e,(e=>Rl(e,(e=>1===e.length))));if(t)return function(t){const r=qc(t,(e=>e.GATE));for(let t=0;t<i;t++){const i=e[t],o=i.length,s=r[t];if(void 0===s||!1!==s.call(this))e:for(let e=0;e<o;e++){const r=i[e],o=r.length;for(let e=0;e<o;e++){const t=this.LA(e+1);if(!1===n(t,r[e]))continue e}return t}}};if(o&&!r){const t=qc(e,(e=>Pl(e))),n=Vl(t,((e,t,n)=>(zs(t,(t=>{Gc(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=n),zs(t.categoryMatches,(t=>{Gc(e,t)||(e[t]=n)}))})),e)),{});return function(){const e=this.LA(1);return n[e.tokenTypeIdx]}}return function(){for(let t=0;t<i;t++){const r=e[t],i=r.length;e:for(let e=0;e<i;e++){const i=r[e],o=i.length;for(let e=0;e<o;e++){const t=this.LA(e+1);if(!1===n(t,i[e]))continue e}return t}}}}function Of(e,t,n){const r=Rl(e,(e=>1===e.length)),i=e.length;if(r&&!n){const t=Pl(e);if(1===t.length&&Ca(t[0].categoryMatches)){const e=t[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===e}}{const e=Vl(t,((e,t,n)=>(e[t.tokenTypeIdx]=!0,zs(t.categoryMatches,(t=>{e[t]=!0})),e)),[]);return function(){const t=this.LA(1);return!0===e[t.tokenTypeIdx]}}}return function(){e:for(let n=0;n<i;n++){const r=e[n],i=r.length;for(let e=0;e<i;e++){const n=this.LA(e+1);if(!1===t(n,r[e]))continue e}return!0}return!1}}!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(Df||(Df={}));class Lf extends wl{constructor(e,t,n){super(),this.topProd=e,this.targetOccurrence=t,this.targetProdType=n}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)}walkOption(e,t,n){this.checkIsTarget(e,Df.OPTION,t,n)||super.walkOption(e,t,n)}walkAtLeastOne(e,t,n){this.checkIsTarget(e,Df.REPETITION_MANDATORY,t,n)||super.walkOption(e,t,n)}walkAtLeastOneSep(e,t,n){this.checkIsTarget(e,Df.REPETITION_MANDATORY_WITH_SEPARATOR,t,n)||super.walkOption(e,t,n)}walkMany(e,t,n){this.checkIsTarget(e,Df.REPETITION,t,n)||super.walkOption(e,t,n)}walkManySep(e,t,n){this.checkIsTarget(e,Df.REPETITION_WITH_SEPARATOR,t,n)||super.walkOption(e,t,n)}}class Mf extends ll{constructor(e,t,n){super(),this.targetOccurrence=e,this.targetProdType=t,this.targetRef=n,this.result=[]}checkIsTarget(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,Df.OPTION)}visitRepetition(e){this.checkIsTarget(e,Df.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Df.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Df.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Df.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Df.ALTERNATION)}}function Ff(e){const t=new Array(e);for(let n=0;n<e;n++)t[n]=[];return t}function jf(e){let t=[""];for(let n=0;n<e.length;n++){const r=e[n],i=[];for(let e=0;e<t.length;e++){const n=t[e];i.push(n+"_"+r.tokenTypeIdx);for(let e=0;e<r.categoryMatches.length;e++){const t="_"+r.categoryMatches[e];i.push(n+t)}}t=i}return t}function qf(e,t,n){for(let r=0;r<e.length;r++){if(r===n)continue;const i=e[r];for(let e=0;e<t.length;e++)if(!0===i[t[e]])return!1}return!0}function Uf(e,t){const n=qc(e,(e=>Ef([e],1))),r=Ff(n.length),i=qc(n,(e=>{const t={};return zs(e,(e=>{const n=jf(e.partialPath);zs(n,(e=>{t[e]=!0}))})),t}));let o=n;for(let e=1;e<=t;e++){const n=o;o=Ff(n.length);for(let s=0;s<n.length;s++){const a=n[s];for(let n=0;n<a.length;n++){const c=a[n].partialPath,u=a[n].suffixDef,l=jf(c);if(qf(i,l,s)||Ca(u)||c.length===t){const e=r[s];if(!1===Hf(e,c)){e.push(c);for(let e=0;e<l.length;e++){const t=l[e];i[s][t]=!0}}}else{const t=Ef(u,e+1,c);o[s]=o[s].concat(t),zs(t,(e=>{const t=jf(e.partialPath);zs(t,(e=>{i[s][e]=!0}))}))}}}}return r}function Kf(e,t,n,r){const i=new Mf(e,Df.ALTERNATION,r);return t.accept(i),Uf(i.result,n)}function Gf(e,t,n,r){const i=new Mf(e,n);t.accept(i);const o=i.result,s=new Lf(t,e,n).startWalking();return Uf([new tl({definition:o}),new tl({definition:s})],r)}function Hf(e,t){e:for(let n=0;n<e.length;n++){const r=e[n];if(r.length===t.length){for(let e=0;e<r.length;e++){const n=t[e],i=r[e];if(!1==(n===i||void 0!==i.categoryMatchesMap[n.tokenTypeIdx]))continue e}return!0}}return!1}function Wf(e){return Rl(e,(e=>Rl(e,(e=>Rl(e,(e=>Ca(e.categoryMatches)))))))}function Bf(e){return`${bl(e)}_#_${e.idx}_#_${zf(e)}`}function zf(e){return e instanceof cl?e.terminalType.name:e instanceof Zu?e.nonTerminalName:""}class Vf extends ll{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function Yf(e,t,n,r=[]){const i=[],o=Xf(t.definition);if(Ca(o))return[];{const t=e.name;gl(o,e)&&i.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:Fp.LEFT_RECURSION,ruleName:t});const s=Jl(o,r.concat([e])),a=pf(s,(t=>{const i=bu(r);return i.push(t),Yf(e,t,n,i)}));return i.concat(a)}}function Xf(e){let t=[];if(Ca(e))return t;const n=Zl(e);if(n instanceof Zu)t.push(n.referencedRule);else if(n instanceof tl||n instanceof nl||n instanceof rl||n instanceof il||n instanceof sl||n instanceof ol)t=t.concat(Xf(n.definition));else if(n instanceof al)t=Pl(qc(n.definition,(e=>Xf(e.definition))));else if(!(n instanceof cl))throw Error("non exhaustive match");const r=kl(n),i=e.length>1;if(r&&i){const n=Pu(e);return t.concat(Xf(n))}return t}class Jf extends ll{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}class Qf extends ll{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}const Zf="MismatchedTokenException",ep="NoViableAltException",tp="EarlyExitException",np="NotAllInputParsedException",rp=[Zf,ep,tp,np];function ip(e){return gl(rp,e.name)}Object.freeze(rp);class op extends Error{constructor(e,t){super(e),this.token=t,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class sp extends op{constructor(e,t,n){super(e,t),this.previousToken=n,this.name=Zf}}class ap extends op{constructor(e,t,n){super(e,t),this.previousToken=n,this.name=ep}}class cp extends op{constructor(e,t){super(e,t),this.name=np}}class up extends op{constructor(e,t,n){super(e,t),this.previousToken=n,this.name=tp}}const lp={},dp="InRuleRecoveryException";class fp extends Error{constructor(e){super(e),this.name=dp}}function pp(e,t,n,r,i,o,s){const a=this.getKeyForAutomaticLookahead(r,i);let c=this.firstAfterRepMap[a];if(void 0===c){const e=this.getCurrRuleFullName();c=new o(this.getGAstProductions()[e],i).startWalking(),this.firstAfterRepMap[a]=c}let u=c.token,l=c.occurrence;const d=c.isEndOfRule;1===this.RULE_STACK.length&&d&&void 0===u&&(u=sf,l=1),void 0!==u&&void 0!==l&&this.shouldInRepetitionRecoveryBeTried(u,l,s)&&this.tryInRepetitionRecovery(e,t,n,u)}const hp=1024,mp=1280,yp=1536;function gp(e,t,n){return n|t|e}class vp{constructor(e){var t;this.maxLookahead=null!==(t=null==e?void 0:e.maxLookahead)&&void 0!==t?t:Lp.maxLookahead}validate(e){const t=this.validateNoLeftRecursion(e.rules);if(Ca(t)){const n=this.validateEmptyOrAlternatives(e.rules),r=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),i=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...t,...n,...r,...i]}return t}validateNoLeftRecursion(e){return pf(e,(e=>Yf(e,e,df)))}validateEmptyOrAlternatives(e){return pf(e,(e=>function(e,t){const n=new Jf;e.accept(n);const r=n.alternations;return pf(r,(n=>{const r=Rf(n.definition);return pf(r,((r,i)=>{const o=Af([r],[],Ld,1);return Ca(o)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:i}),type:Fp.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:i+1}]:[]}))}))}(e,df)))}validateAmbiguousAlternationAlternatives(e,t){return pf(e,(e=>function(e,t,n){const r=new Jf;e.accept(r);let i=r.alternations;i=Gl(i,(e=>!0===e.ignoreAmbiguities));const o=pf(i,(r=>{const i=r.idx,o=r.maxLookahead||t,s=Kf(i,e,o,r),a=function(e,t,n,r){const i=[],o=Vl(e,((n,r,o)=>(!0===t.definition[o].ignoreAmbiguities||zs(r,(r=>{const s=[o];zs(e,((e,n)=>{o!==n&&Hf(e,r)&&!0!==t.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!Hf(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n)),[]);return qc(o,(e=>{const i=qc(e.alts,(e=>e+1));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:Fp.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:e.alts}}))}(s,r,e,n),c=function(e,t,n,r){const i=Vl(e,((e,t,n)=>{const r=qc(t,(e=>({idx:n,path:e})));return e.concat(r)}),[]);return Ql(pf(i,(e=>{if(!0===t.definition[e.idx].ignoreAmbiguities)return[];const o=e.idx,s=e.path,a=Yl(i,(e=>{return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<o&&(n=e.path,r=s,n.length<r.length&&Rl(n,((e,t)=>{const n=r[t];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})));var n,r}));return qc(a,(e=>{const i=[e.idx+1,o+1],s=0===t.idx?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:Fp.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:s,alternatives:i}}))})))}(s,r,e,n);return a.concat(c)}));return o}(e,t,df)))}validateSomeNonEmptyLookaheadPath(e,t){return function(e,t,n){const r=[];return zs(e,(e=>{const i=new Qf;e.accept(i);const o=i.allProductions;zs(o,(i=>{const o=_f(i),s=i.maxLookahead||t,a=Gf(i.idx,e,o,s)[0];if(Ca(Pl(a))){const t=n.buildEmptyRepetitionError({topLevelRule:e,repetition:i});r.push({message:t,type:Fp.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),r}(e,t,df)}buildLookaheadForAlternation(e){return function(e,t,n,r,i,o){const s=Kf(e,t,n);return o(s,r,Wf(s)?Md:Ld,i)}(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,Pf)}buildLookaheadForOptional(e){return function(e,t,n,r,i,o){const s=Gf(e,t,i,n),a=Wf(s)?Md:Ld;return o(s[0],a,r)}(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,_f(e.prodType),Of)}}const Tp=new class extends ll{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}};function Rp(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset)}function kp(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==1&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}const bp="name";function wp(e,t){Object.defineProperty(e,bp,{enumerable:!1,configurable:!0,writable:!1,value:t})}function Sp(e,t){const n=Hs(e),r=n.length;for(let i=0;i<r;i++){const r=e[n[i]],o=r.length;for(let e=0;e<o;e++){const n=r[e];void 0===n.tokenTypeIdx&&this[n.name](n.children,t)}}}var $p;!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}($p||($p={}));const xp={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(xp);const Cp=Math.pow(2,8)-1,Ep=of({name:"RECORDING_PHASE_TOKEN",pattern:zd.NA});qd([Ep]);const Ap=af(Ep,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(Ap);const Np={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}};function Dp(e,t,n,r=!1){Pp(n);const i=Pd(this.recordingProdStack),o=Ks(t)?t:t.DEF,s=new e({definition:[],idx:n});return r&&(s.separator=t.SEP),Gc(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),xp}function _p(e,t){Pp(t);const n=Pd(this.recordingProdStack),r=!1===gs(e),i=!1===r?e:e.DEF,o=new al({definition:[],idx:t,ignoreAmbiguities:r&&!0===e.IGNORE_AMBIGUITIES});Gc(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD);const s=fl(i,(e=>Ks(e.GATE)));return o.hasPredicates=s,n.definition.push(o),zs(i,(e=>{const t=new tl({definition:[]});o.definition.push(t),Gc(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Gc(e,"GATE")&&(t.ignoreAmbiguities=!0),this.recordingProdStack.push(t),e.ALT.call(this),this.recordingProdStack.pop()})),xp}function Ip(e){return 0===e?"":`${e}`}function Pp(e){if(e<0||e>Cp){const t=new Error(`Invalid DSL Method idx value: <${e}>\n\tIdx value must be a none negative value smaller than ${Cp+1}`);throw t.KNOWN_RECORDER_ERROR=!0,t}}const Op=af(sf,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Op);const Lp=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:uf,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Mp=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Fp,jp,qp;function Up(e=void 0){return function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",e[e.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"}(Fp||(Fp={}));class Kp{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.\t\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",(()=>{let e;this.selfAnalysisDone=!0;const t=this.className;this.TRACE_INIT("toFastProps",(()=>{wu(this)})),this.TRACE_INIT("Grammar Recording",(()=>{try{this.enableRecording(),zs(this.definedRulesNames,(e=>{const t=this[e].originalGrammarAction;let n;this.TRACE_INIT(`${e} Rule`,(()=>{n=this.topLevelRuleRecord(e,t)})),this.gastProductionsCache[e]=n}))}finally{this.disableRecording()}}));let n=[];if(this.TRACE_INIT("Grammar Resolving",(()=>{n=function(e){const t=Ul(e,{errMsgProvider:lf}),n={};return zs(e.rules,(e=>{n[e.name]=e})),function(e,t){const n=new ff(e,t);return n.resolveRefs(),n.errors}(n,t.errMsgProvider)}({rules:Ys(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(n)})),this.TRACE_INIT("Grammar Validations",(()=>{if(Ca(n)&&!1===this.skipValidations){const n=(e={rules:Ys(this.gastProductionsCache),tokenTypes:Ys(this.tokensMap),errMsgProvider:df,grammarName:t},function(e,t,n,r){const i=pf(e,(e=>function(e,t){const n=new Vf;e.accept(n);const r=n.allProductions,i=gf(r,Bf),o=Yu(i,(e=>e.length>1));return qc(Ys(o),(n=>{const r=Zl(n),i=t.buildDuplicateFoundError(e,n),o=bl(r),s={message:i,type:Fp.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:o,occurrence:r.idx},a=zf(r);return a&&(s.parameter=a),s}))}(e,n))),o=function(e,t,n){const r=[],i=qc(t,(e=>e.name));return zs(e,(e=>{const t=e.name;if(gl(i,t)){const i=n.buildNamespaceConflictError(e);r.push({message:i,type:Fp.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),r}(e,t,n),s=pf(e,(e=>function(e,t){const n=new Jf;e.accept(n);const r=n.alternations;return pf(r,(n=>n.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:Fp.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}]:[]))}(e,n))),a=pf(e,(t=>function(e,t,n,r){const i=[],o=Vl(t,((t,n)=>n.name===e.name?t+1:t),0);if(o>1){const t=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:t,type:Fp.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}(t,e,r,n)));return i.concat(o,s,a)}((e=Ul(e,{errMsgProvider:df})).rules,e.tokenTypes,e.errMsgProvider,e.grammarName)),r=function(e){const t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return qc(t,(e=>Object.assign({type:Fp.CUSTOM_LOOKAHEAD_VALIDATION},e)))}({lookaheadStrategy:this.lookaheadStrategy,rules:Ys(this.gastProductionsCache),tokenTypes:Ys(this.tokensMap),grammarName:t});this.definitionErrors=this.definitionErrors.concat(n,r)}var e})),Ca(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",(()=>{const e=function(e){const t={};return zs(e,(e=>{const n=new Ml(e).startWalking();Bu(t,n)})),t}(Ys(this.gastProductionsCache));this.resyncFollows=e})),this.TRACE_INIT("ComputeLookaheadFunctions",(()=>{var e,t;null===(t=(e=this.lookaheadStrategy).initialize)||void 0===t||t.call(e,{rules:Ys(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(Ys(this.gastProductionsCache))}))),!Kp.DEFER_DEFINITION_ERRORS_HANDLING&&!Ca(this.definitionErrors))throw e=qc(this.definitionErrors,(e=>e.message)),new Error(`Parser Definition Errors detected:\n ${e.join("\n-------------------------------\n")}`)}))}constructor(e,t){this.definitionErrors=[],this.selfAnalysisDone=!1;const n=this;if(n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),Gc(t,"ignoredIssues"))throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\tSee: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\tFor further details.");this.skipValidations=Gc(t,"skipValidations")?t.skipValidations:Lp.skipValidations}}Kp.DEFER_DEFINITION_ERRORS_HANDLING=!1,jp=Kp,qp=[class{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Gc(e,"recoveryEnabled")?e.recoveryEnabled:Lp.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=pp)}getTokenToInsert(e){const t=af(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,t,n,r){const i=this.findReSyncTokenType(),o=this.exportLexerState(),s=[];let a=!1;const c=this.LA(1);let u=this.LA(1);const l=()=>{const e=this.LA(0),t=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:c,previous:e,ruleName:this.getCurrRuleFullName()}),n=new sp(t,c,this.LA(0));n.resyncedTokens=Rf(s),this.SAVE_ERROR(n)};for(;!a;){if(this.tokenMatcher(u,r))return void l();if(n.call(this))return l(),void e.apply(this,t);this.tokenMatcher(u,i)?a=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,s))}this.importLexerState(o)}shouldInRepetitionRecoveryBeTried(e,t,n){return!1!==n&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))}getFollowsForInRuleRecovery(e,t){const n=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(n)}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const e=this.SKIP_TOKEN();return this.consumeToken(),e}throw new fp("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(Ca(t))return!1;const n=this.LA(1);return void 0!==td(t,(e=>this.tokenMatcher(n,e)))}canRecoverWithSingleTokenDeletion(e){return!!this.canTokenTypeBeDeletedInRecovery(e)&&this.tokenMatcher(this.LA(2),e)}isInCurrentRuleReSyncSet(e){const t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return gl(n,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let t=this.LA(1),n=2;for(;;){const r=td(e,(e=>cf(t,e)));if(void 0!==r)return r;t=this.LA(n),n++}}getCurrFollowKey(){if(1===this.RULE_STACK.length)return lp;const e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,t=this.RULE_OCCURRENCE_STACK;return qc(e,((n,r)=>0===r?lp:{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:t[r],inRule:this.shortRuleNameToFullName(e[r-1])}))}flattenFollowSet(){const e=qc(this.buildFullFollowKeyStack(),(e=>this.getFollowSetFromFollowKey(e)));return Pl(e)}getFollowSetFromFollowKey(e){if(e===lp)return[sf];const t=e.ruleName+e.idxInCallingRule+Ll+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){return this.tokenMatcher(e,sf)||t.push(e),t}reSyncTo(e){const t=[];let n=this.LA(1);for(;!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return Rf(t)}attemptInRepetitionRecovery(e,t,n,r,i,o,s){}getCurrentGrammarPath(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:bu(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}}getHumanReadableRuleStack(){return qc(this.RULE_STACK,(e=>this.shortRuleNameToFullName(e)))}},class{initLooksAhead(e){this.dynamicTokensEnabled=Gc(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Lp.dynamicTokensEnabled,this.maxLookahead=Gc(e,"maxLookahead")?e.maxLookahead:Lp.maxLookahead,this.lookaheadStrategy=Gc(e,"lookaheadStrategy")?e.lookaheadStrategy:new vp({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){zs(e,(e=>{this.TRACE_INIT(`${e.name} Rule Lookahead`,(()=>{const{alternation:t,repetition:n,option:r,repetitionMandatory:i,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:s}=function(e){Tp.reset(),e.accept(Tp);const t=Tp.dslMethods;return Tp.reset(),t}(e);zs(t,(t=>{const n=0===t.idx?"":t.idx;this.TRACE_INIT(`${bl(t)}${n}`,(()=>{const n=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:t.idx,rule:e,maxLookahead:t.maxLookahead||this.maxLookahead,hasPredicates:t.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),r=gp(this.fullRuleNameToShort[e.name],256,t.idx);this.setLaFuncCache(r,n)}))})),zs(n,(t=>{this.computeLookaheadFunc(e,t.idx,768,"Repetition",t.maxLookahead,bl(t))})),zs(r,(t=>{this.computeLookaheadFunc(e,t.idx,512,"Option",t.maxLookahead,bl(t))})),zs(i,(t=>{this.computeLookaheadFunc(e,t.idx,hp,"RepetitionMandatory",t.maxLookahead,bl(t))})),zs(o,(t=>{this.computeLookaheadFunc(e,t.idx,yp,"RepetitionMandatoryWithSeparator",t.maxLookahead,bl(t))})),zs(s,(t=>{this.computeLookaheadFunc(e,t.idx,mp,"RepetitionWithSeparator",t.maxLookahead,bl(t))}))}))}))}computeLookaheadFunc(e,t,n,r,i,o){this.TRACE_INIT(`${o}${0===t?"":t}`,(()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:i||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r}),s=gp(this.fullRuleNameToShort[e.name],n,t);this.setLaFuncCache(s,o)}))}getKeyForAutomaticLookahead(e,t){return gp(this.getLastExplicitRuleShortName(),e,t)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}},class{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Gc(e,"nodeLocationTracking")?e.nodeLocationTracking:Lp.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=kp,this.setNodeLocationFromNode=kp,this.cstPostRule=Cl,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Cl,this.setNodeLocationFromNode=Cl,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Rp,this.setNodeLocationFromNode=Rp,this.cstPostRule=Cl,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Cl,this.setNodeLocationFromNode=Cl,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`);this.setNodeLocationFromToken=Cl,this.setNodeLocationFromNode=Cl,this.cstPostRule=Cl,this.setInitialNodeLocation=Cl}else this.cstInvocationStateUpdate=Cl,this.cstFinallyStateUpdate=Cl,this.cstPostTerminal=Cl,this.cstPostNonTerminal=Cl,this.cstPostRule=Cl}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t),this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==1?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)}cstPostRuleOnlyOffset(e){const t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==1?n.endOffset=t.endOffset:n.startOffset=NaN}cstPostTerminal(e,t){const n=this.CST_STACK[this.CST_STACK.length-1];var r,i,o;i=t,o=e,void 0===(r=n).children[o]?r.children[o]=[i]:r.children[o].push(i),this.setNodeLocationFromToken(n.location,t)}cstPostNonTerminal(e,t){const n=this.CST_STACK[this.CST_STACK.length-1];!function(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)}(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}getBaseCstVisitorConstructor(){if(Fl(this.baseCstVisitorConstructor)){const e=function(e,t){const n=function(){};wp(n,e+"BaseSemantics");const r={visit:function(e,t){if(gs(e)&&(e=e[0]),!Fl(e))return this[e.name](e.children,t)},validateVisitor:function(){const e=function(e,t){const n=function(e,t){const n=Yl(t,(t=>!1===Ks(e[t]))),r=qc(n,(t=>({msg:`Missing visitor method: <${t}> on ${e.constructor.name} CST Visitor.`,type:$p.MISSING_METHOD,methodName:t})));return Ql(r)}(e,t);return n}(this,t);if(!Ca(e)){const t=qc(e,(e=>e.msg));throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:\n\t${t.join("\n\n").replace(/\n/g,"\n\t")}`)}}};return(n.prototype=r).constructor=n,n._RULE_NAMES=t,n}(this.className,Hs(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(Fl(this.baseCstVisitorWithDefaultsConstructor)){const e=function(e,t,n){const r=function(){};wp(r,e+"BaseSemanticsWithDefaults");const i=Object.create(n.prototype);return zs(t,(e=>{i[e]=Sp})),(r.prototype=i).constructor=r,r}(this.className,Hs(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}},class{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Op}LA(e){const t=this.currIdx+e;return t<0||this.tokVectorLength<=t?Op:this.tokVector[t]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}},class{initRecognizerEngine(e,t){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Md,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Gc(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(gs(e)){if(Ca(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(gs(e))this.tokensMap=Vl(e,((e,t)=>(e[t.name]=t,e)),{});else if(Gc(e,"modes")&&Rl(Pl(Ys(e.modes)),Hd)){const t=Pl(Ys(e.modes)),n=Nl(t);this.tokensMap=Vl(n,((e,t)=>(e[t.name]=t,e)),{})}else{if(!Us(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=bu(e)}this.tokensMap.EOF=sf;const n=Gc(e,"modes")?Pl(Ys(e.modes)):Ys(e),r=Rl(n,(e=>Ca(e.categoryMatches)));this.tokenMatcher=r?Md:Ld,qd(Ys(this.tokensMap))}defineRule(e,t,n){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const r=Gc(n,"resyncEnabled")?n.resyncEnabled:Mp.resyncEnabled,i=Gc(n,"recoveryValueFunc")?n.recoveryValueFunc:Mp.recoveryValueFunc,o=this.ruleShortNameIdx<<12;let s;return this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o,s=!0===this.outputCst?function(...n){try{this.ruleInvocationStateUpdate(o,e,this.subruleIdx),t.apply(this,n);const r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}catch(e){return this.invokeRuleCatch(e,r,i)}finally{this.ruleFinallyStateUpdate()}}:function(...n){try{return this.ruleInvocationStateUpdate(o,e,this.subruleIdx),t.apply(this,n)}catch(e){return this.invokeRuleCatch(e,r,i)}finally{this.ruleFinallyStateUpdate()}},Object.assign(s,{ruleName:e,originalGrammarAction:t})}invokeRuleCatch(e,t,n){const r=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(ip(e)){const t=e;if(i){const r=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(r)){if(t.resyncedTokens=this.reSyncTo(r),this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];return e.recoveredNode=!0,e}return n(e)}if(this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];e.recoveredNode=!0,t.partialCstResult=e}throw t}if(r)return this.moveToTerminatedState(),n(e);throw t}throw e}optionInternal(e,t){const n=this.getKeyForAutomaticLookahead(512,t);return this.optionInternalLogic(e,t,n)}optionInternalLogic(e,t,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof e){r=e.DEF;const t=e.GATE;if(void 0!==t){const e=i;i=()=>t.call(this)&&e.call(this)}}else r=e;if(!0===i.call(this))return r.call(this)}atLeastOneInternal(e,t){const n=this.getKeyForAutomaticLookahead(hp,e);return this.atLeastOneInternalLogic(e,t,n)}atLeastOneInternalLogic(e,t,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof t){r=t.DEF;const e=t.GATE;if(void 0!==e){const t=i;i=()=>e.call(this)&&t.call(this)}}else r=t;if(!0!==i.call(this))throw this.raiseEarlyExitException(e,Df.REPETITION_MANDATORY,t.ERR_MSG);{let e=this.doSingleRepetition(r);for(;!0===i.call(this)&&!0===e;)e=this.doSingleRepetition(r)}this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,hp,e,xf)}atLeastOneSepFirstInternal(e,t){const n=this.getKeyForAutomaticLookahead(yp,e);this.atLeastOneSepFirstInternalLogic(e,t,n)}atLeastOneSepFirstInternalLogic(e,t,n){const r=t.DEF,i=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,Df.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);{r.call(this);const t=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,t,r,Cf],t,yp,e,Cf)}}manyInternal(e,t){const n=this.getKeyForAutomaticLookahead(768,e);return this.manyInternalLogic(e,t,n)}manyInternalLogic(e,t,n){let r,i=this.getLaFuncFromCache(n);if("function"!=typeof t){r=t.DEF;const e=t.GATE;if(void 0!==e){const t=i;i=()=>e.call(this)&&t.call(this)}}else r=t;let o=!0;for(;!0===i.call(this)&&!0===o;)o=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,768,e,Sf,o)}manySepFirstInternal(e,t){const n=this.getKeyForAutomaticLookahead(mp,e);this.manySepFirstInternalLogic(e,t,n)}manySepFirstInternalLogic(e,t,n){const r=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){r.call(this);const t=()=>this.tokenMatcher(this.LA(1),i);for(;!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,t,r,$f],t,mp,e,$f)}}repetitionSepSecondInternal(e,t,n,r,i){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,i],n,yp,e,i)}doSingleRepetition(e){const t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t}orInternal(e,t){const n=this.getKeyForAutomaticLookahead(256,t),r=gs(e)?e:e.DEF,i=this.getLaFuncFromCache(n).call(this,r);if(void 0!==i)return r[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){const e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new cp(t,e))}}subruleInternal(e,t,n){let r;try{const i=void 0!==n?n.ARGS:void 0;return this.subruleIdx=t,r=e.apply(this,i),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:e.ruleName),r}catch(t){throw this.subruleInternalError(t,n,e.ruleName)}}subruleInternalError(e,t,n){throw ip(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e}consumeInternal(e,t,n){let r;try{const t=this.LA(1);!0===this.tokenMatcher(t,e)?(this.consumeToken(),r=t):this.consumeInternalError(e,t,n)}catch(n){r=this.consumeInternalRecovery(e,t,n)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:e.name,r),r}consumeInternalError(e,t,n){let r;const i=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new sp(r,t,i))}consumeInternalRecovery(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;{const r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(e){throw e.name===dp?n:e}}}saveRecogState(){const e=this.errors,t=bu(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t)}isBackTracking(){return 0!==this.isBackTrackingStack.length}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),sf)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}},class{ACTION(e){return e.call(this)}consume(e,t,n){return this.consumeInternal(t,e,n)}subrule(e,t,n){return this.subruleInternal(t,e,n)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,n=Mp){if(gl(this.definedRulesNames,e)){const t={message:df.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:Fp.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(t)}this.definedRulesNames.push(e);const r=this.defineRule(e,t,n);return this[e]=r,r}OVERRIDE_RULE(e,t,n=Mp){const r=function(e,t,n){const r=[];let i;return gl(t,e)||(i=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,r.push({message:i,type:Fp.INVALID_RULE_OVERRIDE,ruleName:e})),r}(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const i=this.defineRule(e,t,n);return this[e]=i,i}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);const n=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(ip(e))return!1;throw e}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return e=Ys(this.gastProductionsCache),qc(e,ul);var e}},class{initErrorHandler(e){this._errors=[],this.errorMessageProvider=Gc(e,"errorMessageProvider")?e.errorMessageProvider:Lp.errorMessageProvider}SAVE_ERROR(e){if(ip(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:bu(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return bu(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,n){const r=this.getCurrRuleFullName(),i=Gf(e,this.getGAstProductions()[r],t,this.maxLookahead)[0],o=[];for(let e=1;e<=this.maxLookahead;e++)o.push(this.LA(e));const s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new up(s,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){const n=this.getCurrRuleFullName(),r=Kf(e,this.getGAstProductions()[n],this.maxLookahead),i=[];for(let e=1;e<=this.maxLookahead;e++)i.push(this.LA(e));const o=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:i,previous:o,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new ap(s,this.LA(1),o))}},class{initContentAssist(){}computeContentAssist(e,t){const n=this.gastProductionsCache[e];if(Fl(n))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return Af([n],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const t=Zl(e.ruleStack),n=this.getGAstProductions()[t];return new bf(n,e).startWalking()}},class{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(()=>{for(let e=0;e<10;e++){const t=e>0?e:"";this[`CONSUME${t}`]=function(t,n){return this.consumeInternalRecord(t,e,n)},this[`SUBRULE${t}`]=function(t,n){return this.subruleInternalRecord(t,e,n)},this[`OPTION${t}`]=function(t){return this.optionInternalRecord(t,e)},this[`OR${t}`]=function(t){return this.orInternalRecord(t,e)},this[`MANY${t}`]=function(t){this.manyInternalRecord(e,t)},this[`MANY_SEP${t}`]=function(t){this.manySepFirstInternalRecord(e,t)},this[`AT_LEAST_ONE${t}`]=function(t){this.atLeastOneInternalRecord(e,t)},this[`AT_LEAST_ONE_SEP${t}`]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}}this.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},this.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},this.option=function(e,t){return this.optionInternalRecord(t,e)},this.or=function(e,t){return this.orInternalRecord(t,e)},this.many=function(e,t){this.manyInternalRecord(e,t)},this.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD}))}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(()=>{const e=this;for(let t=0;t<10;t++){const n=t>0?t:"";delete e[`CONSUME${n}`],delete e[`SUBRULE${n}`],delete e[`OPTION${n}`],delete e[`OR${n}`],delete e[`MANY${n}`],delete e[`MANY_SEP${n}`],delete e[`AT_LEAST_ONE${n}`],delete e[`AT_LEAST_ONE_SEP${n}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>!0}LA_RECORD(e){return Op}topLevelRuleRecord(e,t){try{const n=new el({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://chevrotain.io/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}}optionInternalRecord(e,t){return Dp.call(this,nl,e,t)}atLeastOneInternalRecord(e,t){Dp.call(this,rl,t,e)}atLeastOneSepFirstInternalRecord(e,t){Dp.call(this,il,t,e,!0)}manyInternalRecord(e,t){Dp.call(this,ol,t,e)}manySepFirstInternalRecord(e,t){Dp.call(this,sl,t,e,!0)}orInternalRecord(e,t){return _p.call(this,e,t)}subruleInternalRecord(e,t,n){if(Pp(t),!e||!1===Gc(e,"ruleName")){const n=new Error(`<SUBRULE${Ip(t)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>\n inside top level rule: <${this.recordingProdStack[0].name}>`);throw n.KNOWN_RECORDER_ERROR=!0,n}const r=Pd(this.recordingProdStack),i=e.ruleName,o=new Zu({idx:t,nonTerminalName:i,label:null==n?void 0:n.LABEL,referencedRule:void 0});return r.definition.push(o),this.outputCst?Np:xp}consumeInternalRecord(e,t,n){if(Pp(t),!Kd(e)){const n=new Error(`<CONSUME${Ip(t)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>\n inside top level rule: <${this.recordingProdStack[0].name}>`);throw n.KNOWN_RECORDER_ERROR=!0,n}const r=Pd(this.recordingProdStack),i=new cl({idx:t,terminalType:e,label:null==n?void 0:n.LABEL});return r.definition.push(i),Ap}},class{initPerformanceTracer(e){if(Gc(e,"traceInitPerf")){const t=e.traceInitPerf,n="number"==typeof t;this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Lp.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--\x3e <${e}>`);const{time:r,value:i}=Od(t),o=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(`${n}<-- <${e}> time: ${r}ms`),this.traceInitIndent--,i}return t()}}],qp.forEach((e=>{const t=e.prototype;Object.getOwnPropertyNames(t).forEach((n=>{if("constructor"===n)return;const r=Object.getOwnPropertyDescriptor(t,n);r&&(r.get||r.set)?Object.defineProperty(jp.prototype,n,r):jp.prototype[n]=e.prototype[n]}))}));class Gp extends Kp{constructor(e,t=Lp){const n=bu(t);n.outputCst=!1,super(e,n)}}function Hp(e,t,n){return`${e.name}_${t}_${n}`}const Wp=1,Bp=4,zp=5,Vp=7,Yp=8,Xp=9,Jp=10,Qp=11,Zp=12;class eh{constructor(e){this.target=e}isEpsilon(){return!1}}class th extends eh{constructor(e,t){super(e),this.tokenType=t}}class nh extends eh{constructor(e){super(e)}isEpsilon(){return!0}}class rh extends eh{constructor(e,t,n){super(e),this.rule=t,this.followState=n}isEpsilon(){return!0}}function ih(e,t,n){return n instanceof cl?lh(e,t,n.terminalType,n):n instanceof Zu?function(e,t,n){const r=n.referencedRule,i=e.ruleToStartState.get(r),o=ph(e,t,n,{type:Wp}),s=ph(e,t,n,{type:Wp});return hh(o,new rh(i,r,s)),{left:o,right:s}}(e,t,n):n instanceof al?function(e,t,n){const r=ph(e,t,n,{type:Wp});ch(e,r);const i=qc(n.definition,(n=>ih(e,t,n)));return uh(e,t,r,n,...i)}(e,t,n):n instanceof nl?function(e,t,n){const r=ph(e,t,n,{type:Wp});ch(e,r);return function(e,t,n,r){const i=r.left;return fh(i,r.right),e.decisionMap[Hp(t,"Option",n.idx)]=i,r}(e,t,n,uh(e,t,r,n,oh(e,t,n)))}(e,t,n):n instanceof ol?function(e,t,n){const r=ph(e,t,n,{type:zp});ch(e,r);return ah(e,t,n,uh(e,t,r,n,oh(e,t,n)))}(e,t,n):n instanceof sl?function(e,t,n){const r=ph(e,t,n,{type:zp});ch(e,r);return ah(e,t,n,uh(e,t,r,n,oh(e,t,n)),lh(e,t,n.separator,n))}(e,t,n):n instanceof rl?function(e,t,n){const r=ph(e,t,n,{type:Bp});ch(e,r);return sh(e,t,n,uh(e,t,r,n,oh(e,t,n)))}(e,t,n):n instanceof il?function(e,t,n){const r=ph(e,t,n,{type:Bp});ch(e,r);return sh(e,t,n,uh(e,t,r,n,oh(e,t,n)),lh(e,t,n.separator,n))}(e,t,n):oh(e,t,n)}function oh(e,t,n){const r=Yl(qc(n.definition,(n=>ih(e,t,n))),(e=>void 0!==e));return 1===r.length?r[0]:0===r.length?void 0:function(e,t){const n=t.length;for(let r=0;r<n-1;r++){const n=t[r];let i;1===n.left.transitions.length&&(i=n.left.transitions[0]);const o=i instanceof rh,s=i,a=t[r+1].left;n.left.type===Wp&&n.right.type===Wp&&void 0!==i&&(o&&s.followState===n.right||i.target===n.right)?(o?s.followState=a:i.target=a,mh(e,n.right)):fh(n.right,a)}const r=t[0],i=t[n-1];return{left:r.left,right:i.right}}(e,r)}function sh(e,t,n,r,i){const o=r.left,s=r.right,a=ph(e,t,n,{type:Qp});ch(e,a);const c=ph(e,t,n,{type:Zp});return o.loopback=a,c.loopback=a,e.decisionMap[Hp(t,i?"RepetitionMandatoryWithSeparator":"RepetitionMandatory",n.idx)]=a,fh(s,a),void 0===i?(fh(a,o),fh(a,c)):(fh(a,c),fh(a,i.left),fh(i.right,o)),{left:o,right:c}}function ah(e,t,n,r,i){const o=r.left,s=r.right,a=ph(e,t,n,{type:Jp});ch(e,a);const c=ph(e,t,n,{type:Zp}),u=ph(e,t,n,{type:Xp});return a.loopback=u,c.loopback=u,fh(a,o),fh(a,c),fh(s,u),void 0!==i?(fh(u,c),fh(u,i.left),fh(i.right,o)):fh(u,a),e.decisionMap[Hp(t,i?"RepetitionWithSeparator":"Repetition",n.idx)]=a,{left:a,right:c}}function ch(e,t){return e.decisionStates.push(t),t.decision=e.decisionStates.length-1,t.decision}function uh(e,t,n,r,...i){const o=ph(e,t,r,{type:Yp,start:n});n.end=o;for(const e of i)void 0!==e?(fh(n,e.left),fh(e.right,o)):fh(n,o);const s={left:n,right:o};return e.decisionMap[Hp(t,function(e){if(e instanceof al)return"Alternation";if(e instanceof nl)return"Option";if(e instanceof ol)return"Repetition";if(e instanceof sl)return"RepetitionWithSeparator";if(e instanceof rl)return"RepetitionMandatory";if(e instanceof il)return"RepetitionMandatoryWithSeparator";throw new Error("Invalid production type encountered")}(r),r.idx)]=n,s}function lh(e,t,n,r){const i=ph(e,t,r,{type:Wp}),o=ph(e,t,r,{type:Wp});return hh(i,new th(o,n)),{left:i,right:o}}function dh(e,t,n){const r=e.ruleToStartState.get(t);fh(r,n.left);const i=e.ruleToStopState.get(t);return fh(n.right,i),{left:r,right:i}}function fh(e,t){hh(e,new nh(t))}function ph(e,t,n,r){const i=Object.assign({atn:e,production:n,epsilonOnlyTransitions:!1,rule:t,transitions:[],nextTokenWithinRule:[],stateNumber:e.states.length},r);return e.states.push(i),i}function hh(e,t){0===e.transitions.length&&(e.epsilonOnlyTransitions=t.isEpsilon()),e.transitions.push(t)}function mh(e,t){e.states.splice(e.states.indexOf(t),1)}const yh={};class gh{constructor(){this.map={},this.configs=[]}get size(){return this.configs.length}finalize(){this.map={}}add(e){const t=vh(e);t in this.map||(this.map[t]=this.configs.length,this.configs.push(e))}get elements(){return this.configs}get alts(){return qc(this.configs,(e=>e.alt))}get key(){let e="";for(const t in this.map)e+=t+":";return e}}function vh(e,t=!0){return`${t?`a${e.alt}`:""}s${e.state.stateNumber}:${e.stack.map((e=>e.stateNumber.toString())).join("_")}`}const Th=function(e,t){return e<t},Rh=function(e){return e&&e.length?function(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(void 0===a?s==s&&!gc(s):n(s,a)))var a=s,c=o}return c}(e,Bs,Th):void 0},kh=function(e,t){return e&&e.length?Al(e,Fc(t)):[]};function bh(e,t){const n={};return r=>{const i=r.toString();let o=n[i];return void 0!==o||(o={atnStartState:e,decision:t,states:{}},n[i]=o),o}}class wh{constructor(){this.predicates=[]}is(e){return e>=this.predicates.length||this.predicates[e]}set(e,t){this.predicates[e]=t}toString(){let e="";const t=this.predicates.length;for(let n=0;n<t;n++)e+=!0===this.predicates[n]?"1":"0";return e}}const Sh=new wh;class $h extends vp{constructor(e){var t;super(),this.logging=null!==(t=null==e?void 0:e.logging)&&void 0!==t?t:e=>console.log(e)}initialize(e){this.atn=function(e){const t={decisionMap:{},decisionStates:[],ruleToStartState:new Map,ruleToStopState:new Map,states:[]};!function(e,t){const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=ph(e,n,void 0,{type:2}),o=ph(e,n,void 0,{type:Vp});i.stop=o,e.ruleToStartState.set(n,i),e.ruleToStopState.set(n,o)}}(t,e);const n=e.length;for(let r=0;r<n;r++){const n=e[r],i=oh(t,n,n);void 0!==i&&dh(t,n,i)}return t}(e.rules),this.dfas=function(e){const t=e.decisionStates.length,n=Array(t);for(let r=0;r<t;r++)n[r]=bh(e.decisionStates[r],r);return n}(this.atn)}validateAmbiguousAlternationAlternatives(){return[]}validateEmptyOrAlternatives(){return[]}buildLookaheadForAlternation(e){const{prodOccurrence:t,rule:n,hasPredicates:r,dynamicTokensEnabled:i}=e,o=this.dfas,s=this.logging,a=Hp(n,"Alternation",t),c=this.atn.decisionMap[a].decision,u=qc(If({maxLookahead:1,occurrence:t,prodType:"Alternation",rule:n}),(e=>qc(e,(e=>e[0]))));if(xh(u,!1)&&!i){const e=Vl(u,((e,t,n)=>(zs(t,(t=>{t&&(e[t.tokenTypeIdx]=n,zs(t.categoryMatches,(t=>{e[t]=n})))})),e)),{});return r?function(t){var n;const r=this.LA(1),i=e[r.tokenTypeIdx];if(void 0!==t&&void 0!==i){const e=null===(n=t[i])||void 0===n?void 0:n.GATE;if(void 0!==e&&!1===e.call(this))return}return i}:function(){const t=this.LA(1);return e[t.tokenTypeIdx]}}return r?function(e){const t=new wh,n=void 0===e?0:e.length;for(let r=0;r<n;r++){const n=null==e?void 0:e[r].GATE;t.set(r,void 0===n||n.call(this))}const r=Ch.call(this,o,c,t,s);return"number"==typeof r?r:void 0}:function(){const e=Ch.call(this,o,c,Sh,s);return"number"==typeof e?e:void 0}}buildLookaheadForOptional(e){const{prodOccurrence:t,rule:n,prodType:r,dynamicTokensEnabled:i}=e,o=this.dfas,s=this.logging,a=Hp(n,r,t),c=this.atn.decisionMap[a].decision,u=qc(If({maxLookahead:1,occurrence:t,prodType:r,rule:n}),(e=>qc(e,(e=>e[0]))));if(xh(u)&&u[0][0]&&!i){const e=u[0],t=Pl(e);if(1===t.length&&Ca(t[0].categoryMatches)){const e=t[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===e}}{const e=Vl(t,((e,t)=>(void 0!==t&&(e[t.tokenTypeIdx]=!0,zs(t.categoryMatches,(t=>{e[t]=!0}))),e)),{});return function(){const t=this.LA(1);return!0===e[t.tokenTypeIdx]}}}return function(){const e=Ch.call(this,o,c,Sh,s);return"object"!=typeof e&&0===e}}}function xh(e,t=!0){const n=new Set;for(const r of e){const e=new Set;for(const i of r){if(void 0===i){if(t)break;return!1}const r=[i.tokenTypeIdx].concat(i.categoryMatches);for(const t of r)if(n.has(t)){if(!e.has(t))return!1}else n.add(t),e.add(t)}}return!0}function Ch(e,t,n,r){const i=e[t](n);let o=i.start;return void 0===o&&(o=Oh(i,Ih(function(e){const t=new gh,n=e.transitions.length;for(let r=0;r<n;r++)Lh({state:e.transitions[r].target,alt:r,stack:[]},t);return t}(i.atnStartState))),i.start=o),Eh.apply(this,[i,o,n,r])}function Eh(e,t,n,r){let i=t,o=1;const s=[];let a=this.LA(o++);for(;;){let t=(c=a,i.edges[c.tokenTypeIdx]);if(void 0===t&&(t=Ah.apply(this,[e,i,a,o,n,r])),t===yh)return Dh(s,i,a);if(!0===t.isAcceptState)return t.prediction;i=t,s.push(a),a=this.LA(o++)}var c}function Ah(e,t,n,r,i,o){const s=function(e,t,n){const r=new gh,i=[];for(const o of e.elements){if(!1===n.is(o.alt))continue;if(o.state.type===Vp){i.push(o);continue}const e=o.state.transitions.length;for(let n=0;n<e;n++){const e=_h(o.state.transitions[n],t);void 0!==e&&r.add({state:e,alt:o.alt,stack:o.stack})}}let o;if(0===i.length&&1===r.size&&(o=r),void 0===o){o=new gh;for(const e of r.elements)Lh(e,o)}if(i.length>0&&!function(e){for(const t of e.elements)if(t.state.type===Vp)return!0;return!1}(o))for(const e of i)o.add(e);return o}(t.configs,n,i);if(0===s.size)return Ph(e,t,n,yh),yh;let a=Ih(s);const c=function(e,t){let n;for(const r of e.elements)if(!0===t.is(r.alt))if(void 0===n)n=r.alt;else if(n!==r.alt)return;return n}(s,i);if(void 0!==c)a.isAcceptState=!0,a.prediction=c,a.configs.uniqueAlt=c;else if(function(e){if(function(e){for(const t of e.elements)if(t.state.type!==Vp)return!1;return!0}(e))return!0;const t=function(e){const t=new Map;for(const n of e){const e=vh(n,!1);let r=t.get(e);void 0===r&&(r={},t.set(e,r)),r[n.alt]=!0}return t}(e.elements);return function(e){for(const t of Array.from(e.values()))if(Object.keys(t).length>1)return!0;return!1}(t)&&!function(e){for(const t of Array.from(e.values()))if(1===Object.keys(t).length)return!0;return!1}(t)}(s)){const t=Rh(s.alts);a.isAcceptState=!0,a.prediction=t,a.configs.uniqueAlt=t,Nh.apply(this,[e,r,s.alts,o])}return a=Ph(e,t,n,a),a}function Nh(e,t,n,r){const i=[];for(let e=1;e<=t;e++)i.push(this.LA(e).tokenType);const o=e.atnStartState;r(function(e){const t=qc(e.prefixPath,(e=>Vd(e))).join(", "),n=0===e.production.idx?"":e.production.idx;let r=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(", ")}> in <${function(e){if(e instanceof Zu)return"SUBRULE";if(e instanceof nl)return"OPTION";if(e instanceof al)return"OR";if(e instanceof rl)return"AT_LEAST_ONE";if(e instanceof il)return"AT_LEAST_ONE_SEP";if(e instanceof sl)return"MANY_SEP";if(e instanceof ol)return"MANY";if(e instanceof cl)return"CONSUME";throw Error("non exhaustive match")}(e.production)}${n}> inside <${e.topLevelRule.name}> Rule,\n<${t}> may appears as a prefix path in all these alternatives.\n`;return r+="See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details.",r}({topLevelRule:o.rule,ambiguityIndices:n,production:o.production,prefixPath:i}))}function Dh(e,t,n){const r=pf(t.configs.elements,(e=>e.state.transitions));return{actualToken:n,possibleTokenTypes:kh(r.filter((e=>e instanceof th)).map((e=>e.tokenType)),(e=>e.tokenTypeIdx)),tokenPath:e}}function _h(e,t){if(e instanceof th&&cf(t,e.tokenType))return e.target}function Ih(e){return{configs:e,edges:{},isAcceptState:!1,prediction:-1}}function Ph(e,t,n,r){return r=Oh(e,r),t.edges[n.tokenTypeIdx]=r,r}function Oh(e,t){if(t===yh)return t;const n=t.configs.key,r=e.states[n];return void 0!==r?r:(t.configs.finalize(),e.states[n]=t,t)}function Lh(e,t){const n=e.state;if(n.type===Vp){if(e.stack.length>0){const n=[...e.stack];Lh({state:n.pop(),alt:e.alt,stack:n},t)}else t.add(e);return}n.epsilonOnlyTransitions||t.add(e);const r=n.transitions.length;for(let i=0;i<r;i++){const r=Mh(e,n.transitions[i]);void 0!==r&&Lh(r,t)}}function Mh(e,t){if(t instanceof nh)return{state:t.target,alt:e.alt,stack:e.stack};if(t instanceof rh){const n=[...e.stack,t.followState];return{state:t.target,alt:e.alt,stack:n}}}class Fh{constructor(){this.nodeStack=[]}get current(){return this.nodeStack[this.nodeStack.length-1]}buildRootNode(e){return this.rootNode=new Gh(e),this.nodeStack=[this.rootNode],this.rootNode}buildCompositeNode(e){const t=new Uh;return t.grammarSource=e,t.root=this.rootNode,this.current.content.push(t),this.nodeStack.push(t),t}buildLeafNode(e,t){const n=new qh(e.startOffset,e.image.length,$(e),e.tokenType,!1);return n.grammarSource=t,n.root=this.rootNode,this.current.content.push(n),n}removeNode(e){const t=e.container;if(t){const n=t.content.indexOf(e);n>=0&&t.content.splice(n,1)}}construct(e){const t=this.current;"string"==typeof e.$type&&(this.current.astNode=e),e.$cstNode=t;const n=this.nodeStack.pop();0===(null==n?void 0:n.content.length)&&this.removeNode(n)}addHiddenTokens(e){for(const t of e){const e=new qh(t.startOffset,t.image.length,$(t),t.tokenType,!0);e.root=this.rootNode,this.addHiddenToken(this.rootNode,e)}}addHiddenToken(e,t){const{offset:n,end:r}=t;for(let i=0;i<e.content.length;i++){const o=e.content[i],{offset:s,end:a}=o;if(h(o)&&n>s&&r<a)return void this.addHiddenToken(o,t);if(r<=s)return void e.content.splice(i,0,t)}e.content.push(t)}}class jh{get parent(){return this.container}get feature(){return this.grammarSource}get hidden(){return!1}get astNode(){var e,t;const n="string"==typeof(null===(e=this._astNode)||void 0===e?void 0:e.$type)?this._astNode:null===(t=this.container)||void 0===t?void 0:t.astNode;if(!n)throw new Error("This node has no associated AST element");return n}set astNode(e){this._astNode=e}get element(){return this.astNode}get text(){return this.root.fullText.substring(this.offset,this.end)}}class qh extends jh{get offset(){return this._offset}get length(){return this._length}get end(){return this._offset+this._length}get hidden(){return this._hidden}get tokenType(){return this._tokenType}get range(){return this._range}constructor(e,t,n,r,i=!1){super(),this._hidden=i,this._offset=e,this._tokenType=r,this._length=t,this._range=n}}class Uh extends jh{constructor(){super(...arguments),this.content=new Kh(this)}get children(){return this.content}get offset(){var e,t;return null!==(t=null===(e=this.firstNonHiddenNode)||void 0===e?void 0:e.offset)&&void 0!==t?t:0}get length(){return this.end-this.offset}get end(){var e,t;return null!==(t=null===(e=this.lastNonHiddenNode)||void 0===e?void 0:e.end)&&void 0!==t?t:0}get range(){const e=this.firstNonHiddenNode,t=this.lastNonHiddenNode;if(e&&t){if(void 0===this._rangeCache){const{range:n}=e,{range:r}=t;this._rangeCache={start:n.start,end:r.end.line<n.start.line?n.start:r.end}}return this._rangeCache}return{start:Gn.Position.create(0,0),end:Gn.Position.create(0,0)}}get firstNonHiddenNode(){for(const e of this.content)if(!e.hidden)return e;return this.content[0]}get lastNonHiddenNode(){for(let e=this.content.length-1;e>=0;e--){const t=this.content[e];if(!t.hidden)return t}return this.content[this.content.length-1]}}class Kh extends Array{constructor(e){super(),this.parent=e,Object.setPrototypeOf(this,Kh.prototype)}push(...e){return this.addParents(e),super.push(...e)}unshift(...e){return this.addParents(e),super.unshift(...e)}splice(e,t,...n){return this.addParents(n),super.splice(e,t,...n)}addParents(e){for(const t of e)t.container=this.parent}}class Gh extends Uh{get text(){return this._text.substring(this.offset,this.end)}get fullText(){return this._text}constructor(e){super(),this._text="",this._text=null!=e?e:""}}const Hh=Symbol("Datatype");function Wh(e){return e.$type===Hh}const Bh=e=>e.endsWith("")?e:e+"";class zh{constructor(e){this._unorderedGroups=new Map,this.lexer=e.parser.Lexer;const t=this.lexer.definition;this.wrapper=new Zh(t,Object.assign(Object.assign({},e.parser.ParserConfig),{errorMessageProvider:e.parser.ParserErrorMessageProvider}))}alternatives(e,t){this.wrapper.wrapOr(e,t)}optional(e,t){this.wrapper.wrapOption(e,t)}many(e,t){this.wrapper.wrapMany(e,t)}atLeastOne(e,t){this.wrapper.wrapAtLeastOne(e,t)}isRecording(){return this.wrapper.IS_RECORDING}get unorderedGroups(){return this._unorderedGroups}getRuleStack(){return this.wrapper.RULE_STACK}finalize(){this.wrapper.wrapSelfAnalysis()}}class Vh extends zh{get current(){return this.stack[this.stack.length-1]}constructor(e){super(e),this.nodeBuilder=new Fh,this.stack=[],this.assignmentMap=new Map,this.linker=e.references.Linker,this.converter=e.parser.ValueConverter,this.astReflection=e.shared.AstReflection}rule(e,t){const n=e.fragment?void 0:gr(e)?Hh:br(e),r=this.wrapper.DEFINE_RULE(Bh(e.name),this.startImplementation(n,t).bind(this));return e.entry&&(this.mainRule=r),r}parse(e){this.nodeBuilder.buildRootNode(e);const t=this.lexer.tokenize(e);this.wrapper.input=t.tokens;const n=this.mainRule.call(this.wrapper,{});return this.nodeBuilder.addHiddenTokens(t.hidden),this.unorderedGroups.clear(),{value:n,lexerErrors:t.errors,parserErrors:this.wrapper.errors}}startImplementation(e,t){return n=>{if(!this.isRecording()){const t={$type:e};this.stack.push(t),e===Hh&&(t.value="")}let r;try{r=t(n)}catch(e){r=void 0}return this.isRecording()||void 0!==r||(r=this.construct()),r}}consume(e,t,n){const r=this.wrapper.wrapConsume(e,t);if(!this.isRecording()&&this.isValidToken(r)){const e=this.nodeBuilder.buildLeafNode(r,n),{assignment:t,isCrossRef:i}=this.getAssignment(n),o=this.current;if(t){const o=qe(n)?r.image:this.converter.convert(r.image,e);this.assign(t.operator,t.feature,o,e,i)}else if(Wh(o)){let t=r.image;qe(n)||(t=this.converter.convert(t,e).toString()),o.value+=t}}}isValidToken(e){return!e.isInsertedInRecovery&&!isNaN(e.startOffset)&&"number"==typeof e.endOffset&&!isNaN(e.endOffset)}subrule(e,t,n,r){let i;this.isRecording()||(i=this.nodeBuilder.buildCompositeNode(n));const o=this.wrapper.wrapSubrule(e,t,r);!this.isRecording()&&i&&i.length>0&&this.performSubruleAssignment(o,n,i)}performSubruleAssignment(e,t,n){const{assignment:r,isCrossRef:i}=this.getAssignment(t);if(r)this.assign(r.operator,r.feature,e,n,i);else if(!r){const t=this.current;if(Wh(t))t.value+=e.toString();else{const n=e.$type,r=this.assignWithoutOverride(e,t);n&&(r.$type=n);const i=r;this.stack.pop(),this.stack.push(i)}}}action(e,t){if(!this.isRecording()){let n=this.current;if(!n.$cstNode&&t.feature&&t.operator){n=this.construct(!1);const e=n.$cstNode.feature;this.nodeBuilder.buildCompositeNode(e)}const r={$type:e};this.stack.pop(),this.stack.push(r),t.feature&&t.operator&&this.assign(t.operator,t.feature,n,n.$cstNode,!1)}}construct(e=!0){if(this.isRecording())return;const t=this.current;return function(e){for(const[t,n]of Object.entries(e))t.startsWith("$")||(Array.isArray(n)?n.forEach(((n,r)=>{l(n)&&(n.$container=e,n.$containerProperty=t,n.$containerIndex=r)})):l(n)&&(n.$container=e,n.$containerProperty=t))}(t),this.nodeBuilder.construct(t),e&&this.stack.pop(),Wh(t)?this.converter.convert(t.value,t.$cstNode):(ut(this.astReflection,t),t)}getAssignment(e){if(!this.assignmentMap.has(e)){const t=tt(e,De);this.assignmentMap.set(e,{assignment:t,isCrossRef:!!t&&Oe(t.terminal)})}return this.assignmentMap.get(e)}assign(e,t,n,r,i){const o=this.current;let s;switch(s=i&&"string"==typeof n?this.linker.buildReference(o,t,r,n):n,e){case"=":o[t]=s;break;case"?=":o[t]=!0;break;case"+=":Array.isArray(o[t])||(o[t]=[]),o[t].push(s)}}assignWithoutOverride(e,t){for(const[n,r]of Object.entries(t)){const t=e[n];void 0===t?e[n]=r:Array.isArray(t)&&Array.isArray(r)&&(r.push(...t),e[n]=r)}return e}get definitionErrors(){return this.wrapper.definitionErrors}}class Yh{buildMismatchTokenMessage(e){return uf.buildMismatchTokenMessage(e)}buildNotAllInputParsedMessage(e){return uf.buildNotAllInputParsedMessage(e)}buildNoViableAltMessage(e){return uf.buildNoViableAltMessage(e)}buildEarlyExitMessage(e){return uf.buildEarlyExitMessage(e)}}class Xh extends Yh{buildMismatchTokenMessage({expected:e,actual:t}){return`Expecting ${e.LABEL?"`"+e.LABEL+"`":e.name.endsWith(":KW")?`keyword '${e.name.substring(0,e.name.length-3)}'`:`token of type '${e.name}'`} but found \`${t.image}\`.`}buildNotAllInputParsedMessage({firstRedundant:e}){return`Expecting end of file but found \`${e.image}\`.`}}class Jh extends zh{constructor(){super(...arguments),this.tokens=[],this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}action(){}construct(){}parse(e){this.resetState();const t=this.lexer.tokenize(e);return this.tokens=t.tokens,this.wrapper.input=[...this.tokens],this.mainRule.call(this.wrapper,{}),this.unorderedGroups.clear(),{tokens:this.tokens,elementStack:[...this.lastElementStack],tokenIndex:this.nextTokenIndex}}rule(e,t){const n=this.wrapper.DEFINE_RULE(Bh(e.name),this.startImplementation(t).bind(this));return e.entry&&(this.mainRule=n),n}resetState(){this.elementStack=[],this.lastElementStack=[],this.nextTokenIndex=0,this.stackSize=0}startImplementation(e){return t=>{const n=this.keepStackSize();try{e(t)}finally{this.resetStackSize(n)}}}removeUnexpectedElements(){this.elementStack.splice(this.stackSize)}keepStackSize(){const e=this.elementStack.length;return this.stackSize=e,e}resetStackSize(e){this.removeUnexpectedElements(),this.stackSize=e}consume(e,t,n){this.wrapper.wrapConsume(e,t),this.isRecording()||(this.lastElementStack=[...this.elementStack,n],this.nextTokenIndex=this.currIdx+1)}subrule(e,t,n,r){this.before(n),this.wrapper.wrapSubrule(e,t,r),this.after(n)}before(e){this.isRecording()||this.elementStack.push(e)}after(e){if(!this.isRecording()){const t=this.elementStack.lastIndexOf(e);t>=0&&this.elementStack.splice(t)}}get currIdx(){return this.wrapper.currIdx}}const Qh={recoveryEnabled:!0,nodeLocationTracking:"full",skipValidations:!0,errorMessageProvider:new Xh};class Zh extends Gp{constructor(e,t){const n=t&&"maxLookahead"in t;super(e,Object.assign(Object.assign(Object.assign({},Qh),{lookaheadStrategy:n?new vp({maxLookahead:t.maxLookahead}):new $h}),t))}get IS_RECORDING(){return this.RECORDING_PHASE}DEFINE_RULE(e,t){return this.RULE(e,t)}wrapSelfAnalysis(){this.performSelfAnalysis()}wrapConsume(e,t){return this.consume(e,t)}wrapSubrule(e,t,n){return this.subrule(e,t,{ARGS:[n]})}wrapOr(e,t){this.or(e,t)}wrapOption(e,t){this.option(e,t)}wrapMany(e,t){this.many(e,t)}wrapAtLeastOne(e,t){this.atLeastOne(e,t)}}class em extends Error{constructor(e,t){super(e?`${t} at ${e.range.start.line}:${e.range.start.character}`:t)}}function tm(e){throw new Error("Error! The input value was not handled.")}function nm(e,t,n){return function(e,t){const n=Fo(t,!1),r=R(t.rules).filter(fe).filter((e=>n.has(e)));for(const t of r){const n=Object.assign(Object.assign({},e),{consume:1,optional:1,subrule:1,many:1,or:1});n.rules.set(t.name,e.parser.rule(t,rm(n,t.definition)))}}({parser:t,tokens:n,rules:new Map,ruleNames:new Map},e),t}function rm(e,t,n=!1){let r;if(qe(t))r=function(e,t){const n=e.consume++,r=e.tokens[t.value];if(!r)throw new Error("Could not find token for keyword: "+t.value);return()=>e.parser.consume(n,r,t)}(e,t);else if(Ce(t))r=function(e,t){const n=br(t);return()=>e.parser.action(n,t)}(e,t);else if(De(t))r=rm(e,t.terminal);else if(Oe(t))r=sm(e,t);else if(He(t))r=function(e,t){const n=t.rule.ref;if(fe(n)){const r=e.subrule++,i=t.arguments.length>0?function(e,t){const n=t.map((e=>im(e.value)));return t=>{const r={};for(let i=0;i<n.length;i++){const o=e.parameters[i],s=n[i];r[o.name]=s(t)}return r}}(n,t.arguments):()=>({});return o=>e.parser.subrule(r,cm(e,n),t,i(o))}if(Re(n)){const r=e.consume++,i=um(e,n.name);return()=>e.parser.consume(r,i,t)}if(!n)throw new em(t.$cstNode,`Undefined rule type: ${t.$type}`);tm()}(e,t);else if(Ae(t))r=function(e,t){if(1===t.elements.length)return rm(e,t.elements[0]);{const n=[];for(const r of t.elements){const t={ALT:rm(e,r,!0)},i=om(r);i&&(t.GATE=im(i)),n.push(t)}const r=e.or++;return t=>e.parser.alternatives(r,n.map((e=>{const n={ALT:()=>e.ALT(t)},r=e.GATE;return r&&(n.GATE=()=>r(t)),n})))}}(e,t);else if(Xe(t))r=function(e,t){if(1===t.elements.length)return rm(e,t.elements[0]);const n=[];for(const r of t.elements){const t={ALT:rm(e,r,!0)},i=om(r);i&&(t.GATE=im(i)),n.push(t)}const r=e.or++,i=(e,t)=>`uGroup_${e}_${t.getRuleStack().join("-")}`,o=am(e,om(t),(t=>e.parser.alternatives(r,n.map(((n,o)=>{const s={ALT:()=>!0},a=e.parser;s.ALT=()=>{if(n.ALT(t),!a.isRecording()){const e=i(r,a);a.unorderedGroups.get(e)||a.unorderedGroups.set(e,[]);const t=a.unorderedGroups.get(e);void 0===(null==t?void 0:t[o])&&(t[o]=!0)}};const c=n.GATE;return s.GATE=c?()=>c(t):()=>{const e=a.unorderedGroups.get(i(r,a));return!(null==e?void 0:e[o])},s})))),"*");return t=>{o(t),e.parser.isRecording()||e.parser.unorderedGroups.delete(i(r,e.parser))}}(e,t);else if(Fe(t))r=function(e,t){const n=t.elements.map((t=>rm(e,t)));return e=>n.forEach((t=>t(e)))}(e,t);else{if(i=t,!et.isInstance(i,Le))throw new em(t.$cstNode,`Unexpected element type: ${t.$type}`);{const n=e.consume++;r=()=>e.parser.consume(n,sf,t)}}var i;return am(e,n?void 0:om(t),r,t.cardinality)}function im(e){if(t=e,et.isInstance(t,J)){const t=im(e.left),n=im(e.right);return e=>t(e)||n(e)}if(function(e){return et.isInstance(e,X)}(e)){const t=im(e.left),n=im(e.right);return e=>t(e)&&n(e)}if(function(e){return et.isInstance(e,ae)}(e)){const t=im(e.value);return e=>!t(e)}if(le(e)){const t=e.parameter.ref.name;return e=>void 0!==e&&!0===e[t]}if(function(e){return et.isInstance(e,se)}(e)){const t=Boolean(e.true);return()=>t}var t;tm()}function om(e){if(Fe(e))return e.guardCondition}function sm(e,t,n=t.terminal){if(n){if(He(n)&&fe(n.rule.ref)){const r=e.subrule++;return i=>e.parser.subrule(r,cm(e,n.rule.ref),t,i)}if(He(n)&&Re(n.rule.ref)){const r=e.consume++,i=um(e,n.rule.ref.name);return()=>e.parser.consume(r,i,t)}if(qe(n)){const r=e.consume++,i=um(e,n.value);return()=>e.parser.consume(r,i,t)}throw new Error("Could not build cross reference parser")}{if(!t.type.ref)throw new Error("Could not resolve reference to type: "+t.type.$refText);const n=Vo(t.type.ref),r=null==n?void 0:n.terminal;if(!r)throw new Error("Could not find name assignment for type: "+br(t.type.ref));return sm(e,t,r)}}function am(e,t,n,r){const i=t&&im(t);if(!r){if(i){const t=e.or++;return r=>e.parser.alternatives(t,[{ALT:()=>n(r),GATE:()=>i(r)},{ALT:Up(),GATE:()=>!i(r)}])}return n}if("*"===r){const t=e.many++;return r=>e.parser.many(t,{DEF:()=>n(r),GATE:i?()=>i(r):void 0})}if("+"===r){const t=e.many++;if(i){const r=e.or++;return o=>e.parser.alternatives(r,[{ALT:()=>e.parser.atLeastOne(t,{DEF:()=>n(o)}),GATE:()=>i(o)},{ALT:Up(),GATE:()=>!i(o)}])}return r=>e.parser.atLeastOne(t,{DEF:()=>n(r)})}if("?"===r){const t=e.optional++;return r=>e.parser.optional(t,{DEF:()=>n(r),GATE:i?()=>i(r):void 0})}tm()}function cm(e,t){const n=function(e,t){if(fe(t))return t.name;if(e.ruleNames.has(t))return e.ruleNames.get(t);{let n=t,r=n.$container,i=t.$type;for(;!fe(r);)(Fe(r)||Ae(r)||Xe(r))&&(i=r.elements.indexOf(n).toString()+":"+i),n=r,r=r.$container;return i=r.name+":"+i,e.ruleNames.set(t,i),i}}(e,t),r=e.rules.get(n);if(!r)throw new Error(`Rule "${n}" not found."`);return r}function um(e,t){const n=e.tokens[t];if(!n)throw new Error(`Token "${t}" not found."`);return n}class lm{buildTokens(e,t){const n=R(Fo(e,!1)),r=this.buildTerminalTokens(n),i=this.buildKeywordTokens(n,r,t);return r.forEach((e=>{const t=e.PATTERN;"object"==typeof t&&t&&"test"in t&&Ln(t)?i.unshift(e):i.push(e)})),i}buildTerminalTokens(e){return e.filter(Re).filter((e=>!e.fragment)).map((e=>this.buildTerminalToken(e))).toArray()}buildTerminalToken(e){const t=Cr(e),n=t.flags.includes("u")?this.regexPatternFunction(t):t,r={name:e.name,PATTERN:n,LINE_BREAKS:!0};return e.hidden&&(r.GROUP=Ln(t)?zd.SKIPPED:"hidden"),r}regexPatternFunction(e){const t=new RegExp(e,e.flags+"y");return(e,n)=>(t.lastIndex=n,t.exec(e))}buildKeywordTokens(e,t,n){return e.filter(fe).flatMap((e=>ot(e).filter(qe))).distinct((e=>e.value)).toArray().sort(((e,t)=>t.value.length-e.value.length)).map((e=>this.buildKeywordToken(e,t,Boolean(null==n?void 0:n.caseInsensitive))))}buildKeywordToken(e,t,n){return{name:e.value,PATTERN:this.buildKeywordPattern(e,n),LONGER_ALT:this.findLongerAlt(e,t)}}buildKeywordPattern(e,t){return t?new RegExp(function(e){return Array.prototype.map.call(e,(e=>/\w/.test(e)?`[${e.toLowerCase()}${e.toUpperCase()}]`:Mn(e))).join("")}(e.value)):e.value}findLongerAlt(e,t){return t.reduce(((t,n)=>{const r=null==n?void 0:n.PATTERN;return(null==r?void 0:r.source)&&function(e,t){const n=function(e){"string"==typeof e&&(e=new RegExp(e));const t=e,n=e.source;let r=0;return new RegExp(function e(){let i,o="";function s(e){o+=n.substr(r,e),r+=e}function a(e){o+="(?:"+n.substr(r,e)+"|$)",r+=e}for(;r<n.length;)switch(n[r]){case"\\":switch(n[r+1]){case"c":a(3);break;case"x":a(4);break;case"u":t.unicode?"{"===n[r+2]?a(n.indexOf("}",r)-r+1):a(6):a(2);break;case"p":case"P":t.unicode?a(n.indexOf("}",r)-r+1):a(2);break;case"k":a(n.indexOf(">",r)-r+1);break;default:a(2)}break;case"[":i=/\[(?:\\.|.)*?\]/g,i.lastIndex=r,i=i.exec(n)||[],a(i[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":s(1);break;case"{":i=/\{\d+,?\d*\}/g,i.lastIndex=r,i=i.exec(n),i?s(i[0].length):a(1);break;case"(":if("?"===n[r+1])switch(n[r+2]){case":":o+="(?:",r+=3,o+=e()+"|$)";break;case"=":o+="(?=",r+=3,o+=e()+")";break;case"!":i=r,r+=3,e(),o+=n.substr(i,r-i);break;case"<":switch(n[r+3]){case"=":case"!":i=r,r+=4,e(),o+=n.substr(i,r-i);break;default:s(n.indexOf(">",r)-r+1),o+=e()+"|$)"}}else s(1),o+=e()+"|$)";break;case")":return++r,o;default:a(1)}return o}(),e.flags)}(e),r=t.match(n);return!!r&&r[0].length>0}("^"+r.source+"$",e.value)&&t.push(n),t}),[])}}class dm{convert(e,t){let n=t.grammarSource;if(Oe(n)&&(n=qo(n)),He(n)){const r=n.rule.ref;if(!r)throw new Error("This cst node was not parsed by a rule.");return this.runConverter(r,e,t)}return e}runConverter(e,t,n){var r;switch(e.name.toUpperCase()){case"INT":return function(e){return parseInt(e)}(t);case"STRING":return function(e){let t="";for(let n=1;n<e.length-1;n++){const r=e.charAt(n);t+="\\"===r?fm(e.charAt(++n)):r}return t}(t);case"ID":return function(e){return"^"===e.charAt(0)?e.substring(1):e}(t)}switch(null===(r=xr(e))||void 0===r?void 0:r.toLowerCase()){case"number":return function(e){return Number(e)}(t);case"boolean":return function(e){return"true"===e.toLowerCase()}(t);case"bigint":return function(e){return BigInt(e)}(t);case"date":return function(e){return new Date(e)}(t);default:return t}}}function fm(e){switch(e){case"b":return"\b";case"f":return"\f";case"n":return"\n";case"r":return"\r";case"t":return"\t";case"v":return"\v";case"0":return"\0";default:return e}}class pm{constructor(e){this.reflection=e.shared.AstReflection,this.langiumDocuments=()=>e.shared.workspace.LangiumDocuments,this.scopeProvider=e.references.ScopeProvider,this.astNodeLocator=e.workspace.AstNodeLocator}async link(e,t=i.CancellationToken.None){for(const n of st(e.parseResult.value))await Yn(t),ct(n).forEach((t=>this.doLink(t,e)))}doLink(e,t){const n=e.reference;if(void 0===n._ref)try{const t=this.getCandidate(e);if(f(t))n._ref=t;else if(n._nodeDescription=t,this.langiumDocuments().hasDocument(t.documentUri)){const r=this.loadAstNode(t);n._ref=null!=r?r:this.createLinkingError(e,t)}}catch(t){n._ref=Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${n.$refText}': ${t}`})}t.references.push(n)}unlink(e){for(const t of e.references)delete t._ref,delete t._nodeDescription;e.references=[]}getCandidate(e){const t=this.scopeProvider.getScope(e).getElement(e.reference.$refText);return null!=t?t:this.createLinkingError(e)}buildReference(e,t,n,r){const i=this,o={$refNode:n,$refText:r,get ref(){var n,r;if(l(this._ref))return this._ref;if("object"==typeof(r=this._nodeDescription)&&null!==r&&"string"==typeof r.name&&"string"==typeof r.type&&"string"==typeof r.path){const n=i.loadAstNode(this._nodeDescription);this._ref=null!=n?n:i.createLinkingError({reference:o,container:e,property:t},this._nodeDescription)}else if(void 0===this._ref){const r=i.getLinkedNode({reference:o,container:e,property:t});if(r.error&&nt(e).state<fo.ComputedScopes)return;this._ref=null!==(n=r.node)&&void 0!==n?n:r.error,this._nodeDescription=r.descr}return l(this._ref)?this._ref:void 0},get $nodeDescription(){return this._nodeDescription},get error(){return f(this._ref)?this._ref:void 0}};return o}getLinkedNode(e){try{const t=this.getCandidate(e);if(f(t))return{error:t};const n=this.loadAstNode(t);return n?{node:n,descr:t}:{descr:t,error:this.createLinkingError(e,t)}}catch(t){return{error:Object.assign(Object.assign({},e),{message:`An error occurred while resolving reference to '${e.reference.$refText}': ${t}`})}}}loadAstNode(e){if(e.node)return e.node;const t=this.langiumDocuments().getOrCreateDocument(e.documentUri);return this.astNodeLocator.getAstNode(t.parseResult.value,e.path)}createLinkingError(e,t){const n=nt(e.container);n.state<fo.ComputedScopes&&console.warn(`Attempted reference resolution before document reached ComputedScopes state (${n.uri}).`);const r=this.reflection.getReferenceType(e);return Object.assign(Object.assign({},e),{message:`Could not resolve reference to ${r} named '${e.reference.$refText}'.`,targetDescription:t})}}function hm(e){return"object"==typeof e&&!!e&&("$ref"in e||"$error"in e)}class mm{constructor(e){this.ignoreProperties=new Set(["$container","$containerProperty","$containerIndex","$document","$cstNode"]),this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider,this.commentProvider=e.documentation.CommentProvider}serialize(e,t){const n=null==t?void 0:t.replacer,r=(e,n)=>this.replacer(e,n,t),i=n?(e,t)=>n(e,t,r):r;return JSON.stringify(e,i,null==t?void 0:t.space)}deserialize(e){const t=JSON.parse(e);return this.linkNode(t,t),t}replacer(e,t,{refText:n,sourceText:r,textRegions:i,comments:o}={}){var s,a,c;if(!this.ignoreProperties.has(e)){if(d(t)){const e=t.ref,r=n?t.$refText:void 0;return e?{$refText:r,$ref:"#"+(e&&this.astNodeLocator.getAstNodePath(e))}:{$refText:r,$error:null!==(a=null===(s=t.error)||void 0===s?void 0:s.message)&&void 0!==a?a:"Could not resolve reference"}}{let n;if(i&&l(t)&&(n=this.addAstNodeRegionWithAssignmentsTo(Object.assign({},t)),(!e||t.$document)&&(null==n?void 0:n.$textRegion)))try{n.$textRegion.documentURI=nt(t).uri.toString()}catch(e){}return r&&!e&&l(t)&&(null!=n||(n=Object.assign({},t)),n.$sourceText=null===(c=t.$cstNode)||void 0===c?void 0:c.text),o&&l(t)&&(null!=n||(n=Object.assign({},t)),n.$comment=this.commentProvider.getComment(t)),null!=n?n:t}}}addAstNodeRegionWithAssignmentsTo(e){const t=e=>({offset:e.offset,end:e.end,length:e.length,range:e.range});if(e.$cstNode){const n=(e.$textRegion=t(e.$cstNode)).assignments={};return Object.keys(e).filter((e=>!e.startsWith("$"))).forEach((r=>{const i=Uo(e.$cstNode,r).map(t);0!==i.length&&(n[r]=i)})),e}}linkNode(e,t,n,r,i){for(const[n,r]of Object.entries(e))if(Array.isArray(r))for(let i=0;i<r.length;i++){const o=r[i];hm(o)?r[i]=this.reviveReference(e,n,t,o):l(o)&&this.linkNode(o,t,e,n,i)}else hm(r)?e[n]=this.reviveReference(e,n,t,r):l(r)&&this.linkNode(r,t,e,n);const o=e;o.$container=n,o.$containerProperty=r,o.$containerIndex=i}reviveReference(e,t,n,r){let i=r.$refText;if(r.$ref){const e=this.getRefNode(n,r.$ref);return i||(i=this.nameProvider.getName(e)),{$refText:null!=i?i:"",ref:e}}if(r.$error){const n={$refText:null!=i?i:""};return n.error={container:e,property:t,message:r.$error,reference:n},n}}getRefNode(e,t){return this.astNodeLocator.getAstNode(e,t.substring(1))}}class ym{register(e){if(this.singleton||this.map){if(!this.map&&(this.map={},this.singleton)){for(const e of this.singleton.LanguageMetaData.fileExtensions)this.map[e]=this.singleton;this.singleton=void 0}for(const t of e.LanguageMetaData.fileExtensions)void 0!==this.map[t]&&this.map[t]!==e&&console.warn(`The file extension ${t} is used by multiple languages. It is now assigned to '${e.LanguageMetaData.languageId}'.`),this.map[t]=e}else this.singleton=e}getServices(e){if(void 0!==this.singleton)return this.singleton;if(void 0===this.map)throw new Error("The service registry is empty. Use `register` to register the services of a language.");const t=Un.extname(e),n=this.map[t];if(!n)throw new Error(`The service registry contains no services for the extension '${t}'.`);return n}get all(){return void 0!==this.singleton?[this.singleton]:void 0!==this.map?Object.values(this.map):[]}}class gm{constructor(e){this.astNodeLocator=e.workspace.AstNodeLocator,this.nameProvider=e.references.NameProvider}createDescription(e,t,n=nt(e)){null!=t||(t=this.nameProvider.getName(e));const r=this.astNodeLocator.getAstNodePath(e);if(!t)throw new Error(`Node at path ${r} has no name.`);let i;const o=()=>{var t;return null!=i?i:i=x(null!==(t=this.nameProvider.getNameNode(e))&&void 0!==t?t:e.$cstNode)};return{node:e,name:t,get nameSegment(){return o()},selectionSegment:x(e.$cstNode),type:e.$type,documentUri:n.uri,path:r}}}class vm{constructor(e){this.nodeLocator=e.workspace.AstNodeLocator}async createDescriptions(e,t=i.CancellationToken.None){const n=[],r=e.parseResult.value;for(const e of st(r))await Yn(t),ct(e).filter((e=>!f(e))).forEach((e=>{const t=this.createDescription(e);t&&n.push(t)}));return n}createDescription(e){const t=e.reference.$nodeDescription,n=e.reference.$refNode;if(!t||!n)return;const r=nt(e.container).uri;return{sourceUri:r,sourcePath:this.nodeLocator.getAstNodePath(e.container),targetUri:t.documentUri,targetPath:t.path,segment:x(n),local:Un.equals(t.documentUri,r)}}}class Tm{constructor(){this.segmentSeparator="/",this.indexSeparator="@"}getAstNodePath(e){if(e.$container){const t=this.getAstNodePath(e.$container),n=this.getPathSegment(e);return t+this.segmentSeparator+n}return""}getPathSegment({$containerProperty:e,$containerIndex:t}){if(!e)throw new Error("Missing '$containerProperty' in AST node.");return void 0!==t?e+this.indexSeparator+t:e}getAstNode(e,t){return t.split(this.segmentSeparator).reduce(((e,t)=>{if(!e||0===t.length)return e;const n=t.indexOf(this.indexSeparator);if(n>0){const r=t.substring(0,n),i=parseInt(t.substring(n+1)),o=e[r];return null==o?void 0:o[i]}return e[t]}),e)}}var Rm=n(2542);class km{constructor(e){this.settings={},this.workspaceConfig=!1,this.initialized=!1,this.serviceRegistry=e.ServiceRegistry,this.connection=e.lsp.Connection,e.lsp.LanguageServer.onInitialize((e=>{var t,n;this.workspaceConfig=null!==(n=null===(t=e.capabilities.workspace)||void 0===t?void 0:t.configuration)&&void 0!==n&&n})),e.lsp.LanguageServer.onInitialized((t=>{var n;const r=this.serviceRegistry.all;null===(n=e.lsp.Connection)||void 0===n||n.client.register(Rm.DidChangeConfigurationNotification.type,{section:r.map((e=>this.toSectionName(e.LanguageMetaData.languageId)))})}))}async initialize(){if(this.workspaceConfig&&this.connection){const e=this.serviceRegistry.all.map((e=>({section:this.toSectionName(e.LanguageMetaData.languageId)}))),t=await this.connection.workspace.getConfiguration(e);e.forEach(((e,n)=>{this.updateSectionConfiguration(e.section,t[n])}))}this.initialized=!0}updateConfiguration(e){e.settings&&Object.keys(e.settings).forEach((t=>{this.updateSectionConfiguration(t,e.settings[t])}))}updateSectionConfiguration(e,t){this.settings[e]=t}async getConfiguration(e,t){this.initialized||await this.initialize();const n=this.toSectionName(e);if(this.settings[n])return this.settings[n][t]}toSectionName(e){return`${e}`}}class bm{constructor(e){this.updateBuildOptions={validation:{categories:["built-in","fast"]}},this.updateListeners=[],this.buildPhaseListeners=new G,this.buildState=new Map,this.langiumDocuments=e.workspace.LangiumDocuments,this.langiumDocumentFactory=e.workspace.LangiumDocumentFactory,this.indexManager=e.workspace.IndexManager,this.serviceRegistry=e.ServiceRegistry}async build(e,t={},n=i.CancellationToken.None){var r,o;for(const n of e){const e=n.uri.toString();if(n.state===fo.Validated){if("boolean"==typeof t.validation&&t.validation)n.state=fo.IndexedReferences,n.diagnostics=void 0,this.buildState.delete(e);else if("object"==typeof t.validation){const i=this.buildState.get(e),s=null===(r=null==i?void 0:i.result)||void 0===r?void 0:r.validationChecks;if(s){const r=(null!==(o=t.validation.categories)&&void 0!==o?o:Qn.all).filter((e=>!s.includes(e)));r.length>0&&(this.buildState.set(e,{completed:!1,options:{validation:Object.assign(Object.assign({},t.validation),{categories:r})},result:i.result}),n.state=fo.IndexedReferences)}}}else this.buildState.delete(e)}await this.emitUpdate(e.map((e=>e.uri)),[]),await this.buildDocuments(e,t,n)}async update(e,t,n=i.CancellationToken.None){for(const e of t)this.langiumDocuments.deleteDocument(e),this.buildState.delete(e.toString());this.indexManager.remove(t);for(const t of e)this.langiumDocuments.invalidateDocument(t)||this.langiumDocuments.getOrCreateDocument(t),this.buildState.delete(t.toString());const r=R(e).concat(t).map((e=>e.toString())).toSet();this.langiumDocuments.all.filter((e=>!r.has(e.uri.toString())&&this.shouldRelink(e,r))).forEach((e=>{this.serviceRegistry.getServices(e.uri).references.Linker.unlink(e),e.state=Math.min(e.state,fo.ComputedScopes),e.diagnostics=void 0})),await this.emitUpdate(e,t),await Yn(n);const o=this.langiumDocuments.all.filter((e=>{var t;return e.state<fo.Linked||!(null===(t=this.buildState.get(e.uri.toString()))||void 0===t?void 0:t.completed)})).toArray();await this.buildDocuments(o,this.updateBuildOptions,n)}async emitUpdate(e,t){await Promise.all(this.updateListeners.map((n=>n(e,t))))}shouldRelink(e,t){return!!e.references.some((e=>void 0!==e.error))||this.indexManager.isAffected(e,t)}onUpdate(e){return this.updateListeners.push(e),i.Disposable.create((()=>{const t=this.updateListeners.indexOf(e);t>=0&&this.updateListeners.splice(t,1)}))}async buildDocuments(e,t,n){this.prepareBuild(e,t),await this.runCancelable(e,fo.Parsed,n,(e=>{this.langiumDocumentFactory.update(e)})),await this.runCancelable(e,fo.IndexedContent,n,(e=>this.indexManager.updateContent(e,n))),await this.runCancelable(e,fo.ComputedScopes,n,(async e=>{const t=this.serviceRegistry.getServices(e.uri).references.ScopeComputation;e.precomputedScopes=await t.computeLocalScopes(e,n)})),await this.runCancelable(e,fo.Linked,n,(e=>this.serviceRegistry.getServices(e.uri).references.Linker.link(e,n))),await this.runCancelable(e,fo.IndexedReferences,n,(e=>this.indexManager.updateReferences(e,n)));const r=e.filter((e=>this.shouldValidate(e)));await this.runCancelable(r,fo.Validated,n,(e=>this.validate(e,n)));for(const t of e){const e=this.buildState.get(t.uri.toString());e&&(e.completed=!0)}}prepareBuild(e,t){for(const n of e){const e=n.uri.toString(),r=this.buildState.get(e);r&&!r.completed||this.buildState.set(e,{completed:!1,options:t,result:null==r?void 0:r.result})}}async runCancelable(e,t,n,r){const i=e.filter((e=>e.state<t));for(const e of i)await Yn(n),await r(e),e.state=t;await this.notifyBuildPhase(i,t,n)}onBuildPhase(e,t){return this.buildPhaseListeners.add(e,t),i.Disposable.create((()=>{this.buildPhaseListeners.delete(e,t)}))}async notifyBuildPhase(e,t,n){if(0===e.length)return;const r=this.buildPhaseListeners.get(t);for(const t of r)await Yn(n),await t(e,n)}shouldValidate(e){return Boolean(this.getBuildOptions(e).validation)}async validate(e,t){var n,r;const i=this.serviceRegistry.getServices(e.uri).validation.DocumentValidator,o=this.getBuildOptions(e).validation,s="object"==typeof o?o:void 0,a=await i.validateDocument(e,s,t);e.diagnostics?e.diagnostics.push(...a):e.diagnostics=a;const c=this.buildState.get(e.uri.toString());if(c){null!==(n=c.result)&&void 0!==n||(c.result={});const e=null!==(r=null==s?void 0:s.categories)&&void 0!==r?r:Qn.all;c.result.validationChecks?c.result.validationChecks.push(...e):c.result.validationChecks=[...e]}}getBuildOptions(e){var t,n;return null!==(n=null===(t=this.buildState.get(e.uri.toString()))||void 0===t?void 0:t.options)&&void 0!==n?n:{}}}class wm{constructor(e){this.simpleIndex=new Map,this.simpleTypeIndex=new fi,this.referenceIndex=new Map,this.documents=e.workspace.LangiumDocuments,this.serviceRegistry=e.ServiceRegistry,this.astReflection=e.AstReflection}findAllReferences(e,t){const n=nt(e).uri,r=[];return this.referenceIndex.forEach((e=>{e.forEach((e=>{Un.equals(e.targetUri,n)&&e.targetPath===t&&r.push(e)}))})),R(r)}allElements(e,t){let n=R(this.simpleIndex.keys());return t&&(n=n.filter((e=>!t||t.has(e)))),n.map((t=>this.getFileDescriptions(t,e))).flat()}getFileDescriptions(e,t){var n;if(!t)return null!==(n=this.simpleIndex.get(e))&&void 0!==n?n:[];const r=this.simpleTypeIndex.get(e,t,(()=>{var n;return(null!==(n=this.simpleIndex.get(e))&&void 0!==n?n:[]).filter((e=>this.astReflection.isSubtype(e.type,t)))}));return r}remove(e){for(const t of e){const e=t.toString();this.simpleIndex.delete(e),this.simpleTypeIndex.clear(e),this.referenceIndex.delete(e)}}async updateContent(e,t=i.CancellationToken.None){const n=this.serviceRegistry.getServices(e.uri),r=await n.references.ScopeComputation.computeExports(e,t);for(const e of r)e.node=void 0;const o=e.uri.toString();this.simpleIndex.set(o,r),this.simpleTypeIndex.clear(o)}async updateReferences(e,t=i.CancellationToken.None){const n=this.serviceRegistry.getServices(e.uri),r=await n.workspace.ReferenceDescriptionProvider.createDescriptions(e,t);this.referenceIndex.set(e.uri.toString(),r)}isAffected(e,t){const n=this.referenceIndex.get(e.uri.toString());return!!n&&n.some((e=>!e.local&&t.has(e.targetUri.toString())))}}class Sm{constructor(e){this.initialBuildOptions={},this.serviceRegistry=e.ServiceRegistry,this.langiumDocuments=e.workspace.LangiumDocuments,this.documentBuilder=e.workspace.DocumentBuilder,this.fileSystemProvider=e.workspace.FileSystemProvider,this.mutex=e.workspace.MutexLock,e.lsp.LanguageServer.onInitialize((e=>{var t;this.folders=null!==(t=e.workspaceFolders)&&void 0!==t?t:void 0})),e.lsp.LanguageServer.onInitialized((e=>{this.mutex.lock((e=>{var t;return this.initializeWorkspace(null!==(t=this.folders)&&void 0!==t?t:[],e)}))}))}async initializeWorkspace(e,t=i.CancellationToken.None){const n=this.serviceRegistry.all.flatMap((e=>e.LanguageMetaData.fileExtensions)),r=[],o=e=>{r.push(e),this.langiumDocuments.hasDocument(e.uri)||this.langiumDocuments.addDocument(e)};await this.loadAdditionalDocuments(e,o),await Promise.all(e.map((e=>[e,this.getRootFolder(e)])).map((async e=>this.traverseFolder(...e,n,o)))),await Yn(t),await this.documentBuilder.build(r,this.initialBuildOptions,t)}loadAdditionalDocuments(e,t){return Promise.resolve()}getRootFolder(e){return jn.parse(e.uri)}async traverseFolder(e,t,n,r){const i=await this.fileSystemProvider.readDirectory(t);await Promise.all(i.map((async t=>{if(this.includeEntry(e,t,n))if(t.isDirectory)await this.traverseFolder(e,t.uri,n,r);else if(t.isFile){const e=this.langiumDocuments.getOrCreateDocument(t.uri);r(e)}})))}includeEntry(e,t,n){const r=Un.basename(t.uri);if(r.startsWith("."))return!1;if(t.isDirectory)return"node_modules"!==r&&"out"!==r;if(t.isFile){const e=Un.extname(t.uri);return n.includes(e)}return!1}}class $m{constructor(e){const t=e.parser.TokenBuilder.buildTokens(e.Grammar,{caseInsensitive:e.LanguageMetaData.caseInsensitive});this.tokenTypes=this.toTokenTypeDictionary(t);const n=Cm(t)?Object.values(t):t;this.chevrotainLexer=new zd(n,{positionTracking:"full"})}get definition(){return this.tokenTypes}tokenize(e){var t;const n=this.chevrotainLexer.tokenize(e);return{tokens:n.tokens,errors:n.errors,hidden:null!==(t=n.groups.hidden)&&void 0!==t?t:[]}}toTokenTypeDictionary(e){if(Cm(e))return e;const t=xm(e)?Object.values(e.modes).flat():e,n={};return t.forEach((e=>n[e.name]=e)),n}}function xm(e){return e&&"modes"in e&&"defaultMode"in e}function Cm(e){return!function(e){return Array.isArray(e)&&(0===e.length||"name"in e[0])}(e)&&!xm(e)}function Em(e){let t="";return t="string"==typeof e?e:e.text,t.split(vt)}const Am=/\s*(@([\p{L}][\p{L}\p{N}]*)?)/uy,Nm=/\{(@[\p{L}][\p{L}\p{N}]*)(\s*)([^\r\n}]+)?\}/gu;function Dm(e,t,n,r){const o=[];if(0===e.length){const e=i.Position.create(n,r),s=i.Position.create(n,r+t.length);o.push({type:"text",content:t,range:i.Range.create(e,s)})}else{let s=0;for(const a of e){const e=a.index,c=t.substring(s,e);c.length>0&&o.push({type:"text",content:t.substring(s,e),range:i.Range.create(i.Position.create(n,s+r),i.Position.create(n,e+r))});let u=c.length+1;const l=a[1];if(o.push({type:"inline-tag",content:l,range:i.Range.create(i.Position.create(n,s+u+r),i.Position.create(n,s+u+l.length+r))}),u+=l.length,4===a.length){u+=a[2].length;const e=a[3];o.push({type:"text",content:e,range:i.Range.create(i.Position.create(n,s+u+r),i.Position.create(n,s+u+e.length+r))})}else o.push({type:"text",content:"",range:i.Range.create(i.Position.create(n,s+u+r),i.Position.create(n,s+u+r))});s=e+a[0].length}const a=t.substring(s);a.length>0&&o.push({type:"text",content:a,range:i.Range.create(i.Position.create(n,s+r),i.Position.create(n,s+r+a.length))})}return o}const _m=/\S/,Im=/\s*$/;function Pm(e,t){const n=e.substring(t).match(_m);return n?t+n.index:e.length}function Om(e){const t=e.match(Im);if(t&&"number"==typeof t.index)return t.index}function Lm(e,t){const n=e.tokens[e.index];return"tag"===n.type?jm(e,!1):"text"===n.type||"inline-tag"===n.type?Mm(e):(function(e,t){if(t){const n=new Bm("",e.range);"inlines"in t?t.inlines.push(n):t.content.inlines.push(n)}}(n,t),void e.index++)}function Mm(e){let t=e.tokens[e.index];const n=t;let r=t;const o=[];for(;t&&"break"!==t.type&&"tag"!==t.type;)o.push(Fm(e)),r=t,t=e.tokens[e.index];return new Wm(o,i.Range.create(n.range.start,r.range.end))}function Fm(e){return"inline-tag"===e.tokens[e.index].type?jm(e,!0):qm(e)}function jm(e,t){const n=e.tokens[e.index++],r=n.content.substring(1),o=e.tokens[e.index];if("text"===(null==o?void 0:o.type)){if(t){const o=qm(e);return new Hm(r,new Wm([o],o.range),t,i.Range.create(n.range.start,o.range.end))}{const o=Mm(e);return new Hm(r,o,t,i.Range.create(n.range.start,o.range.end))}}{const e=n.range;return new Hm(r,new Wm([],e),t,e)}}function qm(e){const t=e.tokens[e.index++];return new Bm(t.content,t.range)}function Um(e){if(!e)return Um({start:"/**",end:"*/",line:"*"});const{start:t,end:n,line:r}=e;return{start:Km(t,!0),end:Km(n,!1),line:Km(r,!0)}}function Km(e,t){if("string"==typeof e||"object"==typeof e){const n="string"==typeof e?Mn(e):e.source;return t?new RegExp(`^\\s*${n}`):new RegExp(`\\s*${n}\\s*$`)}return e}class Gm{constructor(e,t){this.elements=e,this.range=t}getTag(e){return this.getAllTags().find((t=>t.name===e))}getTags(e){return this.getAllTags().filter((t=>t.name===e))}getAllTags(){return this.elements.filter((e=>"name"in e))}toString(){let e="";for(const t of this.elements)if(0===e.length)e=t.toString();else{const n=t.toString();e+=zm(e)+n}return e.trim()}toMarkdown(e){let t="";for(const n of this.elements)if(0===t.length)t=n.toMarkdown(e);else{const r=n.toMarkdown(e);t+=zm(t)+r}return t.trim()}}class Hm{constructor(e,t,n,r){this.name=e,this.content=t,this.inline=n,this.range=r}toString(){let e=`@${this.name}`;const t=this.content.toString();return 1===this.content.inlines.length?e=`${e} ${t}`:this.content.inlines.length>1&&(e=`${e}\n${t}`),this.inline?`{${e}}`:e}toMarkdown(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.renderTag)||void 0===t?void 0:t.call(e,this))&&void 0!==n?n:this.toMarkdownDefault(e)}toMarkdownDefault(e){const t=this.content.toMarkdown(e);if(this.inline){const n=function(e,t,n){var r,i;if("linkplain"===e||"linkcode"===e||"link"===e){const o=t.indexOf(" ");let s=t;if(o>0){const e=Pm(t,o);s=t.substring(e),t=t.substring(0,o)}("linkcode"===e||"link"===e&&"code"===n.link)&&(s=`\`${s}\``);const a=null!==(i=null===(r=n.renderLink)||void 0===r?void 0:r.call(n,t,s))&&void 0!==i?i:function(e,t){try{return jn.parse(e,!0),`[${t}](${e})`}catch(t){return e}}(t,s);return a}}(this.name,t,null!=e?e:{});if("string"==typeof n)return n}let n="";"italic"===(null==e?void 0:e.tag)||void 0===(null==e?void 0:e.tag)?n="*":"bold"===(null==e?void 0:e.tag)?n="**":"bold-italic"===(null==e?void 0:e.tag)&&(n="***");let r=`${n}@${this.name}${n}`;return 1===this.content.inlines.length?r=`${r}  ${t}`:this.content.inlines.length>1&&(r=`${r}\n${t}`),this.inline?`{${r}}`:r}}class Wm{constructor(e,t){this.inlines=e,this.range=t}toString(){let e="";for(let t=0;t<this.inlines.length;t++){const n=this.inlines[t],r=this.inlines[t+1];e+=n.toString(),r&&r.range.start.line>n.range.start.line&&(e+="\n")}return e}toMarkdown(e){let t="";for(let n=0;n<this.inlines.length;n++){const r=this.inlines[n],i=this.inlines[n+1];t+=r.toMarkdown(e),i&&i.range.start.line>r.range.start.line&&(t+="\n")}return t}}class Bm{constructor(e,t){this.text=e,this.range=t}toString(){return this.text}toMarkdown(){return this.text}}function zm(e){return e.endsWith("\n")?"\n":"\n\n"}class Vm{constructor(e){this.indexManager=e.shared.workspace.IndexManager,this.commentProvider=e.documentation.CommentProvider}getDocumentation(e){const t=this.commentProvider.getComment(e);if(t&&function(e,t){const n=Um(void 0),r=Em(e);if(0===r.length)return!1;const i=r[0],o=r[r.length-1],s=n.start,a=n.end;return Boolean(null==s?void 0:s.exec(i))&&Boolean(null==a?void 0:a.exec(o))}(t))return function(e,t,n){let r,o;"string"==typeof e?(o=t,r=n):(o=e.range.start,r=t),o||(o=i.Position.create(0,0));const s=function(e){var t,n,r;const o=[];let s=e.position.line,a=e.position.character;for(let c=0;c<e.lines.length;c++){const u=0===c,l=c===e.lines.length-1;let d=e.lines[c],f=0;if(u&&e.options.start){const n=null===(t=e.options.start)||void 0===t?void 0:t.exec(d);n&&(f=n.index+n[0].length)}else{const t=null===(n=e.options.line)||void 0===n?void 0:n.exec(d);t&&(f=t.index+t[0].length)}if(l){const t=null===(r=e.options.end)||void 0===r?void 0:r.exec(d);t&&(d=d.substring(0,t.index))}if(d=d.substring(0,Om(d)),Pm(d,f)>=d.length){if(o.length>0){const e=i.Position.create(s,a);o.push({type:"break",content:"",range:i.Range.create(e,e)})}}else{Am.lastIndex=f;const e=Am.exec(d);if(e){const t=e[0],n=e[1],r=i.Position.create(s,a+f),c=i.Position.create(s,a+f+t.length);o.push({type:"tag",content:n,range:i.Range.create(r,c)}),f+=t.length,f=Pm(d,f)}if(f<d.length){const e=d.substring(f),t=Array.from(e.matchAll(Nm));o.push(...Dm(t,e,s,a+f))}}s++,a=0}return o.length>0&&"break"===o[o.length-1].type?o.slice(0,-1):o}({lines:Em(e),position:o,options:Um(r)});return function(e){var t,n,r,o;const s=i.Position.create(e.position.line,e.position.character);if(0===e.tokens.length)return new Gm([],i.Range.create(s,s));const a=[];for(;e.index<e.tokens.length;){const t=Lm(e,a[a.length-1]);t&&a.push(t)}const c=null!==(n=null===(t=a[0])||void 0===t?void 0:t.range.start)&&void 0!==n?n:s,u=null!==(o=null===(r=a[a.length-1])||void 0===r?void 0:r.range.end)&&void 0!==o?o:s;return new Gm(a,i.Range.create(c,u))}({index:0,tokens:s,position:o})}(t).toMarkdown({renderLink:(t,n)=>this.documentationLinkRenderer(e,t,n),renderTag:t=>this.documentationTagRenderer(e,t)})}documentationLinkRenderer(e,t,n){var r;const i=null!==(r=this.findNameInPrecomputedScopes(e,t))&&void 0!==r?r:this.findNameInGlobalScope(e,t);if(i&&i.nameSegment){const e=i.nameSegment.range.start.line+1,t=i.nameSegment.range.start.character+1;return`[${n}](${i.documentUri.with({fragment:`L${e},${t}`}).toString()})`}}documentationTagRenderer(e,t){}findNameInPrecomputedScopes(e,t){const n=nt(e).precomputedScopes;if(!n)return;let r=e;do{const e=n.get(r).find((e=>e.name===t));if(e)return e;r=r.$container}while(r)}findNameInGlobalScope(e,t){return this.indexManager.allElements().find((e=>e.name===t))}}class Ym{constructor(e){this.grammarConfig=()=>e.parser.GrammarConfig}getComment(e){var t;return function(e){return"string"==typeof e.$comment}(e)?e.$comment:null===(t=function(e,t){if(e){const r=function(e,t=!0){for(;e.container;){const n=e.container;let r=n.content.indexOf(e);for(;r>0;){r--;const e=n.content[r];if(t||!e.hidden)return e}e=n}}(e,!0);if(r&&N(r,t))return r;if(h(n=e)&&"string"==typeof n.fullText)for(let n=e.content.findIndex((e=>!e.hidden))-1;n>=0;n--){const r=e.content[n];if(N(r,t))return r}}var n}(e.$cstNode,this.grammarConfig().multilineCommentRules))||void 0===t?void 0:t.text}}function Xm(e){return{documentation:{CommentProvider:e=>new Ym(e),DocumentationProvider:e=>new Vm(e)},parser:{GrammarConfig:e=>function(e){const t=[],n=e.Grammar;for(const e of n.rules)Re(e)&&(r=e).hidden&&!Cr(r).test(" ")&&On(Cr(e))&&t.push(e.name);var r;return{multilineCommentRules:t,nameRegexp:E}}(e),LangiumParser:e=>function(e){const t=function(e){const t=e.Grammar,n=e.parser.Lexer;return nm(t,new Vh(e),n.definition)}(e);return t.finalize(),t}(e),CompletionParser:e=>function(e){const t=e.Grammar,n=e.parser.Lexer,r=new Jh(e);return nm(t,r,n.definition),r.finalize(),r}(e),ValueConverter:()=>new dm,TokenBuilder:()=>new lm,Lexer:e=>new $m(e),ParserErrorMessageProvider:()=>new Xh},lsp:{CompletionProvider:e=>new Pi(e),DocumentSymbolProvider:e=>new no(e),HoverProvider:e=>new lo(e),FoldingRangeProvider:e=>new Li(e),ReferencesProvider:e=>new vo(e),DefinitionProvider:e=>new eo(e),DocumentHighlightProvider:e=>new to(e),RenameProvider:e=>new To(e)},workspace:{AstNodeLocator:()=>new Tm,AstNodeDescriptionProvider:e=>new gm(e),ReferenceDescriptionProvider:e=>new vm(e)},references:{Linker:e=>new pm(e),NameProvider:()=>new vn,ScopeProvider:e=>new hi(e),ScopeComputation:e=>new ui(e),References:e=>new Ji(e)},serializer:{JsonSerializer:e=>new mm(e)},validation:{DocumentValidator:e=>new gi(e),ValidationRegistry:e=>new er(e)},shared:()=>e.shared}}function Jm(e){return{ServiceRegistry:()=>new ym,lsp:{Connection:()=>e.connection,LanguageServer:e=>new yo(e),WorkspaceSymbolProvider:e=>new Ro(e),NodeKindProvider:()=>new go,FuzzyMatcher:()=>new ro},workspace:{LangiumDocuments:e=>new mo(e),LangiumDocumentFactory:e=>new ho(e),DocumentBuilder:e=>new bm(e),TextDocuments:()=>new i.TextDocuments(r),IndexManager:e=>new wm(e),WorkspaceManager:e=>new Sm(e),FileSystemProvider:t=>e.fileSystemProvider(t),MutexLock:()=>new Xn,ConfigurationProvider:e=>new km(e)}}}var Qm;!function(e){e.create=function(e){return{dispose:async()=>await e()}}}(Qm||(Qm={}));const Zm="Definition";function ey(e){return my.isInstance(e,Zm)}const ty="Element",ny="ArrayType",ry="ForMember";function iy(e){return my.isInstance(e,ry)}const oy="InterfaceDefinition";function sy(e){return my.isInstance(e,oy)}function ay(e){return my.isInstance(e,"Model")}const cy="ObjectType",uy="SubjectDefinition";function ly(e){return my.isInstance(e,uy)}const dy="TypeDefinition",fy="UserDefinition";function py(e){return my.isInstance(e,fy)}class hy extends p{getAllTypes(){return["ActionMember","ArrayMemberAccess","ArrayType","BinaryExpression","BooleanLiteral","BooleanType","Definition","Element","Expression","ForMember","InterfaceDefinition","Model","NullLiteral","NullType","NumberLiteral","NumberType","ObjectType","Parentheses","PermissionBody","PermissionMember","PropertyMember","PropertyMemberAccess","RoleDefinition","RootMember","SelectEverthing","SelectSingle","StringLiteral","StringType","SubjectDefinition","TypeDefinition","TypeDefinitionReference","TypeReference","UnaryExpression","UserDefinition","UserMemberDefinition"]}computeIsSubtype(e,t){switch(e){case"ArrayMemberAccess":case"BinaryExpression":case"BooleanLiteral":case"NullLiteral":case"NumberLiteral":case"Parentheses":case"PropertyMemberAccess":case"RootMember":case"StringLiteral":case"UnaryExpression":return this.isSubtype("Expression",t);case ny:case"BooleanType":case"NullType":case"NumberType":case cy:case"StringType":case"TypeDefinitionReference":return this.isSubtype("TypeReference",t);case oy:case dy:return this.isSubtype(Zm,t)||this.isSubtype(ty,t);case"RoleDefinition":case uy:return this.isSubtype("UserMemberDefinition",t);case"SelectEverthing":case"SelectSingle":return this.isSubtype("PermissionBody",t);case fy:return this.isSubtype(ty,t);default:return!1}}getReferenceType(e){const t=`${e.container.$type}:${e.property}`;switch(t){case"ActionMember:superAction":case"SelectSingle:action":return"ActionMember";case"ForMember:subject":return uy;case"InterfaceDefinition:superInterface":case"SubjectDefinition:type":case"UserDefinition:type":return oy;case"PropertyMemberAccess:member":return"PropertyMember";case"TypeDefinitionReference:type":return Zm;default:throw new Error(`${t} is not a valid reference id.`)}}getTypeMetaData(e){switch(e){case"ForMember":return{name:"ForMember",mandatory:[{name:"members",type:"array"}]};case"InterfaceDefinition":return{name:"InterfaceDefinition",mandatory:[{name:"members",type:"array"}]};case"Model":return{name:"Model",mandatory:[{name:"elements",type:"array"}]};case"ObjectType":return{name:"ObjectType",mandatory:[{name:"members",type:"array"}]};case"PermissionMember":return{name:"PermissionMember",mandatory:[{name:"allows",type:"boolean"}]};case"RoleDefinition":return{name:"RoleDefinition",mandatory:[{name:"members",type:"array"}]};case"RootMember":return{name:"RootMember",mandatory:[{name:"isSubjectRoot",type:"boolean"}]};case"SubjectDefinition":return{name:"SubjectDefinition",mandatory:[{name:"members",type:"array"}]};case"UserDefinition":return{name:"UserDefinition",mandatory:[{name:"members",type:"array"}]};default:return{name:e,mandatory:[]}}}}const my=new hy;let yy;const gy={languageId:"ecchi",fileExtensions:[".ecchi"],caseInsensitive:!1},vy={AstReflection:()=>new hy},Ty={Grammar:()=>null!=yy?yy:yy=Xo('{\n  "$type": "Grammar",\n  "isDeclared": true,\n  "name": "Ecchi",\n  "rules": [\n    {\n      "$type": "ParserRule",\n      "name": "Model",\n      "entry": true,\n      "definition": {\n        "$type": "Assignment",\n        "feature": "elements",\n        "operator": "+=",\n        "terminal": {\n          "$type": "RuleCall",\n          "rule": {\n            "$ref": "#/rules@1"\n          },\n          "arguments": []\n        },\n        "cardinality": "*"\n      },\n      "definesHiddenTokens": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Element",\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@2"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@3"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@4"\n            },\n            "arguments": []\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "InterfaceDefinition",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "interface"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Keyword",\n                "value": "extends"\n              },\n              {\n                "$type": "Assignment",\n                "feature": "superInterface",\n                "operator": "=",\n                "terminal": {\n                  "$type": "CrossReference",\n                  "type": {\n                    "$ref": "#/rules@2"\n                  },\n                  "terminal": {\n                    "$type": "RuleCall",\n                    "rule": {\n                      "$ref": "#/rules@26"\n                    },\n                    "arguments": []\n                  },\n                  "deprecatedSyntax": false\n                }\n              }\n            ],\n            "cardinality": "?"\n          },\n          {\n            "$type": "Keyword",\n            "value": "{"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "members",\n            "operator": "+=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@11"\n              },\n              "arguments": []\n            },\n            "cardinality": "*"\n          },\n          {\n            "$type": "Keyword",\n            "value": "}"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "TypeDefinition",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "type"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "="\n          },\n          {\n            "$type": "Assignment",\n            "feature": "expression",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@13"\n              },\n              "arguments": []\n            }\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "UserDefinition",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "user"\n          },\n          {\n            "$type": "Keyword",\n            "value": "of"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "type",\n            "operator": "=",\n            "terminal": {\n              "$type": "CrossReference",\n              "type": {\n                "$ref": "#/rules@2"\n              },\n              "terminal": {\n                "$type": "RuleCall",\n                "rule": {\n                  "$ref": "#/rules@26"\n                },\n                "arguments": []\n              },\n              "deprecatedSyntax": false\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "{"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "members",\n            "operator": "+=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@5"\n              },\n              "arguments": []\n            },\n            "cardinality": "*"\n          },\n          {\n            "$type": "Keyword",\n            "value": "}"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "UserMemberDefinition",\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@6"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@7"\n            },\n            "arguments": []\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "SubjectDefinition",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "subject"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "of"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "type",\n            "operator": "=",\n            "terminal": {\n              "$type": "CrossReference",\n              "type": {\n                "$ref": "#/rules@2"\n              },\n              "terminal": {\n                "$type": "RuleCall",\n                "rule": {\n                  "$ref": "#/rules@26"\n                },\n                "arguments": []\n              },\n              "deprecatedSyntax": false\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "{"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "members",\n            "operator": "+=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@12"\n              },\n              "arguments": []\n            },\n            "cardinality": "*"\n          },\n          {\n            "$type": "Keyword",\n            "value": "}"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "RoleDefinition",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "role"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "{"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "members",\n            "operator": "+=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@8"\n              },\n              "arguments": []\n            },\n            "cardinality": "*"\n          },\n          {\n            "$type": "Keyword",\n            "value": "}"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "ForMember",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "for"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "subject",\n            "operator": "=",\n            "terminal": {\n              "$type": "CrossReference",\n              "type": {\n                "$ref": "#/rules@6"\n              },\n              "terminal": {\n                "$type": "RuleCall",\n                "rule": {\n                  "$ref": "#/rules@26"\n                },\n                "arguments": []\n              },\n              "deprecatedSyntax": false\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": "{"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "members",\n            "operator": "+=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@9"\n              },\n              "arguments": []\n            },\n            "cardinality": "*"\n          },\n          {\n            "$type": "Keyword",\n            "value": "}"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "PermissionMember",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Alternatives",\n            "elements": [\n              {\n                "$type": "Assignment",\n                "feature": "allows",\n                "operator": "?=",\n                "terminal": {\n                  "$type": "Keyword",\n                  "value": "allow"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "forbid"\n              }\n            ]\n          },\n          {\n            "$type": "Assignment",\n            "feature": "body",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@10"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": ";",\n            "cardinality": "?"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "PermissionBody",\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "SelectEverthing"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "*"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "SelectSingle"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "action",\n                "operator": "=",\n                "terminal": {\n                  "$type": "CrossReference",\n                  "type": {\n                    "$ref": "#/rules@12"\n                  },\n                  "terminal": {\n                    "$type": "RuleCall",\n                    "rule": {\n                      "$ref": "#/rules@26"\n                    },\n                    "arguments": []\n                  },\n                  "deprecatedSyntax": false\n                }\n              },\n              {\n                "$type": "Group",\n                "elements": [\n                  {\n                    "$type": "Keyword",\n                    "value": "when"\n                  },\n                  {\n                    "$type": "Assignment",\n                    "feature": "condition",\n                    "operator": "=",\n                    "terminal": {\n                      "$type": "RuleCall",\n                      "rule": {\n                        "$ref": "#/rules@14"\n                      },\n                      "arguments": []\n                    }\n                  }\n                ],\n                "cardinality": "?"\n              }\n            ]\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "PropertyMember",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": ":"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "type",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@13"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Keyword",\n            "value": ";",\n            "cardinality": "?"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "ActionMember",\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "Keyword",\n            "value": "action"\n          },\n          {\n            "$type": "Assignment",\n            "feature": "name",\n            "operator": "=",\n            "terminal": {\n              "$type": "RuleCall",\n              "rule": {\n                "$ref": "#/rules@26"\n              },\n              "arguments": []\n            }\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Keyword",\n                "value": "extends"\n              },\n              {\n                "$type": "Assignment",\n                "feature": "superAction",\n                "operator": "=",\n                "terminal": {\n                  "$type": "CrossReference",\n                  "type": {\n                    "$ref": "#/rules@12"\n                  },\n                  "terminal": {\n                    "$type": "RuleCall",\n                    "rule": {\n                      "$ref": "#/rules@26"\n                    },\n                    "arguments": []\n                  },\n                  "deprecatedSyntax": false\n                }\n              }\n            ],\n            "cardinality": "?"\n          },\n          {\n            "$type": "Keyword",\n            "value": ";",\n            "cardinality": "?"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "TypeReference",\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "TypeDefinitionReference"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "type",\n                "operator": "=",\n                "terminal": {\n                  "$type": "CrossReference",\n                  "type": {\n                    "$ref": "#/types@0"\n                  },\n                  "terminal": {\n                    "$type": "RuleCall",\n                    "rule": {\n                      "$ref": "#/rules@26"\n                    },\n                    "arguments": []\n                  },\n                  "deprecatedSyntax": false\n                }\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "NumberType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "number"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "StringType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "string"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BooleanType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "boolean"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "NullType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "null"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "ArrayType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "["\n              },\n              {\n                "$type": "Assignment",\n                "feature": "type",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@13"\n                  },\n                  "arguments": []\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "]"\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "ObjectType"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "{"\n              },\n              {\n                "$type": "Assignment",\n                "feature": "members",\n                "operator": "+=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@11"\n                  },\n                  "arguments": []\n                },\n                "cardinality": "*"\n              },\n              {\n                "$type": "Keyword",\n                "value": "}"\n              }\n            ]\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Expression",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "RuleCall",\n        "rule": {\n          "$ref": "#/rules@15"\n        },\n        "arguments": []\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Or",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@16"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Keyword",\n                  "value": "||"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@16"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "And",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@17"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Keyword",\n                  "value": "&&"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@17"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Equal",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@18"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "=="\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "!="\n                    }\n                  ]\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@18"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Relation",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@19"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "<="\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": ">="\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "<"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": ">"\n                    }\n                  ]\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@19"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Multiply",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@20"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "/"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "*"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "%"\n                    }\n                  ]\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@20"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Addition",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@21"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BinaryExpression"\n                },\n                "feature": "left",\n                "operator": "="\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "+"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "-"\n                    }\n                  ]\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "right",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@21"\n                  },\n                  "arguments": []\n                }\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Unary",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "UnaryExpression"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "op",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "!"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "-"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "+"\n                    }\n                  ]\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "expression",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@21"\n                  },\n                  "arguments": []\n                }\n              }\n            ]\n          },\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@22"\n            },\n            "arguments": []\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Term",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Group",\n        "elements": [\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@23"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Alternatives",\n            "elements": [\n              {\n                "$type": "Group",\n                "elements": [\n                  {\n                    "$type": "Action",\n                    "inferredType": {\n                      "$type": "InferredType",\n                      "name": "PropertyMemberAccess"\n                    },\n                    "feature": "receiver",\n                    "operator": "="\n                  },\n                  {\n                    "$type": "Keyword",\n                    "value": "."\n                  },\n                  {\n                    "$type": "Assignment",\n                    "feature": "member",\n                    "operator": "=",\n                    "terminal": {\n                      "$type": "CrossReference",\n                      "type": {\n                        "$ref": "#/rules@11"\n                      },\n                      "terminal": {\n                        "$type": "RuleCall",\n                        "rule": {\n                          "$ref": "#/rules@26"\n                        },\n                        "arguments": []\n                      },\n                      "deprecatedSyntax": false\n                    }\n                  }\n                ]\n              },\n              {\n                "$type": "Group",\n                "elements": [\n                  {\n                    "$type": "Action",\n                    "inferredType": {\n                      "$type": "InferredType",\n                      "name": "ArrayMemberAccess"\n                    },\n                    "feature": "receiver",\n                    "operator": "="\n                  },\n                  {\n                    "$type": "Keyword",\n                    "value": "["\n                  },\n                  {\n                    "$type": "Assignment",\n                    "feature": "expr",\n                    "operator": "=",\n                    "terminal": {\n                      "$type": "RuleCall",\n                      "rule": {\n                        "$ref": "#/rules@14"\n                      },\n                      "arguments": []\n                    }\n                  },\n                  {\n                    "$type": "Keyword",\n                    "value": "]"\n                  }\n                ]\n              }\n            ],\n            "cardinality": "*"\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Primary",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "Parentheses"\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": "("\n              },\n              {\n                "$type": "Assignment",\n                "feature": "expr",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@14"\n                  },\n                  "arguments": []\n                }\n              },\n              {\n                "$type": "Keyword",\n                "value": ")"\n              }\n            ]\n          },\n          {\n            "$type": "RuleCall",\n            "rule": {\n              "$ref": "#/rules@24"\n            },\n            "arguments": []\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "RootMember"\n                }\n              },\n              {\n                "$type": "Alternatives",\n                "elements": [\n                  {\n                    "$type": "Assignment",\n                    "feature": "isSubjectRoot",\n                    "operator": "?=",\n                    "terminal": {\n                      "$type": "Keyword",\n                      "value": "subject"\n                    }\n                  },\n                  {\n                    "$type": "Keyword",\n                    "value": "user"\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "ParserRule",\n      "name": "Literal",\n      "inferredType": {\n        "$type": "InferredType",\n        "name": "Expression"\n      },\n      "definition": {\n        "$type": "Alternatives",\n        "elements": [\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "NumberLiteral"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "value",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@27"\n                  },\n                  "arguments": []\n                }\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "StringLiteral"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "value",\n                "operator": "=",\n                "terminal": {\n                  "$type": "RuleCall",\n                  "rule": {\n                    "$ref": "#/rules@28"\n                  },\n                  "arguments": []\n                }\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "BooleanLiteral"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "value",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Alternatives",\n                  "elements": [\n                    {\n                      "$type": "Keyword",\n                      "value": "true"\n                    },\n                    {\n                      "$type": "Keyword",\n                      "value": "false"\n                    }\n                  ]\n                }\n              }\n            ]\n          },\n          {\n            "$type": "Group",\n            "elements": [\n              {\n                "$type": "Action",\n                "inferredType": {\n                  "$type": "InferredType",\n                  "name": "NullLiteral"\n                }\n              },\n              {\n                "$type": "Assignment",\n                "feature": "value",\n                "operator": "=",\n                "terminal": {\n                  "$type": "Keyword",\n                  "value": "null"\n                }\n              }\n            ]\n          }\n        ]\n      },\n      "definesHiddenTokens": false,\n      "entry": false,\n      "fragment": false,\n      "hiddenTokens": [],\n      "parameters": [],\n      "wildcard": false\n    },\n    {\n      "$type": "TerminalRule",\n      "hidden": true,\n      "name": "WS",\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/\\\\s+/"\n      },\n      "fragment": false\n    },\n    {\n      "$type": "TerminalRule",\n      "name": "ID",\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/[_a-zA-Z][\\\\w_]*/"\n      },\n      "fragment": false,\n      "hidden": false\n    },\n    {\n      "$type": "TerminalRule",\n      "name": "NUMBER",\n      "type": {\n        "$type": "ReturnType",\n        "name": "number"\n      },\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/[0-9]+(\\\\.[0-9]*)?/"\n      },\n      "fragment": false,\n      "hidden": false\n    },\n    {\n      "$type": "TerminalRule",\n      "name": "STRING",\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/\\"(\\\\\\\\.|[^\\"\\\\\\\\])*\\"|\'(\\\\\\\\.|[^\'\\\\\\\\])*\'/"\n      },\n      "fragment": false,\n      "hidden": false\n    },\n    {\n      "$type": "TerminalRule",\n      "hidden": true,\n      "name": "ML_COMMENT",\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\//"\n      },\n      "fragment": false\n    },\n    {\n      "$type": "TerminalRule",\n      "hidden": true,\n      "name": "SL_COMMENT",\n      "definition": {\n        "$type": "RegexToken",\n        "regex": "/\\\\/\\\\/[^\\\\n\\\\r]*/"\n      },\n      "fragment": false\n    }\n  ],\n  "types": [\n    {\n      "$type": "Type",\n      "name": "Definition",\n      "type": {\n        "$type": "UnionType",\n        "types": [\n          {\n            "$type": "SimpleType",\n            "typeRef": {\n              "$ref": "#/rules@2"\n            }\n          },\n          {\n            "$type": "SimpleType",\n            "typeRef": {\n              "$ref": "#/rules@3"\n            }\n          }\n        ]\n      }\n    }\n  ],\n  "definesHiddenTokens": false,\n  "hiddenTokens": [],\n  "imports": [],\n  "interfaces": [],\n  "usedGrammars": []\n}'),LanguageMetaData:()=>gy,parser:{}};class Ry{checkModel(e,t){}}class ky extends Error{constructor(e,t,n){super(e),this.expression=t,this.property=n}}const by=()=>({$type:"BooleanType",$container:void 0}),wy=()=>({$type:"NullType",$container:void 0}),Sy=()=>({$type:"NumberType",$container:void 0}),$y=()=>({$type:"StringType",$container:void 0}),xy=e=>({$type:"ObjectType",members:e.members,$container:void 0});function Cy(e){switch(e.$type){case"ArrayMemberAccess":return function(e){const t=Cy(e.receiver);if(n=t,my.isInstance(n,ny))return t.type;var n;throw new ky("Array access requires array as receiver.",e,"receiver")}(e);case"BooleanLiteral":return by();case"NullLiteral":return wy();case"NumberLiteral":return Sy();case"Parentheses":return Cy(e.expr);case"PropertyMemberAccess":return function(e){var t;const n=null===(t=e.member.ref)||void 0===t?void 0:t.type;if(!n)throw new ky("Unknown member type.",e,"member");if("TypeDefinitionReference"!==n.$type)return n;{const t=n.type.ref;if(!t)throw new ky("Unknown member type.",e,"member");if(sy(t))return xy(t);if(r=t,my.isInstance(r,dy))return t.expression;tm()}var r}(e);case"RootMember":return function(e){var t;if(e.isSubjectRoot){const n=tt(e,iy),r=null===(t=null==n?void 0:n.subject.ref)||void 0===t?void 0:t.type.ref;if(!r)throw new ky("Unknown subject type.",e,"isSubjectRoot");return xy(r)}{const t=tt(e,py).type.ref;if(!t)throw new ky("Unknown user type.",e,"isSubjectRoot");return xy(t)}}(e);case"StringLiteral":return $y();case"UnaryExpression":return function(e){switch(e.op){case"!":return{$type:"BooleanType",$container:void 0};case"+":case"-":return{$type:"NumberType",$container:void 0};default:tm(e.op)}}(e);case"BinaryExpression":return function(e){return Ey[e.op](Cy(e.left),Cy(e.right))}(e);default:tm()}}const Ey={"+":function(e,t){throw new Error("Function not implemented.")},"-":function(e,t){return Sy()},"!=":function(e,t){return by()},"%":function(e,t){return Sy()},"&&":function(e,t){return by()},"*":function(e,t){return Sy()},"/":function(e,t){return Sy()},"<":function(e,t){return by()},"<=":function(e,t){return by()},"==":function(e,t){return by()},">":function(e,t){return by()},">=":function(e,t){return by()},"||":function(e,t){return by()}};class Ay extends hi{constructor(e){super(e)}getScope(e){var t;const n=e.container,r=this.reflection.getReferenceType(e);switch(n.$type){case"ActionMember":if("superAction"===e.property)return this.createScopeFromNodes(n.$container.members);tm();break;case"ForMember":if("subject"===e.property)return this.createScopeFromNodes(n.$container.$container.members);tm();break;case"InterfaceDefinition":if("superInterface"===e.property)return this.createScopeFromNodes(n.$container.elements.filter(sy));tm();break;case"PropertyMemberAccess":if("member"===e.property){const t=Cy(n.receiver);return i=t,my.isInstance(i,cy)?this.createScopeFromNodes(t.members):this.getGlobalScope(r,e)}tm();break;case"TypeDefinitionReference":if("type"===e.property)return this.getTypeDefs(nt(n).uri);tm();break;case"SubjectDefinition":case"UserDefinition":if("type"===e.property)return this.createScopeForNodes(tt(n,ay).elements.filter(ey));tm();break;case"SelectSingle":if("action"===e.property)return n.$container.$container.subject.ref?this.createScopeForNodes(null===(t=n.$container.$container.subject.ref)||void 0===t?void 0:t.members):this.getGlobalScope(r,e);tm();break;default:tm()}var i}getTypeDefs(e){const t=new Set([e.toString()]);return this.createScope([...this.indexManager.allElements(oy,t),...this.indexManager.allElements(dy,t)])}createScopeFromNodes(e,t){return this.createScope(e.map((e=>this.descriptions.createDescription(e,e.name))),t)}}class Ny{constructor(e){this.services=e,this.nextDocumentId=0}async generate(e){var t;const n=this.services.LanguageMetaData,r=this.services.shared.workspace.DocumentBuilder,i=jn.parse(`file:///${this.nextDocumentId++}${null!==(t=n.fileExtensions[0])&&void 0!==t?t:""}`),o=this.services.shared.workspace.LangiumDocumentFactory.fromString(e,i);this.services.shared.workspace.LangiumDocuments.addDocument(o),await r.build([o],{validation:!0});try{return this.generateFromModel(o.parseResult.value)}finally{await r.update([],[i])}}generateFromModel(e){const{interfaces:t,nestedSets:n,trees:r}=this.getInterfaces(e);return`${this.generateImports()}\n\n${this.generateTypes(t,r)}\n\n${this.generateReflection(t,n)}\n\n${this.generateUser(e.elements.filter(py))}\n\n${this.generateSubjectActions(e.elements.filter(py).flatMap((e=>e.members)))}\n`}generateUser(e){var t,n,r;return`export type $UserType = ${null===(r=null===(n=null===(t=e[0])||void 0===t?void 0:t.type)||void 0===n?void 0:n.ref)||void 0===r?void 0:r.name};`}getSubjectActions(e){const t=Object.fromEntries(e.members.map((e=>{var t,n;return[e.name,null===(n=null===(t=e.superAction)||void 0===t?void 0:t.ref)||void 0===n?void 0:n.name]}))),n=Object.fromEntries(Object.entries(t).map((([e])=>[e,[]])));for(const[e,r]of Object.entries(t).filter((([e,t])=>void 0!==t)))n[r].push(e);return{parents:t,children:n}}generateSubjectActions(e){return`export const $SubjectActions = {\n  ${e.filter(ly).map((e=>{var t;const{children:n,parents:r}=this.getSubjectActions(e),i=Object.keys(r).map((e=>`'${e}'`)).join("|"),o=new Map;let s=0;function a(e){const t=s++;for(const t of n[e])a(t);const r=s++;o.set(e,[t,r])}for(const e of Object.entries(r).filter((([e,t])=>void 0===t)).map((([e])=>e)))a(e);return`${e.name}: ["${null===(t=e.type.ref)||void 0===t?void 0:t.name}", new SubjectActions<${i}>({\n    ${Object.keys(r).map(((e,t)=>{const[n,r]=o.get(e);return`${e}: [[${n}, ${r}],  ${t}]`})).join(",\n    ")}\n  })]`})).join("\n  ")}\n} satisfies SubjectActionsBase<$Types>;    \n`}generateReflection(e,t){return`export const $Reflection = new Reflection<$Types>({\n  ${e.map((e=>{const n=t.get(e.name);return`${e.name}: [${n[0]},  ${n[1]}],`})).join("\n  ")}\n});`}getInterfaces(e){const t=new Map,n=new Map,r=e.elements.filter(sy),i=[];for(const e of r)t.set(e.name,{$type:e.name,children:[]});for(const e of r){const n=t.get(e.name);e.superInterface?t.get(e.superInterface.ref.name).children.push(n):i.push(n)}let o=0;function s(e){const t=o++;for(const t of e.children)s(t);const r=o++;n.set(e.$type,[t,r])}for(const e of i)s(e);return{interfaces:r,nestedSets:n,trees:t}}generateTypes(e,t){function n(e){const r=t.get(e).children.map((e=>n(e.$type))).join("|");return`"${e}"${r.length>0?`|${r}`:""}`}return e.map((e=>{var t;return`interface ${e.name}${e.superInterface?` extends ${null===(t=e.superInterface.ref)||void 0===t?void 0:t.name}`:""} {\n  $type: ${n(e.name)};\n  ${e.members.map((e=>`${e.name}: ${this.generateTypeReference(e.type)};`)).join("\n  ")}\n}`})).join("\n")+`\n\nexport type $Types = {\n  ${e.map((e=>`${e.name}: ${e.name},`)).join("\n  ")}\n}`}generateTypeReference(e){switch(e.$type){case"BooleanType":return"boolean";case"NumberType":return"number";case"StringType":return"string";case"TypeDefinitionReference":return e.type.ref.name;case"ArrayType":return`${this.generateTypeReference(e.type)}[]`;case"NullType":return"null";case"ObjectType":return`{\n  ${e.members.map((e=>`${e.name}: ${this.generateTypeReference(e.type)};`)).join("\n  ")}`;default:tm()}}generateImports(){return'import { Reflection, RoleRules, SubjectActions, SubjectActionsBase, not } from "@ecchi-js/core";'}}const Dy={references:{ScopeProvider:e=>new Ay(e)},validation:{EcchiValidator:()=>new Ry},generator:{EcchiGenerator:e=>new Ny(e)}},_y=fs/promises;var Iy;null===(Iy=function(e){if(e)return async function(e){const t=function(e){const t=L(Jm(e),vy),n=L(Xm({shared:t}),Ty,Dy);return t.ServiceRegistry.register(n),function(e){const t=e.validation.ValidationRegistry,n=e.validation.EcchiValidator,r={Model:n.checkModel};t.register(r,n)}(n),{shared:t,Ecchi:n}}(Lo),n=await(0,_y.readFile)(e,"utf-8");return await t.Ecchi.generator.EcchiGenerator.generate(n)}(e);console.error("No filename provided")}(process.argv[2]))||void 0===Iy||Iy.then(console.log)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(3109)})();